body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: #0f172a;
  color: #e5e7eb;
}

body.modal-open {
  overflow: hidden;
}

/* Generic utility class (used across UI): hide any element. */
.hidden { display: none !important; }


a {
  color: #60a5fa;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

.container {
  max-width: 960px;
  margin: 0 auto;
  padding: 24px;
}

/* DevTools (and other wide pages): use most of the screen width */
.container-wide {
  max-width: min(1600px, 96vw);
}


header {
  margin-bottom: 24px;
}

header h1 {
  margin: 0 0 4px;
  font-size: 28px;
}


header p {
  margin: 0;
  color: #9ca3af;
}

.header-main {
  /* 3 –∑–æ–Ω—ã: —Å–ª–µ–≤–∞ –∑–∞–≥–æ–ª–æ–≤–æ–∫, –ø–æ —Ü–µ–Ω—Ç—Ä—É –≤—ã–±–æ—Ä —è–¥—Ä–∞, —Å–ø—Ä–∞–≤–∞ –¥–µ–π—Å—Ç–≤–∏—è */
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;
  column-gap: 12px;
  row-gap: 10px;
}

.header-title-group { justify-self: start; }
.header-center { justify-self: center; }
.header-right { justify-self: end; }

/* Allow grid items in the header to shrink without overflowing the container */
.header-title-group,
.header-center,
.header-right {
  min-width: 0;
}

@media (max-width: 900px) {
  .header-main {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    flex-wrap: wrap;
  }

  .header-center {
    order: 3;
    width: 100%;
    display: flex;
    justify-content: center;
  }
}

/* –ü—Ä–∞–≤–∞—è –≥—Ä—É–ø–ø–∞ –≤ —à–∞–ø–∫–µ: –≤–µ—Ä—Å–∏—è/—è–¥—Ä–æ + –¥–µ–π—Å—Ç–≤–∏—è (–≤—ã–π—Ç–∏ + —Ç–µ–º–∞) */
.header-right {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  max-width: 100%;
}

/* –î–µ—Ä–∂–∏–º ¬´–í—ã–π—Ç–∏¬ª –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã —Ä—è–¥–æ–º (–∫–∞–∫ –µ–¥–∏–Ω—ã–π –±–ª–æ–∫) */
.header-actions {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.theme-toggle-header {
  /* –≤ —à–∞–ø–∫–µ –∫–Ω–æ–ø–∫–∞ –Ω–µ –ø–ª–∞–≤–∞—é—â–∞—è */
  position: static;
  top: auto;
  right: auto;
}

.header-title-group {
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.service-status-text {
  display: none; /* —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—É—Å–∞ —É–±—Ä–∞–Ω, –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤—Å–ø–ª—ã–≤–∞—é—â–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ –Ω–∞ –ª–∞–º–ø–æ—á–∫–µ */
}

.service-status-lamp {
  display: inline-block;
  width: 10px;
  height: 10px;
  border-radius: 9999px;
  background: #6b7280;
  box-shadow: none;
  cursor: help;
  transition:
    background-color 0.2s ease,
    box-shadow 0.2s ease,
    transform 0.15s ease;
}


/* –°–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω */
.service-status-lamp[data-state="running"] {
  background: #22c55e;
  box-shadow: 0 0 6px rgba(34, 197, 94, 0.7);
  animation: service-status-pulse 1s infinite;
}

/* –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω */
.service-status-lamp[data-state="stopped"] {
  background: #ef4444;
  box-shadow: 0 0 4px rgba(248, 113, 113, 0.7);
}

/* –ü—Ä–æ–≤–µ—Ä–∫–∞ / –æ–∂–∏–¥–∞–Ω–∏–µ */
.service-status-lamp[data-state="pending"] {
  background: #f59e0b;
  box-shadow: 0 0 6px rgba(245, 158, 11, 0.7);
  animation: service-status-pulse 1s infinite;
}

/* –û—à–∏–±–∫–∞ / –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ */
.service-status-lamp[data-state="error"] {
  background: #f97316;
  box-shadow: 0 0 6px rgba(249, 115, 22, 0.7);
}

@keyframes service-status-pulse {
  0%,
  100% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(1.25);
    opacity: 0.7;
  }
}



.service-core-text {
  font-size: 12px;
  padding: 4px 12px;
  border-radius: 999px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb;
  white-space: nowrap;
  cursor: pointer;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.service-core-text.has-core {
  border-color: #2563eb;
  background: #0b1120;
  box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.35);
}

.last-load-badge {
  margin-left: 16px;
  padding: 3px 8px;
  border-radius: 999px;
  border: 1px solid #1f2937;
  font-size: 11px;
  color: #9ca3af;
  white-space: nowrap;
  align-self: center;
  background: rgba(15, 23, 42, 0.9);
}

/* –ö–æ–≥–¥–∞ –±–µ–π–¥–∂ —Å—Ç–æ–∏—Ç —Ä—è–¥–æ–º —Å –∫–Ω–æ–ø–∫–∞–º–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º gap –≤–º–µ—Å—Ç–æ margin */
.xkeen-ctrl-row .last-load-badge {
  margin-left: 0;
}

.last-load-badge.last-load-loaded {
  border-color: #22c55e66;
  color: #bbf7d0;
}

.last-load-badge.last-load-saved {
  border-color: #38bdf866;
  color: #bae6fd;
}

.last-load-badge.last-load-error {
  border-color: #ef444466;
  color: #fecaca;
}


.service-core-text.has-core:hover {
  text-decoration: underline;
}

.core-select-row {
  display: flex;
  gap: 8px;
  margin-top: 8px;
}

.core-option {
  padding: 4px 12px;
  font-size: 12px;
  border-radius: 9999px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb;
  cursor: pointer;
  transition:
    background 0.15s ease,
    transform 0.05s ease,
    box-shadow 0.15s ease,
    border-color 0.15s ease;
}

.core-option:hover {
  background: linear-gradient(135deg, #1d4ed8, #2563eb);
  border-color: #2563eb;
  box-shadow: 0 4px 12px rgba(37, 99, 235, 0.6);
  transform: translateY(-1px);
}

.core-option.active {
  background: linear-gradient(135deg, #22c55e, #16a34a);
  border-color: #22c55e;
  box-shadow: 0 4px 12px rgba(22, 163, 74, 0.6);
}

.core-option[disabled] {
  opacity: 0.6;
  cursor: default;
  box-shadow: none;
  background: #020617;
}



.card {
  background: #020617;
  border-radius: 12px;
  padding: 16px 16px 20px;
  margin-bottom: 16px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
  border: 1px solid #1f2937;
}

.card h2 {
  margin-top: 0;
  margin-bottom: 8px;
  font-size: 20px;
}

.card p {
  margin-top: 0;
  margin-bottom: 12px;
  color: #9ca3af;
}

textarea#routing-editor {
  width: 100%;
  min-height: 260px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 14px;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb;
  resize: vertical;
  box-sizing: border-box;
}


.xkeen-textarea {
  width: 100%;
  min-height: 200px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 14px;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb;
  resize: vertical;
  box-sizing: border-box;
}

.CodeMirror {
  border-radius: 8px;
  border: 1px solid #111827;
  background: #020617;
  /* Let CodeMirror grow with content; avoid conflicting manual resize */
  height: auto;
  min-height: 260px;
  font-family: "JetBrains Mono", "Fira Code", Menlo, Monaco, Consolas,
    "Liberation Mono", "Courier New", monospace;
box-shadow: 0 12px 30px rgba(0, 0, 0, 0.45);

  font-size: 14px;
}

/* Make scrolling predictable and avoid white gaps */
.CodeMirror-scroll {
  max-height: 70vh;
  background-color: #020617;

  /* Keep scrolling predictable */
  overflow: auto !important;
}

/*
  IMPORTANT (auto-height CodeMirror)
  ---------------------------------
  Our UI uses `height: auto` on the `.CodeMirror` wrapper + `max-height` on
  `.CodeMirror-scroll`.

  CodeMirror 5 default CSS uses `margin-bottom: -50px` on `.CodeMirror-scroll`
  as part of its scrollbar layout hack. When the wrapper height is auto, that
  negative margin makes the wrapper shorter and the last visible line gets
  clipped in some editors.

  Fix: neutralize the negative bottom margin for our editors and keep a small
  bottom padding so the last line is always fully visible.
*/
.xkeen-cm .CodeMirror-scroll {
  margin-bottom: 0 !important;
  padding-bottom: 12px !important;
}

.xkeen-cm .CodeMirror-gutter {
  margin-bottom: 0 !important;
}


/*
  Fullscreen (CodeMirror addon/display/fullscreen)
  ------------------------------------------------
  We intentionally cap editor height in normal mode via `max-height: 70vh`.
  But in fullscreen CodeMirror only adds `.CodeMirror-fullscreen` on the
  wrapper; without overrides the scroll area stays capped, so fullscreen looks
  "crooked" (big empty space below/aside).
*/
.CodeMirror.CodeMirror-fullscreen {
  /* Make sure the editor overlays the whole UI (sidebar/header, etc.) */
  z-index: 10000;
  border-radius: 0;
}

.CodeMirror.CodeMirror-fullscreen .CodeMirror-scroll {
  max-height: none !important;
  height: 100% !important;
}

.cm-error-line {
  background: rgba(220, 38, 38, 0.15);
}

.actions {
  margin-top: 10px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.actions button {
  flex: 1 1 210px;
  text-align: center;
  white-space: normal;
}


button {
  border-radius: 9999px;
  padding: 6px 14px;
  font-size: 14px;
  cursor: pointer;
  background: #020617;
  border: 1px solid #1f2937;
  color: #e5e7eb;
  box-shadow: 0 4px 10px rgba(15, 23, 42, 0.7);
  transition:
    background 0.15s ease,
    transform 0.05s ease,
    box-shadow 0.15s ease,
    border-color 0.15s ease;
}

button:hover {
  background: #020617;
  border-color: #4b5563;
  box-shadow: 0 8px 20px rgba(15, 23, 42, 0.9);
  transform: translateY(-1px);
}

button:active {
  background: linear-gradient(135deg, #1d4ed8, #2563eb);
  border-color: #2563eb;
  transform: translateY(1px) scale(0.99);
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.4);
}

button:disabled {
  opacity: 0.5;
  cursor: default;
  box-shadow: none;
}

.status {
  margin-top: 8px;
  font-size: 12px;
  color: #9ca3af;
}

.error {
  margin-top: 6px;
  font-size: 12px;
  color: #fca5a5;
}

.inbounds-modes {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.mode-item {
  display: flex;
  gap: 8px;
  padding: 8px;
  border-radius: 8px;
  background: #020617;
  border: 1px solid #1f2937;
}

.mode-item input {
  margin-top: 4px;
}

.mode-item strong {
  color: #e5e7eb;
}

.mode-item small {
  color: #9ca3af;
}

.toggle {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 14px;
  margin-top: 10px;
  color: #9ca3af;
}

.toggle input {
  width: 16px;
  height: 16px;
}

#outbounds-url {
  width: 100%;
  box-sizing: border-box;
  border-radius: 9999px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb;
  padding: 8px 12px;
  font-size: 14px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

#outbounds-url:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 1px #3b82f6;
}

table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
}

thead {
  background: #020617;
}

th, td {
  padding: 6px 8px;
  border-bottom: 1px solid #1f2937;
  text-align: left;
}

th {
  font-weight: 600;
  color: #9ca3af;
}

tbody tr:hover {
  background: #020617;
}
#backups-table .backups-empty-row:hover {
  background: transparent;
}


.hint {
  margin-top: 8px;
  font-size: 12px;
  color: #9ca3af;
}

footer {
  margin-top: 16px;
  text-align: right;
  color: #6b7280;
  font-size: 11px;
}

.btn-link {
  border-radius: 9999px;
  padding: 6px 14px;
  border: 1px solid #374151;
  display: inline-block;
}

.links {
  list-style: none;
  padding-left: 0;
  margin: 0;
}

.links li {
  margin-bottom: 4px;
}

.log-block {
  background: #020617;
  box-sizing: border-box;
  display: block;
  border-radius: 8px;
  border: 1px solid #1f2937;
  padding: 8px;
  font-size: 12px;
  max-height: 260px;
  overflow: auto;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  white-space: pre-wrap;
}
.log-tag-info {
  color: #60a5fa;
  font-weight: 500;
}

.log-tag-warn {
  color: #facc15;
  font-weight: 500;
}

.log-tag-error {
  color: #f97373;
  font-weight: 600;
}



/* Two-column main layout */
.layout-2col {
  display: grid;
  grid-template-columns: minmax(0, 2.1fr) minmax(0, 1.4fr);
  gap: 16px;
  align-items: flex-start;
}

/* DevTools: Tools tab uses a compact left column and a wide ENV editor on the right */
.dt-tools-layout {
  grid-template-columns: minmax(260px, 420px) minmax(0, 1fr);
}

.dt-tools-left {
  min-width: 0;
}

.dt-tools-right {
  min-width: 0;
}

.layout-main {
  min-width: 0;
}

.layout-side {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.layout-side .card {
  margin-top: 0;
}

@media (max-width: 1024px) {
  .layout-2col {
    grid-template-columns: minmax(0, 1fr);
  }

  /* On smaller screens: keep DevTools readable */
  .dt-tools-layout {
    grid-template-columns: minmax(0, 1fr);
  }
}

/* Log controls */
.log-card {
  margin-top: 16px;
}

.log-header-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  margin-bottom: 8px;
}

.log-header-row h2 {
  margin: 0;
}

.log-header-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  overflow-x: auto;
  scrollbar-width: none; /* Firefox */
}

/* Hide horizontal scrollbar but keep scrollability */
.log-header-actions::-webkit-scrollbar {
  display: none;
}

.log-btn {
  font-size: 11px;
  padding-inline: 10px;
}

/* XKeen commands block */
.commands-card {
  margin-top: 16px;
}

.commands-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}

.commands-header h2 {
  margin: 0;
  font-size: 14px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: #c7d2fe;
}

#commands-arrow {
  font-size: 14px;
  opacity: 0.8;
}

.command-group + .command-group {
  margin-top: 10px;
  padding-top: 10px;
  border-top: 1px solid #1f2937;
}

.command-group-title {
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: #9ca3af;
  margin-bottom: 4px;
}


.command-list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  grid-auto-rows: auto;
  column-gap: 8px;
  row-gap: 4px;
}


@media (max-width: 900px) {
  .command-list {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
}

@media (max-width: 640px) {
  .command-list {
    grid-template-columns: 1fr;
  }
}


.command-item {
  position: relative;
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 6px;
  padding: 4px 8px;
  border-radius: 10px;
  background: #020617;
  border: 1px solid #1f2937;
  font-size: 12px;
  cursor: pointer;
  transition: border-color 0.12s ease, background 0.12s ease, transform 0.1s ease;
}
.command-item.loading {
  opacity: 0.7;
  cursor: wait;
}

.command-item.loading::after {
  content: '';
  position: absolute;
  right: 8px;
  top: 50%;
  width: 12px;
  height: 12px;
  margin-top: -6px;
  border-radius: 999px;
  border: 2px solid rgba(148, 163, 184, 0.5);
  border-top-color: #e5e7eb;
  animation: xkeen-spinner 0.8s linear infinite;
}


.command-item:hover {
  border-color: #60a5fa;
  background: #0b1220;
  transform: translateY(-1px);
}

.command-item-top {
  display: flex;
  align-items: center;
  gap: 8px;
}

.command-item-icon {
  font-size: 10px;
  opacity: 0.85;
}

.command-item-code code {
  background: transparent;
  border-radius: 999px;
  border: 1px solid rgba(30, 64, 175, 0.9);
  padding: 2px 8px;
  font-size: 12px;
}

.command-item-desc {
  color: #9ca3af;
  font-size: 11px;
  line-height: 1.4;
}

.layout-single {
  max-width: 960px;
  margin: 0 auto;
}

/* XKeen editors: make CodeMirror text brighter and comments –±–æ–ª–µ–µ –∑–∞–º–µ—Ç–Ω—ã–º–∏ */
.cm-s-material-darker.CodeMirror {
  color: #e5e7eb;
}

/* –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏: –ø—Ä–∏–≥–ª—É—à—ë–Ω–Ω—ã–µ —Å–µ—Ä–æ-—Å–∏–Ω–∏–µ –≤ —Ç—ë–º–Ω–æ–π —Ç–µ–º–µ */
.cm-s-material-darker .cm-comment {
  color: #64748b;
  font-style: italic;
}

/* –ö–ª—é—á–∏ JSON/YAML (–Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π) */
.cm-s-material-darker .cm-property {
  color: #60a5fa;
}

/* –°—Ç—Ä–æ–∫–∏ (–ø—É—Ç–∏, –∑–Ω–∞—á–µ–Ω–∏—è) */
.cm-s-material-darker .cm-string {
  color: #a3e635;
}

/* –ß–∏—Å–ª–∞ */
.cm-s-material-darker .cm-number {
  color: #f97316;
}

/* true / false / null –∏ –ø—Ä–æ—á–∏–µ –∞—Ç–æ–º—ã */
.cm-s-material-darker .cm-atom {
  color: #22d3ee;
}

/* –°–∫–æ–±–∫–∏, –∑–∞–ø—è—Ç—ã–µ, –¥–≤–æ–µ—Ç–æ—á–∏—è */
.cm-s-material-darker .cm-punctuation,
.cm-s-material-darker .cm-bracket {
  color: #9ca3af;
}

/* –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ */
.cm-s-material-darker .cm-keyword {
  color: #facc15;
}

/* –ò–º–µ–Ω–∞ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ */
.cm-s-material-darker .cm-def,
.cm-s-material-darker .cm-variable,
.cm-s-material-darker .cm-variable-2 {
  color: #e5e7eb;
}

/* –¶–≤–µ—Ç –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫–∏ –∏ –∫—É—Ä—Å–æ—Ä */
.cm-s-material-darker .CodeMirror-linenumber {
  color: #4b5563;
}

.cm-s-material-darker .CodeMirror-cursor {
  border-left: 2px solid #facc15;
}

/* –ë–æ–ª–µ–µ –∑–∞–º–µ—Ç–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞—Ö CodeMirror */
.cm-s-material-darker .CodeMirror-selected,
.cm-s-material-darker .CodeMirror-line::selection,
.cm-s-material-darker .CodeMirror-line > span::selection,
.cm-s-material-darker .CodeMirror-line > span > span::selection,
.xkeen-cm .CodeMirror-selected,
.xkeen-cm .CodeMirror-line::selection,
.xkeen-cm .CodeMirror-line > span::selection,
.xkeen-cm .CodeMirror-line > span > span::selection {
  background: rgba(96, 165, 250, 0.45) !important; /* —Å–≤–µ—Ç–ª–æ-—Å–∏–Ω–∏–π —Ñ–æ–Ω –≤—ã–¥–µ–ª–µ–Ω–∏—è */
}

/* –ù–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –±—Ä–∞—É–∑–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—â–∏–π ::selection –≤–Ω—É—Ç—Ä–∏ –æ–±–æ–ª–æ—á–∫–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ */
.xkeen-cm ::selection {
  background: rgba(96, 165, 250, 0.45) !important;
}

/* === CodeMirror cosmetics (enabled addons need CSS to be visible) ===
   - match-highlighter: .cm-matchhighlight
   - trailing-space:    .cm-trailingspace
   - rulers:            .CodeMirror-ruler (.CodeMirror-rulers wrapper)
*/
.cm-s-material-darker .cm-matchhighlight,
.xkeen-cm .cm-matchhighlight {
  background: rgba(34, 211, 238, 0.18);
  border-radius: 2px;
}

.cm-s-material-darker .cm-trailingspace,
.xkeen-cm .cm-trailingspace {
  background: rgba(248, 113, 113, 0.28);
}

.cm-s-material-darker .CodeMirror-rulers,
.xkeen-cm .CodeMirror-rulers {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  pointer-events: none;
}

.cm-s-material-darker .CodeMirror-ruler,
.xkeen-cm .CodeMirror-ruler {
  /* Hide CodeMirror rulers (thin vertical guide line) */
  border-left: 0 !important;
}





.xkeen-cm {
  /* CodeMirror wrapper */
  min-height: 160px;
}


/* --- CodeMirror mouse toolbar (overlay) --- */
.xkeen-cm-toolbar {
  /* Toolbar sits above the editor (outside CodeMirror) */
  position: relative;
  display: flex;
  justify-content: flex-end;
  gap: 6px;
  margin: 0 0 6px 0;
  padding-right: 6px;
  /* Ensure tooltips and the toolbar itself can overlap the editor */
  z-index: 50;
  overflow: visible;
}

/* When editor is in fullscreen, keep toolbar visible */
.xkeen-cm-toolbar.is-fullscreen {
  position: fixed;
  top: 10px;
  right: 10px;
  z-index: 10050;
}


.xkeen-cm-tool {
  position: relative;
  width: 30px;
  height: 28px;
  border-radius: 8px;
  border: 1px solid rgba(148, 163, 184, 0.22);
  background: rgba(2, 6, 23, 0.72);
  color: rgba(226, 232, 240, 0.95);
  cursor: pointer;
  /*
    Reset generic <button> styles (padding/line-height/appearance) so SVG icons
    are centered *exactly* inside fixed-size square buttons.
  */
  appearance: none;
  -webkit-appearance: none;
  padding: 0;
  line-height: 0;
  font-size: 0;
  box-sizing: border-box;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  user-select: none;
}

.xkeen-cm-tool svg {
  width: 16px;
  height: 16px;
  display: block;
  flex: 0 0 auto;
  pointer-events: none;
}

.xkeen-cm-tool:hover {
  border-color: rgba(148, 163, 184, 0.45);
  background: rgba(2, 6, 23, 0.88);
}

/* Disabled state (e.g. replace/comment in readOnly mode) */
.xkeen-cm-tool:disabled,
.xkeen-cm-tool.is-disabled {
  opacity: 0.45;
  cursor: not-allowed;
  border-color: rgba(148, 163, 184, 0.18);
  background: rgba(2, 6, 23, 0.50);
}

.xkeen-cm-tool:disabled:hover,
.xkeen-cm-tool.is-disabled:hover {
  border-color: rgba(148, 163, 184, 0.18);
  background: rgba(2, 6, 23, 0.50);
}

.xkeen-cm-tool:disabled:active,
.xkeen-cm-tool.is-disabled:active {
  transform: none;
}

.xkeen-cm-tool:active {
  transform: translateY(1px);
}

.xkeen-cm-tool:focus-visible {
  outline: 2px solid rgba(96, 165, 250, 0.75);
  outline-offset: 2px;
}

/* Red "?" help button */
.xkeen-cm-tool.is-help {
  color: rgba(239, 68, 68, 0.98);
}

.xkeen-cm-tool.is-help:hover {
  border-color: rgba(239, 68, 68, 0.55);
}

/* Tooltip (hover + keyboard focus) */
.xkeen-cm-tool[data-tip]::after {
  content: attr(data-tip);
  position: absolute;
  top: calc(100% + 8px);
  right: 0;
  z-index: 9999;
  white-space: nowrap;
  padding: 6px 8px;
  border-radius: 8px;
  border: 1px solid rgba(148, 163, 184, 0.22);
  background: rgba(15, 23, 42, 0.95);
  color: rgba(226, 232, 240, 0.98);
  font-size: 12px;
  opacity: 0;
  transform: translateY(-2px);
  pointer-events: none;
  transition: opacity 0.12s ease, transform 0.12s ease;
}

.xkeen-cm-tool[data-tip]:hover::after,
.xkeen-cm-tool[data-tip]:focus-visible::after {
  opacity: 1;
  transform: translateY(0);
}

/* Light theme */
html[data-theme="light"] .xkeen-cm-tool {
  background: rgba(255, 255, 255, 0.85);
  color: rgba(15, 23, 42, 0.95);
  border-color: rgba(15, 23, 42, 0.18);
}

html[data-theme="light"] .xkeen-cm-tool:disabled,
html[data-theme="light"] .xkeen-cm-tool.is-disabled {
  background: rgba(255, 255, 255, 0.65);
  border-color: rgba(15, 23, 42, 0.10);
}

html[data-theme="light"] .xkeen-cm-tool.is-help {
  color: rgba(220, 38, 38, 0.98);
}

html[data-theme="light"] .xkeen-cm-tool[data-tip]::after {
  background: rgba(255, 255, 255, 0.98);
  color: rgba(15, 23, 42, 0.95);
  border-color: rgba(15, 23, 42, 0.18);
}

/* --- CodeMirror help drawer (slides in from the right) --- */
.xkeen-cm-help-overlay {
  position: fixed;
  inset: 0;
  background: rgba(15, 23, 42, 0.55);
  z-index: 10040;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.16s ease;
}

.xkeen-cm-help-overlay.is-open {
  opacity: 1;
  pointer-events: auto;
}

.xkeen-cm-help-drawer {
  position: fixed;
  top: 0;
  right: 0;
  height: 100vh;
  width: min(460px, 92vw);
  z-index: 10041;
  transform: translateX(100%);
  transition: transform 0.18s ease;
  border-left: 1px solid rgba(148, 163, 184, 0.18);
  background: rgba(2, 6, 23, 0.98);
  color: rgba(226, 232, 240, 0.95);
  box-shadow: -24px 0 48px rgba(0, 0, 0, 0.35);
  display: flex;
  flex-direction: column;
}

.xkeen-cm-help-drawer.is-open {
  transform: translateX(0);
}

.xkeen-cm-help-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 14px;
  border-bottom: 1px solid rgba(148, 163, 184, 0.16);
}

.xkeen-cm-help-title {
  font-weight: 700;
  font-size: 14px;
  letter-spacing: 0.2px;
}

.xkeen-cm-help-close {
  width: 34px;
  height: 30px;
  border-radius: 10px;
  border: 1px solid rgba(148, 163, 184, 0.18);
  background: rgba(15, 23, 42, 0.65);
  color: rgba(226, 232, 240, 0.95);
  cursor: pointer;
}

.xkeen-cm-help-close:hover {
  background: rgba(15, 23, 42, 0.9);
}

.xkeen-cm-help-body {
  padding: 12px 14px 18px;
  overflow: auto;
}

.xkeen-cm-help-section {
  padding: 10px 10px;
  margin: 0 0 10px 0;
  border-radius: 14px;
  border: 1px solid rgba(148, 163, 184, 0.14);
  background: rgba(15, 23, 42, 0.35);
}

.xkeen-cm-help-section h3 {
  margin: 0 0 6px 0;
  font-size: 13px;
}

.xkeen-cm-help-section p {
  margin: 6px 0;
  font-size: 13px;
  line-height: 1.35;
}

.xkeen-cm-help-section ul {
  margin: 8px 0 0 18px;
  padding: 0;
  font-size: 13px;
  line-height: 1.35;
}

html[data-theme="light"] .xkeen-cm-help-overlay {
  background: rgba(15, 23, 42, 0.35);
}

html[data-theme="light"] .xkeen-cm-help-drawer {
  background: rgba(255, 255, 255, 0.98);
  color: rgba(15, 23, 42, 0.95);
  border-left-color: rgba(15, 23, 42, 0.12);
  box-shadow: -24px 0 48px rgba(0, 0, 0, 0.18);
}

html[data-theme="light"] .xkeen-cm-help-head {
  border-bottom-color: rgba(15, 23, 42, 0.12);
}

html[data-theme="light"] .xkeen-cm-help-close {
  background: rgba(255, 255, 255, 0.9);
  color: rgba(15, 23, 42, 0.95);
  border-color: rgba(15, 23, 42, 0.16);
}

html[data-theme="light"] .xkeen-cm-help-section {
  background: rgba(248, 250, 252, 0.8);
  border-color: rgba(15, 23, 42, 0.12);
}

/* –ú–∏–Ω–∏-—Ç–µ—Ä–º–∏–Ω–∞–ª XKeen */
.terminal-overlay {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  background: rgba(15, 23, 42, 0.75);
  z-index: 50;
}

.terminal-window {
  width: 520px;
  height: 360px;

  min-width: 360px;
  min-height: 240px;

  max-width: 95vw;
  max-height: 90vh;

  background: #020617;
  border-radius: 12px;
  border: 1px solid #334155;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.7);
  padding: 12px 14px;
  font-size: 14px;

  /* resizable + layout */
  display: flex;
  flex-direction: column;
  resize: both;
  overflow: hidden;
  position: relative;
}

.terminal-window::after {
  /* –≤–∏–∑—É–∞–ª—å–Ω–∞—è "—Ä—É—á–∫–∞" –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É */
  content: "";
  position: absolute;
  right: 8px;
  bottom: 8px;
  width: 14px;
  height: 14px;
  border-right: 2px solid rgba(148, 163, 184, 0.35);
  border-bottom: 2px solid rgba(148, 163, 184, 0.35);
  pointer-events: none;
  border-radius: 2px;
}

.terminal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 6px;

  /* drag handle */
  cursor: move;
  user-select: none;
}

.terminal-header-left {
  display: flex;
  align-items: center;
  min-width: 0;
}

.terminal-conn-lamp {
  margin-left: 10px;
}

.terminal-uptime {
  margin-left: 8px;
  font-size: 11px;
  color: #9ca3af;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  white-space: nowrap;
}

.terminal-tool-btn-danger {
  border-color: rgba(248, 113, 113, 0.55);
  background: rgba(127, 29, 29, 0.40);
  color: #fecaca;
}

.terminal-tool-btn-danger:hover {
  background: rgba(153, 27, 27, 0.55);
}

/* Keep danger buttons "danger" even in active state (override global button:active gradient). */
.terminal-tool-btn-danger:active {
  background: rgba(153, 27, 27, 0.70);
  border-color: rgba(248, 113, 113, 0.75);
  box-shadow: 0 6px 16px rgba(239, 68, 68, 0.25);
  transform: translateY(1px) scale(0.99);
}

.terminal-toolbar {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 6px;
  flex-wrap: wrap;

  /* Override the header drag cursor inside toolbar/menus.
     Buttons still show pointer via .terminal-tool-btn { cursor: pointer; } */
  cursor: default;

  position: relative;
}

/* Dropdown menus should not look like drag handles */
.terminal-overflow-menu,
.terminal-view-menu,
.terminal-buffer-menu {
  cursor: default;
}

.terminal-tool-btn {
  border-radius: 9999px;
  padding: 4px 8px;
  border: 1px solid rgba(148, 163, 184, 0.35);
  background: rgba(2, 6, 23, 0.6);
  color: #e5e7eb;
  font-size: 12px;
  line-height: 1;
  cursor: pointer;
}

.terminal-tool-btn:hover {
  background: rgba(17, 24, 39, 0.85);
}

.terminal-tool-btn:active {
  transform: translateY(1px);
}

.terminal-tool-btn.is-active {
  border-color: rgba(59, 130, 246, 0.65);
  background: rgba(30, 64, 175, 0.35);
}

.terminal-tool-btn-kbd {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  padding: 4px 7px;
}

.terminal-header span {
  font-weight: 600;
}

.terminal-close {
  background: transparent;
  border: none;
  color: #9ca3af;
  cursor: pointer;
  font-size: 18px;
  line-height: 1;
}

.terminal-window.is-fullscreen {
  position: fixed !important;
  left: 8px !important;
  top: 8px !important;
  width: calc(100vw - 16px) !important;
  height: calc(100vh - 16px) !important;
  max-width: none !important;
  max-height: none !important;
  resize: none !important;
}

.terminal-window.is-fullscreen::after {
  display: none;
}

.terminal-command {
  width: 100%;
  background: #020617;
  border-radius: 6px;
  border: 1px solid #1f2937;
  padding: 4px 8px;
  margin-bottom: 6px;
  font-size: 12px;
  color: #9ca3af;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

.terminal-search-row {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 6px;
  flex-wrap: wrap;
}

.terminal-search-input {
  flex: 1 1 220px;
  min-width: 140px;
  background: #020617;
  border-radius: 9999px;
  border: 1px solid #374151;
  padding: 6px 10px;
  font-size: 12px;
  color: #e5e7eb;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

.terminal-search-btn {
  border-radius: 9999px;
  padding: 4px 8px;
  border: 1px solid rgba(148, 163, 184, 0.35);
  background: rgba(2, 6, 23, 0.6);
  color: #e5e7eb;
  font-size: 12px;
  line-height: 1;
  cursor: pointer;
}

.terminal-search-btn:hover {
  background: rgba(17, 24, 39, 0.85);
}

.terminal-search-btn:active {
  transform: translateY(1px);
}

.terminal-search-counter {
  min-width: 52px;
  text-align: center;
  font-size: 11px;
  color: #9ca3af;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

.terminal-output {
  width: 100%;
  background: #020617;
  border-radius: 6px;
  border: 1px solid #1f2937;
  padding: 6px 8px;
  margin-bottom: 6px;

  /* —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ–º–æ–µ –æ–∫–Ω–æ: –≤—ã–≤–æ–¥ –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Å—ë –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –º–µ—Å—Ç–æ */
  flex: 1 1 auto;
  min-height: 140px;
  max-height: none;

  overflow: auto;
  white-space: pre-wrap;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 12px;
  color: #e5e7eb;
}

.terminal-output:has(.xterm) {
  padding: 0;
  overflow: hidden;
}

/* xterm-addon-search match decorations (improves readability on dark background) */
.xterm-find-result-decoration {
  border-radius: 3px;
}
.xterm-find-active-result-decoration {
  border-radius: 3px;
  box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.35) inset;
}

.terminal-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  flex-wrap: wrap;
  margin-bottom: 8px;
}

.terminal-footer-group {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
}

.terminal-footer-label {
  font-size: 11px;
  color: #9ca3af;
  font-weight: 600;
  user-select: none;
  margin-right: 2px;
}


.terminal-input-row {
  display: flex;
  gap: 8px;
}

.terminal-input-row.confirm-hidden {
  justify-content: flex-end;
}

.terminal-input {
  flex: 1;
  background: #020617;
  border-radius: 9999px;
  border: 1px solid #374151;
  padding: 6px 10px;
  font-size: 14px;
  color: #e5e7eb;
}

.terminal-send {
  border-radius: 9999px;
  padding: 6px 12px;
  border: none;
  background: #2563eb;
  color: #f9fafb;
  font-size: 14px;
  cursor: pointer;
}
.terminal-send:hover {
  background: #1d4ed8;
}


.terminal-history-btn {
  border-radius: 9999px;
  padding: 6px 10px;
  border: 1px solid #4b5563;
  background: transparent;
  color: #e5e7eb;
  font-size: 14px;
  cursor: pointer;
}
.terminal-history-btn:hover {
  background: #111827;
}



.mihomo-templates-row {
  gap: 8px;
  flex-wrap: wrap;
  overflow-x: auto;
}

.mihomo-templates-row button {
  flex: 0 0 auto;
}

.mihomo-template-select {
  min-width: 180px;
  border-radius: 9999px;
  padding: 6px 12px;
  font-size: 14px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb;
  outline: none;
  box-shadow: 0 4px 10px rgba(15, 23, 42, 0.4);
}

.mihomo-template-select:focus {
  border-color: #2563eb;
  box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.5);
}



/* Top tabs (main header + DevTools tabs)
   Base style is compact and does NOT stretch buttons across the full page.
   The main panel header uses .header-tabs modifier to stretch evenly in one line.
*/
.top-tabs {
  margin-top: 12px;
  display: flex;
  gap: 8px;
  align-items: center;
  justify-content: center;
  flex-wrap: wrap;
}

/* DevTools tabs: align with the left Tools column and stretch like the "–°–µ—Ä–≤–∏—Å –ø–∞–Ω–µ–ª–∏" block.
   Scoped via .dt-tabs to avoid affecting any other tabs/buttons in the UI.
*/
.top-tabs.dt-tabs {
  justify-content: flex-start;
  flex-wrap: nowrap;
  width: min(100%, 420px);
  margin-right: auto;
}

/* Main panel header tabs: always one line, evenly stretched */
.top-tabs.header-tabs {
  width: 100%;
  flex-wrap: nowrap;
  justify-content: space-between;
  overflow-x: auto;
  scrollbar-width: none; /* Firefox */
}

.top-tabs.header-tabs::-webkit-scrollbar {
  display: none; /* Chrome/Safari */
}

button.top-tab-btn {
  border-radius: 9999px;
  padding: 6px 10px;
  font-size: 13px;
  text-align: center;
  justify-content: center;
  display: inline-flex;
  align-items: center;
  background: #020617;
  border: 1px solid #1f2937;
  color: #e5e7eb;
  box-shadow: 0 2px 6px rgba(15, 23, 42, 0.7);
  cursor: pointer;
  white-space: nowrap;
  width: auto;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  transition:
    background 0.15s ease,
    transform 0.05s ease,
    box-shadow 0.15s ease,
    border-color 0.15s ease;
}

/* DevTools pills should share the available width (two buttons ‚âà full width of the left column). */
.top-tabs.dt-tabs .top-tab-btn {
  flex: 1 1 0;
  width: auto;
}

/* Header tabs need to share width equally */
.top-tabs.header-tabs .top-tab-btn {
  flex: 1 1 0;
  min-width: 0;
  padding: 6px 8px;
  font-size: 12px;
}

button.top-tab-btn:hover {
  background: linear-gradient(135deg, #1d4ed8, #2563eb);
  border-color: #2563eb;
  box-shadow: 0 4px 12px rgba(37, 99, 235, 0.6);
  transform: translateY(-1px);
}

button.top-tab-btn:active {
  transform: translateY(1px) scale(0.98);
  box-shadow: 0 2px 6px rgba(15, 23, 42, 0.7);
}

button.top-tab-btn.active {
  background: linear-gradient(135deg, #1d4ed8, #2563eb);
  border-color: #2563eb;
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.4);
}

.view-section {
  margin-top: 16px;
}
/* Fix terminal overflow */
.terminal-window,
.terminal-window * {
    box-sizing: border-box;
}



/* DevTools Logs: two-column layout with sidebar */
.dt-logs-layout {
  display: grid;
  grid-template-columns: minmax(220px, 280px) minmax(0, 1fr);
  gap: 14px;
  align-items: start;
}

.dt-logs-sidebar,
.dt-logs-main {
  min-width: 0;
}

.dt-logs-sidebar-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  margin-bottom: 10px;
}

.dt-log-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
  max-height: 520px;
  overflow: auto;
  padding-right: 4px;
}

.dt-log-item {
  width: 100%;
  text-align: left;
  border-radius: 14px;
  border: 1px solid #1f2937;
  background: rgba(2, 6, 23, 0.55);
  padding: 8px 10px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.dt-log-item:hover {
  border-color: #2563eb;
}

.dt-log-item.active {
  border-color: #2563eb;
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.18);
}

.dt-log-item.is-missing {
  opacity: 0.55;
  cursor: not-allowed;
}

.dt-log-item.is-missing:hover {
  border-color: #1f2937;
}

.dt-log-name {
  font-size: 12px;
  font-weight: 600;
  color: #e5e7eb;
}

.dt-log-meta {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 2px;
  font-size: 11px;
  color: #9ca3af;
  line-height: 1.1;
}

.dt-log-right {
  display: flex;
  align-items: center;
  gap: 10px;
}

.dt-log-dot {
  width: 8px;
  height: 8px;
  border-radius: 9999px;
  background: #22c55e;
  opacity: 0;
  flex: 0 0 auto;
  box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.18);
}

.dt-log-item.has-new .dt-log-dot {
  opacity: 1;
}

.dt-log-view {
  box-sizing: border-box;
  white-space: pre;
  overflow-x: auto;
}

/* DevTools Logs: highlight only the level token ([Info]/ERROR/etc.), not the whole line */
.dt-log-view.log-block .log-line-info,
.dt-log-view.log-block .log-line-warning,
.dt-log-view.log-block .log-line-error,
.dt-log-view.log-block .log-line-debug,
#dt-log-context-body .log-line-info,
#dt-log-context-body .log-line-warning,
#dt-log-context-body .log-line-error,
#dt-log-context-body .log-line-debug {
  color: inherit;
}

.dt-log-view .log-lvl,
#dt-log-context-body .log-lvl {
  font-weight: 600;
}

.dt-log-view .log-lvl-info,
#dt-log-context-body .log-lvl-info {
  color: #93c5fd;
}

.dt-log-view .log-lvl-warning,
#dt-log-context-body .log-lvl-warning {
  color: #fbbf24;
}

.dt-log-view .log-lvl-error,
#dt-log-context-body .log-lvl-error {
  color: #f87171;
}

.dt-log-view .log-lvl-debug,
#dt-log-context-body .log-lvl-debug {
  color: #a1a1aa;
}

/* DevTools Logs: Stage 4 "human" filters */
.dt-log-human-filters {
  gap: 10px;
}

.dt-log-profile {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.dt-log-profile-btn.active {
  border-color: #2563eb;
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.18);
}

.dt-log-presets {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

.dt-chip-btn {
  border-radius: 9999px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb;
  padding: 6px 10px;
  font-size: 12px;
  cursor: pointer;
  transition: border-color 0.12s ease, transform 0.12s ease, box-shadow 0.12s ease;
}

.dt-chip-btn:hover {
  border-color: #2563eb;
  transform: translateY(-1px);
}

.dt-chip-btn.active {
  border-color: #2563eb;
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.18);
}

.dt-log-advanced {
  border: 1px solid #1f2937;
  border-radius: 14px;
  padding: 6px 10px;
  background: rgba(2, 6, 23, 0.45);
}

/* Timestamp visuals inside log lines */
.log-block .log-ts {
  opacity: 0.7;
  margin-right: 8px;
  font-variant-numeric: tabular-nums;
}

/* Live Xray logs */
.xray-log-block {
  max-height: 420px;
}

.xray-log-filter,
.xray-log-select {
  min-width: 140px;
  padding: 6px 10px;
  border-radius: 9999px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb;
  font-size: 12px;
}

.xray-log-filter::placeholder {
  color: #6b7280;
}


/* Inline field validation (e.g., Regex invalid) */
.xray-log-filter.is-invalid {
  border-color: #ef4444;
  box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.25);
}

.dt-log-search-wrap {
  display: flex;
  flex-direction: column;
  min-width: 220px;
}

/* Stage 5: Include/Exclude tokens as chips */
.dt-token-field {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 6px;
  min-width: 220px;
  padding: 6px 10px;
  border-radius: 16px;
  border: 1px solid #374151;
  background: #020617;
}

.dt-token-field-compact {
  min-width: 180px;
}

.dt-token-field.is-invalid {
  border-color: #ef4444;
  box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.25);
}

.dt-token-entry {
  flex: 1;
  min-width: 120px;
  border: none;
  outline: none;
  background: transparent;
  color: #e5e7eb;
  font-size: 12px;
  padding: 2px 0;
}

.dt-token-entry::placeholder {
  color: #6b7280;
}

.dt-token-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  border-radius: 9999px;
  border: 1px solid #1f2937;
  background: rgba(2, 6, 23, 0.55);
  color: #e5e7eb;
  padding: 4px 8px;
  font-size: 12px;
  line-height: 1;
}

.dt-token-chip .dt-token-x {
  border: none;
  background: transparent;
  color: #94a3b8;
  cursor: pointer;
  font-size: 14px;
  line-height: 1;
  padding: 0;
}

.dt-token-chip .dt-token-x:hover {
  color: #f87171;
}

/* Stage 6: Level filter container */
.dt-log-level-wrap {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}

.dt-field-error {
  margin-top: 4px;
  padding-left: 10px;
  color: #f87171;
  font-size: 11px;
  line-height: 1.2;
}


/* Live Xray logs */
.xray-log-block {
  max-height: 420px;
  color: #e5e7eb;
}

.log-block .log-line {
  display: block;
}

.log-block .log-line-info {
  color: #93c5fd;
}

.log-block .log-line-warning {
  color: #fbbf24;
}

.log-block .log-line-error {
  color: #f87171;
}

.log-block .log-line-debug {
  color: #a1a1aa;
}

.xray-log-select {
  min-width: 140px;
  padding: 6px 10px;
  border-radius: 9999px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb;
  font-size: 12px;
}


.log-btn.icon-only {
  font-size: 18px;
  line-height: 1;
  padding-inline: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
}



/* Backup action buttons in backups table */
.backup-actions {
  display: flex;
  gap: 6px;
  justify-content: flex-end;
  align-items: center;
}

button.backup-icon-btn {
  flex: 0 0 auto;
  padding: 4px 10px;
  border-radius: 9999px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

button.backup-icon-btn .backup-icon,
.backup-icon-btn .backup-icon {
  width: 14px;
  height: 14px;
}

/* More prominent style for delete backup button */
button.backup-icon-btn.backup-delete-btn {
  background: linear-gradient(135deg, #b91c1c, #ef4444);
  border-color: #b91c1c;
}

/* Xray logs status lamp */
.xray-log-lamp {
  display: inline-block;
  width: 10px;
  height: 10px;
  border-radius: 9999px;
  margin-left: 8px;
  background: #6b7280;
  box-shadow: none;
  transition:
    background-color 0.2s ease,
    box-shadow 0.2s ease,
    transform 0.15s ease;
  vertical-align: middle;
}

.xray-log-lamp[data-state="on"] {
  background: #22c55e;
  box-shadow: 0 0 6px rgba(34, 197, 94, 0.7);
}

.xray-log-lamp[data-state="off"] {
  background: #4b5563;
  box-shadow: none;
}

.xray-log-lamp[data-state="error"] {
  background: #f97316;
  box-shadow: 0 0 6px rgba(249, 115, 22, 0.7);
}

.xray-log-lamp.pulse {
  transform: scale(1.2);
}

/* Mobile layout tweaks */
@media (max-width: 640px) {
  /* On small screens:
     - DevTools tabs can wrap naturally.
     - Header tabs stay on one line and become horizontally scrollable.
  */
  .top-tabs { justify-content: flex-start; }

  .top-tabs.header-tabs .top-tab-btn {
    flex: 0 0 auto;
    font-size: 12px;
    padding: 6px 10px;
  }

  table {
    font-size: 12px;
  }

  th,
  td {
    padding: 6px 4px;
  }

  .backup-actions {
    justify-content: flex-end;
  }
}


/* GitHub catalog modal */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(15, 23, 42, 0.75);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 60;
}

/* Confirm dialog must stay above other modals (e.g. file manager operations modal). */
#confirm-modal {
  z-index: 70;
}

.modal.hidden {
  display: none;
}

.modal-content {
  background: #020617;
  border-radius: 12px;
  border: 1px solid #334155;
  padding: 12px 14px 14px 14px;
  max-width: 520px;
  width: 100%;
  max-height: 80vh;
  box-sizing: border-box;
  box-shadow: 0 18px 50px rgba(15, 23, 42, 0.8);
  display: flex;
  flex-direction: column;
}

/* Terminal history drawer (right-side modal) */
.modal.modal-drawer {
  justify-content: flex-end;
  align-items: stretch;
}

.modal.modal-drawer .modal-content {
  max-width: 420px;
  width: min(92vw, 420px);
  height: 100vh;
  max-height: 100vh;
  border-radius: 0;
  border-left: 1px solid #334155;
  border-top: 0;
  border-right: 0;
  border-bottom: 0;
}

.terminal-history-filter {
  width: 100%;
  box-sizing: border-box;
  padding: 10px 10px;
  border-radius: 10px;
  border: 1px solid #334155;
  background: rgba(255,255,255,0.04);
  color: inherit;
  outline: none;
}

.terminal-history-list {
  margin-top: 10px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  overflow: auto;
  max-height: calc(100vh - 220px);
  padding-right: 4px;
}

.terminal-history-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  padding: 8px 10px;
  border-radius: 10px;
  border: 1px solid rgba(51,65,85,0.7);
  background: rgba(255,255,255,0.03);
  cursor: pointer;
}

.terminal-history-item:hover {
  background: rgba(255,255,255,0.06);
}

.terminal-history-item.selected {
  border-color: rgba(56,189,248,0.85);
  box-shadow: 0 0 0 2px rgba(56,189,248,0.15);
}

.terminal-history-cmd {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 0.9rem;
  word-break: break-word;
  white-space: pre-wrap;
  opacity: 0.95;
}

.terminal-history-hint {
  margin-top: 8px;
  font-size: 0.85rem;
  opacity: 0.75;
}



.modal-actions {
  margin-top: 12px;
  display: flex;
  justify-content: space-between;
  gap: 8px;
  align-items: center;
}

.github-config-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-top: 8px;
}

.github-config-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  padding: 6px 8px;
  border-radius: 6px;
  background: rgba(255,255,255,0.04);
}

.github-config-title {
  font-weight: 600;
}

.github-config-meta {
  font-size: 0.8rem;
  opacity: 0.8;
}


.github-export-form {
  margin-top: 8px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.github-export-form input,
.github-export-form textarea {
  width: 100%;
  background: #111827;
  border: 1px solid #374151;
  color: #e5e7eb;
  border-radius: 6px;
  padding: 6px 8px;
  font-size: 0.9rem;
  box-sizing: border-box;
}


.modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 10px;
  padding-bottom: 6px;
  border-bottom: 1px solid #1f2937;
}

.modal-title {
  font-size: 15px;
  font-weight: 600;
}

.modal-close {
  background: transparent;
  border: none;
  color: #9ca3af;
  cursor: pointer;
  font-size: 18px;
  line-height: 1;
}

.modal-close:hover {
  color: #e5e7eb;
}

.modal-body {
  margin-top: 8px;
  margin-bottom: 10px;
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
}

/* Donate modal (üí∞ –î–æ–Ω–∞—Ç) */
#donate-modal .modal-content {
  max-width: 760px;
}

.donate-modal-content {
  padding: 14px 16px 16px 16px;
}

.donate-lead {
  margin: 0 0 12px 0;
  font-size: 14px;
  line-height: 1.45;
  opacity: 0.95;
}

.donate-coins {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.donate-coin {
  border: 1px solid rgba(51, 65, 85, 0.75);
  background: rgba(255, 255, 255, 0.03);
  border-radius: 14px;
  padding: 10px 10px 12px 10px;
}

.donate-coin-title {
  display: flex;
  align-items: baseline;
  gap: 6px;
  font-size: 13px;
  font-weight: 600;
  margin-bottom: 8px;
}

.donate-coin-sub {
  font-weight: 500;
  font-size: 12px;
  opacity: 0.75;
}

.donate-address {
  width: 100%;
  display: inline-flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid rgba(51, 65, 85, 0.85);
  background: rgba(2, 6, 23, 0.75);
  color: inherit;
  cursor: pointer;
  text-align: left;
  box-sizing: border-box;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 12.5px;
  line-height: 1.35;
  transition: transform 0.05s ease, box-shadow 0.15s ease, border-color 0.15s ease, background 0.15s ease;
}

.donate-address-text {
  overflow-wrap: anywhere;
  word-break: break-word;
}

.donate-address-icon {
  flex: 0 0 auto;
  opacity: 0.75;
}

.donate-address:hover {
  border-color: rgba(37, 99, 235, 0.7);
  box-shadow: 0 10px 25px rgba(37, 99, 235, 0.22);
  transform: translateY(-1px);
}

.donate-address:active {
  transform: translateY(1px) scale(0.99);
}

.donate-hint {
  margin-top: 10px;
  font-size: 12px;
  opacity: 0.75;
}

html[data-theme="light"] .donate-coin {
  background: rgba(15, 23, 42, 0.04);
  border-color: rgba(15, 23, 42, 0.18);
}

html[data-theme="light"] .donate-address {
  background: rgba(255, 255, 255, 0.85);
  border-color: rgba(15, 23, 42, 0.18);
  box-shadow: 0 4px 10px rgba(15, 23, 42, 0.08);
}

html[data-theme="light"] .donate-address:hover {
  border-color: rgba(37, 99, 235, 0.55);
  box-shadow: 0 10px 25px rgba(37, 99, 235, 0.16);
}

/* DevTools: ENV help modal/table */
#dt-env-help-modal .modal-content {
  width: min(1120px, 96vw);
  max-width: 1120px;
}

/* Let the help modal scroll horizontally if something still overflows. */
#dt-env-help-modal .modal-body {
  overflow-x: auto;
}

.dt-env-help-table-wrap {
  overflow: auto;
  border: 1px solid rgba(51,65,85,0.6);
  border-radius: 10px;
}

.dt-env-help-table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
}

.dt-env-help-table th,
.dt-env-help-table td {
  text-align: left;
  vertical-align: top;
  padding: 8px 10px;
  border-bottom: 1px solid rgba(51,65,85,0.35);
  white-space: normal;
  overflow-wrap: anywhere;
  word-break: break-word;
  hyphens: auto;
}

.dt-env-help-table thead th {
  position: sticky;
  top: 0;
  background: rgba(2,6,23,0.92);
  backdrop-filter: blur(6px);
}

html[data-theme="light"] .dt-env-help-table thead th {
  background: rgba(255,255,255,0.92);
}

.dt-env-help-col-key { width: 260px; white-space: nowrap; }
.dt-env-help-col-restart { width: 190px; }

.dt-env-help-td-key code {
  white-space: nowrap;
}

@media (max-width: 720px) {
  .dt-env-help-col-key { width: 210px; }
  .dt-env-help-col-restart { width: 150px; }
}

/*
  JSON editor modal: avoid "double scroll" (outer modal-body + inner CodeMirror).
  Keep modal-body non-scrollable and let CodeMirror stretch & scroll.
*/
#json-editor-modal .modal-content {
  /*
    IMPORTANT:
    `.modal-content` has `max-height: 80vh` globally, but no explicit `height`.
    If the JSON content doesn't immediately force the modal to reach its max-height,
    CodeMirror can end up with an effectively unbounded height (because the global
    `.CodeMirror { height: auto; }` rule lets it grow with content). In that case
    the extra lines get clipped by the modal layout, and the internal scrollbar may
    not appear.

    Setting an explicit height for the JSON editor modal guarantees that CodeMirror
    always has a bounded area and shows the same vertical scrollbar behavior for
    both 03_inbounds.json and 04_outbounds.json.
  */
  height: 80vh;
}

/* JSON editor modal: let the scroll area use the available height (no global cap) */
#json-editor-modal .CodeMirror-scroll {
  max-height: none !important;
  height: 100% !important;
}

#json-editor-modal .modal-body {
  overflow: hidden;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* CodeMirror wrapper inside JSON editor modal should occupy remaining height */
#json-editor-modal .CodeMirror {
  flex: 1 1 auto;
  min-height: 0;
  height: 100% !important; /* override CodeMirror's default 300px */
}

/* Keep fallback textarea usable if CodeMirror fails to load */
#json-editor-modal textarea#json-editor-textarea {
  flex: 1 1 auto;
  min-height: 0;
  height: 100%;
  overflow: auto;
}


/* File manager text editor modal: avoid "double scroll" (outer modal-body + inner CodeMirror) */
#fm-editor-modal .modal-content {
  height: 80vh;
  max-width: 980px;
}

#fm-editor-modal .modal-body {
  overflow: hidden;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

#fm-editor-modal .CodeMirror-scroll {
  max-height: none !important;
  height: 100% !important;
}

#fm-editor-modal .CodeMirror {
  flex: 1 1 auto;
  min-height: 0;
  height: 100% !important;
}

/* Keep fallback textarea usable if CodeMirror fails to load */
#fm-editor-modal textarea#fm-editor-textarea {
  flex: 1 1 auto;
  min-height: 0;
  height: 100%;
  overflow: auto;
}

/* Routing help modal (iframe): avoid "double scroll" (outer modal-body + inner iframe) */
#xkeen-routing-help-modal .modal-content {
  height: 80vh;
}

#xkeen-routing-help-modal .modal-body {
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

#xkeen-routing-help-modal iframe {
  flex: 1 1 auto;
  min-height: 0;
}




#toast-container {
  position: fixed;
  right: 16px;
  bottom: 16px;
  z-index: 80;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.toast {
  min-width: 260px;
  max-width: 360px;
  background: #020617;
  border-radius: 10px;
  border: 1px solid #22c55e;
  box-shadow: 0 18px 40px rgba(22, 163, 74, 0.4);
  padding: 10px 12px;
  font-size: 0.86rem;
  color: #e5e7eb;
  display: flex;
  align-items: flex-start;
  gap: 8px;
}

.toast-error {
  border-color: #ef4444;
  box-shadow: 0 18px 40px rgba(239, 68, 68, 0.4);
}

.toast-icon {
  font-size: 1.1rem;
  margin-top: 1px;
}

.toast-message {
  flex: 1;
}


/* Global auto-restart toggle in header */
.global-toggle-row {
  margin-top: 8px;
  display: flex;
  justify-content: flex-end;
  align-items: flex-start;
}

/* –°–ø—Ä–∞–≤–∞: —á–µ–∫–±–æ–∫—Å –∞–≤—Ç–æ‚Äë–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ + –±–µ–π–¥–∂ "–ó–∞–≥—Ä—É–∂–µ–Ω–æ ...
.fm-help-body{
  font-size: 0.95rem;
  line-height: 1.35;
}
.fm-help-body h3{
  margin: 14px 0 6px 0;
  font-size: 1rem;
}
.fm-help-body ul{
  margin: 6px 0 0 18px;
}
.fm-help-body li{
  margin: 4px 0;
}
" —Å—Ç—Ä–æ–≥–æ –ø–æ–¥ –Ω–∏–º */
.global-toggle-right {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 6px;
}

.global-autorestart-toggle {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  color: #9ca3af;
  user-select: none;
}

.global-autorestart-toggle input[type="checkbox"] {
  width: 14px;
  height: 14px;
  cursor: pointer;
}

.global-autorestart-toggle span {
  cursor: pointer;
}


.xkeen-ctrl-row {
  margin-top: 8px;
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  gap: 12px;
  flex-wrap: wrap;
}




/* –ë–µ–π–¥–∂ —Å–ø—Ä–∞–≤–∞: –ø–æ–¥ —á–µ–∫–±–æ–∫—Å–æ–º –∏ –≤—ã—Ä–æ–≤–Ω–µ–Ω –ø–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é */
.global-toggle-right .last-load-badge {
  margin-left: 0;
  align-self: flex-end;
}
.xkeen-ctrl-group {
  display: inline-flex;
  gap: 4px;
}

/* –ë–µ–π–¥–∂ ¬´–ó–∞–≥—Ä—É–∂–µ–Ω–æ ...
.fm-help-body{
  font-size: 0.95rem;
  line-height: 1.35;
}
.fm-help-body h3{
  margin: 14px 0 6px 0;
  font-size: 1rem;
}
.fm-help-body ul{
  margin: 6px 0 0 18px;
}
.fm-help-body li{
  margin: 4px 0;
}
.xkeen-ctrl-row .last-load-badge {
  margin-left: 0;
}

.xkeen-ctrl-btn {
  padding: 3px 10px;
  font-size: 11px;
  border-radius: 9999px;
  border: 1px solid #1f2937;
  background: #020617;
  color: #e5e7eb;
  box-shadow: 0 2px 6px rgba(15, 23, 42, 0.7);
  cursor: pointer;
  transition:
    background 0.15s ease,
    transform 0.05s ease,
    box-shadow 0.15s ease,
    border-color 0.15s ease;
}

/* DevTools: make Start/Stop/Restart compact and match Refresh button typography */
.actions button.dt-ui-action {
  flex: 0 0 auto;
  white-space: nowrap;
  min-width: 92px;
  padding: 6px 14px;
  font-size: 14px;
}

/* DevTools (Tools tab): keep Start/Stop/Restart on a single row */
.dt-service-actions {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 8px;
}

.dt-service-actions button.dt-ui-action {
  width: 100%;
  min-width: 0;
  padding: 6px 10px;
  font-size: 13px;
}

.dt-service-actions-secondary {
  margin-top: 8px;
  display: flex;
}

.dt-service-actions-secondary button {
  width: 100%;
}

/* DevTools: logging block (pill style, single column) */
.dt-logging-card .dt-logging-grid {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.dt-logging-card .dt-logging-field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.dt-logging-card .dt-logging-label {
  font-size: 12px;
  line-height: 1.1;
  opacity: 0.88;
}

.dt-logging-card .dt-pill-field {
  width: 100%;
  min-width: 0;
  padding: 6px 10px;
  border-radius: 9999px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb;
  font-size: 12px;
  box-sizing: border-box;
}

.dt-logging-card .dt-pill-field:focus {
  outline: none;
  border-color: rgba(37, 99, 235, 0.9);
  box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.25);
}

.dt-logging-card .dt-logging-switch {
  align-self: flex-start;
}

.dt-logging-actions {
  margin-top: 10px;
  display: flex;
}

.dt-logging-actions button {
  width: 100%;
}

/* DevTools: toolbars shouldn't force buttons to stretch full width */
.actions.dt-log-toolbar button {
  flex: 0 0 auto;
  white-space: nowrap;
}

/* DevTools Logs: line actions (Stage 8) */
.dt-log-line-menu {
  position: fixed;
  z-index: 65;
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 8px;
  border-radius: 12px;
  border: 1px solid #334155;
  background: #020617;
  box-shadow: 0 18px 50px rgba(15, 23, 42, 0.8);
}

.dt-log-line-menu.hidden {
  display: none;
}

.dt-log-line-menu button {
  width: 100%;
  text-align: left;
}

.dt-log-context-focus {
  background: rgba(37, 99, 235, 0.16);
  border-left: 3px solid #2563eb;
  padding-left: 8px;
}


/* DevTools Logs: tail -f controls (Stage 3 scaffold) */
.dt-log-badge {
  flex: 0 0 auto;
  white-space: nowrap;
  padding: 6px 10px;
  border-radius: 9999px;
  border: 1px solid #2563eb;
  background: rgba(37, 99, 235, 0.18);
  color: #e5e7eb;
  font-size: 12px;
  cursor: pointer;
}

.dt-log-badge:hover {
  border-color: #60a5fa;
  box-shadow: 0 4px 12px rgba(37, 99, 235, 0.22);
}

#dt-log-pause.is-paused {
  border-color: #f59e0b;
  box-shadow: 0 4px 12px rgba(245, 158, 11, 0.18);
}
/* DevTools: ENV table should use most of the viewport */
.dt-env-scroll {
  overflow: auto;
  max-height: calc(100vh - 260px);
}

/* DevTools: ENV editor inputs should look consistent in dark theme */
.dt-env-input {
  width: 100%;
  padding: 6px 8px;
  border-radius: 8px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb;
  box-sizing: border-box;
  font-size: 13px;
}

.dt-env-input:focus {
  outline: none;
  border-color: #60a5fa;
  box-shadow: 0 0 0 1px #1d4ed8;
}
.xkeen-ctrl-btn.loading {
  position: relative;
  color: #9ca3af;
  cursor: wait;
}

.xkeen-ctrl-btn.loading::after {
  content: '';
  position: absolute;
  right: 10px;
  top: 50%;
  width: 14px;
  height: 14px;
  margin-top: -7px;
  border-radius: 999px;
  border: 2px solid rgba(148, 163, 184, 0.6);
  border-top-color: #e5e7eb;
  animation: xkeen-spinner 0.8s linear infinite;
}

@keyframes xkeen-spinner {
  from { transform: translateY(-50%) rotate(0deg); }
  to   { transform: translateY(-50%) rotate(360deg); }
}


@keyframes xkeen-global-spinner {
  from { transform: rotate(0deg); }
  to   { transform: rotate(360deg); }
}
.xkeen-ctrl-btn.loading {
  position: relative;
  color: #9ca3af;
  cursor: wait;
}

.xkeen-ctrl-btn.loading::after {
  content: '';
  position: absolute;
  right: 10px;
  top: 50%;
  width: 14px;
  height: 14px;
  margin-top: -7px;
  border-radius: 999px;
  border: 2px solid rgba(148, 163, 184, 0.6);
  border-top-color: #e5e7eb;
  animation: xkeen-spinner 0.8s linear infinite;
}

@keyframes xkeen-spinner {
  from { transform: translateY(-50%) rotate(0deg); }
  to   { transform: translateY(-50%) rotate(360deg); }
}


.xkeen-ctrl-btn:hover {
  background: linear-gradient(135deg, #1d4ed8, #2563eb);
  border-color: #2563eb;
  box-shadow: 0 4px 12px rgba(37, 99, 235, 0.6);
  transform: translateY(-1px);
}

.xkeen-ctrl-btn:active {
  transform: translateY(1px) scale(0.98);
  box-shadow: 0 2px 6px rgba(15, 23, 42, 0.7);
}



textarea#json-editor-textarea {
  width: 100%;
  min-height: 260px;
  max-height: 60vh;
  height: 260px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 14px;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb; /* –∫–∞–∫ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ 05_routing */
  resize: none; /* –∏–∑–±–µ–≥–∞–µ–º –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —Ä–∞—Å—Ç—è–≥–∏–≤–∞–Ω–∏–∏ */
  box-sizing: border-box;
  overflow-y: auto;
}



#routing-help-line {
  cursor: pointer;
  display: inline-block;
  margin-top: -4px;
  margin-bottom: 2px;
}



#routing-help-line:hover {
  animation: routing-help-blink 1s infinite;
}

@keyframes routing-help-blink {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.4;
  }
}


#mihomo-profiles-link {
  cursor: pointer;
  display: inline-block;
  margin-top: -4px;
  margin-bottom: 4px;
  font-size: 14px;
}

#mihomo-profiles-link:hover {
  animation: routing-help-blink 1s infinite;
}
/* Custom tooltip for XKeen commands */
.command-item::after {
  content: attr(data-tooltip);
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: calc(100% + 6px);
  padding: 6px 8px;
  border-radius: 8px;
  background: rgba(15, 23, 42, 0.98);
  color: #e5e7eb;
  font-size: 11px;
  line-height: 1.3;
  white-space: normal;
  max-width: 260px;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.45);
  opacity: 0;
  pointer-events: none;
  z-index: 40;
}

.command-item::before {
  content: "";
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: 100%;
  border-width: 6px;
  border-style: solid;
  border-color: transparent transparent rgba(15, 23, 42, 0.98) transparent;
  opacity: 0;
  pointer-events: none;
  z-index: 39;
}

.command-item:hover::after,
.command-item:hover::before {
  opacity: 1;
}



/* --- Mihomo generator layout --- */
.xkeen-input {
  width: 100%;
  padding: 6px 8px;
  margin: 4px 0 8px;
  border-radius: 8px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb;
  box-sizing: border-box;
  font-size: 14px;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
}

.xkeen-input:focus {
  outline: none;
  border-color: #60a5fa;
  box-shadow: 0 0 0 1px #1d4ed8;
}

.small-textarea {
  min-height: 120px;
}

.mihomo-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  margin-top: 12px;
}

.mihomo-column {
  flex: 1 1 260px;
  min-width: 260px;
}

.xkeen-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
  margin-top: 8px;
}

.xkeen-table th,
.xkeen-table td {
  padding: 6px 8px;
  border-bottom: 1px solid #1f2933;
  text-align: left;
}

.xkeen-table th {
  font-weight: 600;
  color: #d1d5db;
}

.xkeen-table tbody tr:hover {
  background: #020617;
}


/* Xray log filter row */
.log-filter-row {
  margin: 8px 0;
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
}

.log-filter-row .xray-log-filter {
  flex: 1;
}


/* DevTools Logs: compact topbar + controls (short panel) */
.dt-log-topbar{
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 10px;
  flex-wrap: wrap;
  margin: 4px 0 8px 0;
}

.dt-log-topbar-actions{
  display:flex;
  align-items:center;
  gap: 8px;
  flex-wrap: wrap;
}

/* DevTools Logs: make secondary buttons match compact pill controls */
.dt-log-btn{
  padding: 6px 10px;
  font-size: 12px;
  line-height: 1;
  border-radius: 9999px;
}

.dt-log-menu{
  position: relative;
}

.dt-log-menu > summary{
  list-style: none;
}

.dt-log-menu > summary::-webkit-details-marker{ display:none; }

.dt-log-menu[open] > summary{
  border-color: #2563eb;
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.18);
}

.dt-log-menu-panel{
  position: absolute;
  right: 0;
  top: calc(100% + 8px);
  min-width: 240px;
  padding: 10px;
  border-radius: 14px;
  border: 1px solid #334155;
  background: #020617;
  box-shadow: 0 18px 50px rgba(15, 23, 42, 0.8);
  display: flex;
  flex-direction: column;
  gap: 8px;
  z-index: 60;
}

.dt-log-menu-row{
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 10px;
}

.dt-log-lines-input{
  width: 92px;
  padding: 6px 10px;
  border-radius: 9999px;
  border: 1px solid #374151;
  background: #020617;
  color: #e5e7eb;
  font-size: 12px;
  box-sizing: border-box;
}

.dt-log-lines-input:focus{
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 1px #3b82f6;
}

.dt-log-controls{
  margin: 8px 0;
  display:flex;
  align-items:center;
  gap: 8px;
  flex-wrap: wrap;
}

.dt-log-search-group{
  flex: 1 1 360px;
  min-width: 240px;
  display:flex;
  align-items:center;
  gap: 8px;
}

.dt-log-filter{
  flex: 1 1 auto;
}

.dt-log-interval{
  display:inline-flex;
  align-items:center;
  gap: 8px;
}

.dt-log-interval-label{
  font-size: 12px;
  opacity: 0.85;
}

/* Small switch-like pill (used in DevTools Logs controls) */
.dt-switch{
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  user-select: none;
  font-size: 12px;
  line-height: 1;
  padding: 6px 8px;
  border-radius: 9999px;
  border: 1px solid rgba(51,65,85,0.55);
  background: rgba(255,255,255,0.02);
}

.dt-switch:hover{ background: rgba(255,255,255,0.04); }

.dt-switch input{
  position: absolute;
  opacity: 0;
  width: 1px;
  height: 1px;
}

.dt-switch-slider{
  width: 34px;
  height: 18px;
  border-radius: 999px;
  background: rgba(51,65,85,0.75);
  border: 1px solid rgba(51,65,85,0.85);
  position: relative;
  flex: 0 0 auto;
}

.dt-switch-slider::after{
  content: "";
  position: absolute;
  top: 1px;
  left: 1px;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: rgba(226,232,240,0.92);
  transition: transform 0.15s ease;
}

.dt-switch input:checked + .dt-switch-slider{
  background: rgba(37,99,235,0.45);
  border-color: rgba(37,99,235,0.65);
}

.dt-switch input:checked + .dt-switch-slider::after{ transform: translateX(16px); }

.dt-switch-label{ opacity: 0.85; }

.dt-log-stats{
  margin-left: auto;
  white-space: nowrap;
  padding: 6px 10px;
  border-radius: 9999px;
  border: 1px solid rgba(51,65,85,0.55);
  background: rgba(255,255,255,0.02);
  opacity: 0.92;
}

.dt-log-stats:empty{ display:none; }


/* Generic small round icon-only buttons (used for Mihomo profiles/backups controls) */
button.icon-btn {
  padding-inline: 10px;
  min-width: 32px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}


/* Backup filename marquee to prevent layout breaking */
.backup-filename-marquee {
  max-width: 220px;
  overflow: hidden;
  position: relative;
  white-space: nowrap;
}

.backup-filename-marquee-inner {
  display: inline-block;
  padding-left: 100%;
  animation: backup-filename-scroll 12s linear infinite;
}

.backup-filename-marquee:hover .backup-filename-marquee-inner {
  animation-play-state: paused;
}

@keyframes backup-filename-scroll {
  0% {
    transform: translateX(0);
  }
  100% {
    transform: translateX(-100%);
  }
}


/* Global XKeen overlay spinner */
#global-xkeen-spinner {
  position: fixed;
  inset: 0;
  background: rgba(15, 23, 42, 0.65);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

#global-xkeen-spinner.is-active {
  display: flex;
}

.global-spinner-box {
  min-width: 260px;
  max-width: 320px;
  padding: 16px 20px;
  background: #020617;
  border-radius: 12px;
  border: 1px solid #1f2937;
  box-shadow: 0 18px 38px rgba(15, 23, 42, 0.9);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
}

.global-spinner-icon {
  display: inline-block;
  flex-shrink: 0;
  width: 18px;
  height: 18px;
  border-radius: 999px;
  border: 2px solid rgba(34, 197, 94, 0.35);
  border-top-color: #22c55e;
  animation: xkeen-global-spinner 0.8s linear infinite;
}

.global-spinner-text {
  font-size: 14px;
  color: #e5e7eb;
  text-align: center;
}



.modal-body-logs {
  font-family: monospace;
  font-size: 12px;
}

.log-line {
  line-height: 1.35;
  white-space: pre-wrap;
}
.log-info {
  color: #60a5fa;
}
.log-warn {
  color: #facc15;
}
.log-error {
  color: #f87171;
}
.log-fatal {
  color: #fb7185;
  font-weight: 600;
}
.log-debug {
  color: #9ca3af;
}

/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –¥–ª—è Live Xray logs */
.log-route {
  font-weight: 500;
}

.log-route-tproxy-vless {
  color: #22c55e; /* –∑–µ–ª—ë–Ω—ã–π: tproxy -> vless-reality */
}

.log-route-redirect-vless {
  color: #38bdf8; /* –≥–æ–ª—É–±–æ–π: redirect -> vless-reality */
}

.log-route-redirect-direct {
  color: #a855f7; /* —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π: redirect -> direct */
}

.log-route-reject {
  color: #f97373; /* –∫—Ä–∞—Å–Ω—ã–π: reject */
  font-weight: 600;
}

.log-ip {
  color: #fde68a; /* —Ç—ë–ø–ª—ã–π –∂—ë–ª—Ç—ã–π –¥–ª—è IP */
}

.log-domain {
  color: #6ee7b7; /* –º—è—Ç–Ω—ã–π –¥–ª—è –¥–æ–º–µ–Ω–æ–≤ */
}

/* === –¢–µ–º—ã: —Ç—ë–º–Ω–∞—è / —Å–≤–µ—Ç–ª–∞—è === */

html[data-theme="dark"] {
  color-scheme: dark;
}

html[data-theme="light"] {
  color-scheme: light;
}

/* –ü–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã (–≤–∏–¥–Ω–∞ –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö) */
.theme-toggle-floating {
  position: fixed;
  top: 12px;
  right: 12px;
  z-index: 1000;
}

.theme-toggle-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  border-radius: 9999px;
  padding: 4px 10px;
  font-size: 12px;
  line-height: 1;
  border: 1px solid transparent;
  background: transparent;
  cursor: pointer;
}

/* –°—Ç–∏–ª—å –∫–Ω–æ–ø–∫–∏ –≤ —Ç—ë–º–Ω–æ–π —Ç–µ–º–µ */
html[data-theme="dark"] .theme-toggle-btn {
  background: rgba(15, 23, 42, 0.9);
  border-color: #1f2937;
  color: #e5e7eb;
  box-shadow: 0 4px 10px rgba(15, 23, 42, 0.7);
}

/* –°—Ç–∏–ª—å –∫–Ω–æ–ø–∫–∏ –≤ —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º–µ –≤ –¥—É—Ö–µ macOS */
html[data-theme="light"] .theme-toggle-btn {
  background: rgba(255, 255, 255, 0.8);
  border-color: #d1d5db;
  color: #111827;
  backdrop-filter: blur(12px);
  box-shadow: 0 4px 12px rgba(15, 23, 42, 0.18);
}

.theme-toggle-btn:hover {
  transform: translateY(-1px);
}

.theme-toggle-btn:active {
  transform: translateY(0);
}

.theme-toggle-icon {
  font-size: 14px;
}

/* === –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ (–º–∞–∫–æ–≤—Å–∫–∏–µ –æ—Ç—Ç–µ–Ω–∫–∏) === */

html[data-theme="light"] body {
  background: #f5f5f7;
  color: #111827;
}

/* –°—Å—ã–ª–∫–∏ ‚Äî —Å–∏–Ω–∏–π –æ—Ç—Ç–µ–Ω–æ–∫ –∫–∞–∫ –≤ macOS */
html[data-theme="light"] a {
  color: #0a84ff;
}

html[data-theme="light"] a:hover {
  text-decoration: underline;
}

/* –ö–∞—Ä—Ç–æ—á–∫–∏ / –ø–∞–Ω–µ–ª–∏ */
html[data-theme="light"] .card {
  background: #ffffff;
  border-color: #d1d5db;
  box-shadow: 0 12px 30px rgba(15, 23, 42, 0.08);
}

/* –¢–∞–±–ª–∏—Ü—ã */
html[data-theme="light"] table {
  background: #ffffff;
}

html[data-theme="light"] th {
  background: #f3f4f6;
  border-bottom-color: #e5e7eb;
}

html[data-theme="light"] td {
  border-bottom-color: #e5e7eb;
}

/* –ë–∞–∑–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏ */
html[data-theme="light"] button {
  background: #ffffff;
  border-color: #d1d5db;
  color: #111827;
  box-shadow: 0 4px 10px rgba(15, 23, 42, 0.12);
}

html[data-theme="light"] button:disabled {
  background: #e5e7eb;
  color: #9ca3af;
}

/* –ü–æ–ª—è –≤–≤–æ–¥–∞ –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ–±–ª–∞—Å—Ç–∏ */
html[data-theme="light"] input,
html[data-theme="light"] select,
html[data-theme="light"] textarea,
html[data-theme="light"] .xkeen-textarea {
  background: #ffffff;
  color: #111827;
  border-color: #d1d5db;
}

/* –õ–∞–º–ø–æ—á–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ */
html[data-theme="light"] .service-status-lamp[data-state="running"] {
  box-shadow: 0 0 6px rgba(34, 197, 94, 0.4);
}

html[data-theme="light"] .service-status-lamp[data-state="stopped"],
html[data-theme="light"] .service-status-lamp[data-state="error"] {
  box-shadow: 0 0 6px rgba(248, 113, 113, 0.4);
}

/* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
html[data-theme="light"] .modal {
  background: #ffffff;
  border-color: #d1d5db;
}

/* === –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∫–∏ —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã: –±–æ–ª–µ–µ —Ç—ë–º–Ω—ã–π —Ç–µ–∫—Å—Ç –∏ —Å–≤–µ—Ç–ª—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä === */

/* –ß—É—Ç—å –±–æ–ª–µ–µ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–π ¬´–≤—Ç–æ—Ä–∏—á–Ω—ã–π¬ª —Ç–µ–∫—Å—Ç */
html[data-theme="light"] .card p,
html[data-theme="light"] .hint,
html[data-theme="light"] .edit-toggle,
html[data-theme="light"] .command-item-desc {
  color: #4b5563;
}

/* YAML-–ø—Ä–æ—Å–º–æ—Ç—Ä –∏ CodeMirror –≤ —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º–µ */
html[data-theme="light"] .xkeen-textarea,
html[data-theme="light"] .CodeMirror {
  background: #f9fafb;
  color: #111827;
  border-color: #d1d5db;
  box-shadow: 0 1px 0 rgba(15, 23, 42, 0.03);
}

/* –°–¥–µ–ª–∞—Ç—å —Ç–µ–º—É material-darker —Å–≤–µ—Ç–ª–æ–π, –∫–æ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω–∞ —Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ –ø–∞–Ω–µ–ª–∏ */
html[data-theme="light"] .cm-s-material-darker.CodeMirror {
  background: #f9fafb;
  color: #111827;
}

html[data-theme="light"] .cm-s-material-darker .CodeMirror-gutters {
  background: #f3f4f6;
  border-right: 1px solid #e5e7eb;
}

html[data-theme="light"] .cm-s-material-darker .CodeMirror-cursor {
  border-left: 1px solid #111827;
}

/* –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ —Ü–≤–µ—Ç–∞ –ø–æ–¥—Å–≤–µ—Ç–∫–∏ –¥–ª—è YAML */
html[data-theme="light"] .cm-s-material-darker .cm-comment {
  color: #6b7280;
}

html[data-theme="light"] .cm-s-material-darker .cm-keyword {
  color: #7c3aed;
}

html[data-theme="light"] .cm-s-material-darker .cm-atom,
html[data-theme="light"] .cm-s-material-darker .cm-number,
html[data-theme="light"] .cm-s-material-darker .cm-variable-2,
html[data-theme="light"] .cm-s-material-darker .cm-variable-3,
html[data-theme="light"] .cm-s-material-darker .cm-tag,
html[data-theme="light"] .cm-s-material-darker .cm-attribute,
html[data-theme="light"] .cm-s-material-darker .cm-qualifier {
  /* –ë–æ–ª–µ–µ —Ç—ë–º–Ω—ã–π –∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–π –∑–µ–ª—ë–Ω—ã–π –¥–ª—è YAML-–º–∞—Ä–∫–µ—Ä–æ–≤ (*, & –∏ —Ç.–ø.) */
  color: #047857;
}

html[data-theme="light"] .cm-s-material-darker .cm-string {
  color: #b91c1c;
}

html[data-theme="light"] .cm-s-material-darker .cm-def,
html[data-theme="light"] .cm-s-material-darker .cm-property,
html[data-theme="light"] .cm-s-material-darker .cm-variable {
  color: #1f2937;
}

/* –í—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –Ω–∞ —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º–µ */
html[data-theme="light"] .cm-s-material-darker .CodeMirror-selected,
html[data-theme="light"] .cm-s-material-darker .CodeMirror-line::selection,
html[data-theme="light"] .cm-s-material-darker .CodeMirror-line > span::selection,
html[data-theme="light"] .cm-s-material-darker .CodeMirror-line > span > span::selection {
  background: rgba(148, 163, 184, 0.35) !important;
}

/* Light theme: softer selection (avoid "dirty" dark blocks) */
html[data-theme="light"] .xkeen-cm .CodeMirror-selected,
html[data-theme="light"] .xkeen-cm .CodeMirror-line::selection,
html[data-theme="light"] .xkeen-cm .CodeMirror-line > span::selection,
html[data-theme="light"] .xkeen-cm .CodeMirror-line > span > span::selection {
  background: rgba(10, 132, 255, 0.22) !important;
}
html[data-theme="light"] .xkeen-cm ::selection {
  background: rgba(10, 132, 255, 0.22) !important;
}


/* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞: make CodeMirror cosmetics clearly visible */
html[data-theme="light"] .cm-s-material-darker .cm-matchhighlight,
html[data-theme="light"] .xkeen-cm .cm-matchhighlight {
  background: rgba(59, 130, 246, 0.14);
}

html[data-theme="light"] .cm-s-material-darker .cm-trailingspace,
html[data-theme="light"] .xkeen-cm .cm-trailingspace {
  background: rgba(220, 38, 38, 0.16);
}

html[data-theme="light"] .cm-s-material-darker .CodeMirror-ruler,
html[data-theme="light"] .xkeen-cm .CodeMirror-ruler {
  border-left-color: rgba(17, 24, 39, 0.12);
}


/* === –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞: —á–∏—Ç–∞–µ–º—ã–µ ¬´–ö–æ–º–∞–Ω–¥—ã¬ª –∏ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ === */

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –≥—Ä—É–ø–ø—ã –∫–æ–º–∞–Ω–¥ –≤ —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º–µ */
html[data-theme="light"] .commands-header h2 {
  color: #111827;
}

html[data-theme="light"] .command-group-title {
  color: #6b7280;
}

/* –ü–ª–∞—à–∫–∏ –∫–æ–º–∞–Ω–¥ –≤ —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º–µ */
html[data-theme="light"] .command-item {
  background: #f9fafb;
  border-color: #e5e7eb;
  color: #111827;
}

html[data-theme="light"] .command-item-code code {
  color: #374151;
}

html[data-theme="light"] .command-item-desc {
  color: #4b5563;
}

html[data-theme="light"] .command-item:hover {
  background: #eff6ff;
  border-color: #3b82f6;
}

/* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –≤ —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º–µ */
html[data-theme="light"] .modal {
  background: rgba(15, 23, 42, 0.35);
}

html[data-theme="light"] .modal-content {
  background: #ffffff;
  color: #111827;
  border-color: #d1d5db;
  box-shadow: 0 20px 45px rgba(15, 23, 42, 0.18);
}

html[data-theme="light"] .modal-header {
  border-bottom-color: #e5e7eb;
}

html[data-theme="light"] .modal-close {
  color: #6b7280;
}

html[data-theme="light"] .modal-close:hover {
  color: #111827;
}

html[data-theme="light"] .modal-body-logs {
  background: #f9fafb;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
  color: #111827;
}


/* Light theme: make CodeMirror scroll area background light */
html[data-theme="light"] .CodeMirror-scroll {
  background-color: #f9fafb;
}


/* === –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞: –ª–æ–≥–∏ –∏ JSON-—Ä–µ–¥–∞–∫—Ç–æ—Ä === */

/* Live –ª–æ–≥–∏ Xray, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏ –Ω–∏–∂–Ω–∏–π –∂—É—Ä–Ω–∞–ª */
html[data-theme="light"] .log-block {
  background: #f9fafb;
  color: #111827;
  border-color: #e5e7eb;
}

html[data-theme="light"] .log-block .log-line-debug {
  color: #6b7280;
}

/* Light theme: DevTools log viewer (highlight only the level token) */
html[data-theme="light"] .dt-log-view .log-lvl-info {
  color: #2563eb;
}

html[data-theme="light"] #dt-log-context-body .log-lvl-info {
  color: #2563eb;
}

html[data-theme="light"] .dt-log-view .log-lvl-warning {
  color: #b45309;
}

html[data-theme="light"] #dt-log-context-body .log-lvl-warning {
  color: #b45309;
}

html[data-theme="light"] .dt-log-view .log-lvl-error {
  color: #dc2626;
}

html[data-theme="light"] #dt-log-context-body .log-lvl-error {
  color: #dc2626;
}

html[data-theme="light"] .dt-log-view .log-lvl-debug {
  color: #6b7280;
}

html[data-theme="light"] #dt-log-context-body .log-lvl-debug {
  color: #6b7280;
}

/* –¢–µ—Ä–º–∏–Ω–∞–ª (–Ω–∏–∂–Ω–∏–π –∂—É—Ä–Ω–∞–ª –≤ —Ä–∞–∑–¥–µ–ª–µ –ö–æ–º–∞–Ω–¥—ã) */
html[data-theme="light"] .terminal-output {
  background: #f9fafb;
  color: #111827;
  border-color: #e5e7eb;
}

/* –ü–æ–ª—è —Ñ–∏–ª—å—Ç—Ä–∞ / –≤—ã–±–æ—Ä–∞ –≤ –±–ª–æ–∫–µ Live –ª–æ–≥–∏ Xray */
html[data-theme="light"] .xray-log-filter,
html[data-theme="light"] .xray-log-select {
  background: #ffffff;
  color: #111827;
  border-color: #d1d5db;
}

/* DevTools logging: pill fields in light theme */
html[data-theme="light"] .dt-logging-card .dt-pill-field {
  background: #ffffff;
  color: #111827;
  border-color: #d1d5db;
}

/* DevTools Logs: compact controls in light theme */
html[data-theme="light"] .dt-log-menu-panel{
  background: #ffffff;
  border-color: #d1d5db;
  box-shadow: 0 18px 50px rgba(17, 24, 39, 0.12);
}

html[data-theme="light"] .dt-log-lines-input{
  background: #ffffff;
  color: #111827;
  border-color: #d1d5db;
}

html[data-theme="light"] .dt-switch,
html[data-theme="light"] .dt-log-interval,
html[data-theme="light"] .dt-log-stats{
  background: #ffffff;
  border-color: #d1d5db;
  color: #111827;
}

html[data-theme="light"] .dt-switch-slider{
  background: #e5e7eb;
  border-color: #d1d5db;
}

html[data-theme="light"] .dt-switch-slider::after{
  background: #ffffff;
  box-shadow: 0 1px 3px rgba(17, 24, 39, 0.12);
}

html[data-theme="light"] .dt-switch input:checked + .dt-switch-slider{
  background: rgba(37, 99, 235, 0.18);
  border-color: #2563eb;
}

/* Stage 5: Include/Exclude token fields in light theme */
html[data-theme="light"] .dt-token-field {
  background: #ffffff;
  color: #111827;
  border-color: #d1d5db;
}

html[data-theme="light"] .dt-token-entry {
  color: #111827;
}

html[data-theme="light"] .dt-token-chip {
  background: #f3f4f6;
  border-color: #e5e7eb;
  color: #111827;
}

html[data-theme="light"] .dt-token-chip .dt-token-x {
  color: #6b7280;
}

/* –ú–æ–¥–∞–ª—å–Ω—ã–π JSON-—Ä–µ–¥–∞–∫—Ç–æ—Ä 03_inbounds.json / 04_outbounds.json */
html[data-theme="light"] #json-editor-textarea {
  background: #f9fafb;
  color: #111827;
  border-color: #d1d5db;
}

/* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞: –º–∏–Ω–∏-—Ç–µ—Ä–º–∏–Ω–∞–ª –≤ —Ä–∞–∑–¥–µ–ª–µ –ö–æ–º–∞–Ω–¥—ã */
html[data-theme="light"] .terminal-window {
  background: #ffffff;
  border-color: #e5e7eb;
  box-shadow: 0 20px 40px rgba(15, 23, 42, 0.16);
}

html[data-theme="light"] .terminal-command {
  background: #f9fafb;
  color: #111827;
  border-color: #e5e7eb;
}

html[data-theme="light"] .terminal-search-input {
  background: #ffffff;
  color: #111827;
  border-color: #d1d5db;
}

html[data-theme="light"] .terminal-search-btn {
  background: rgba(248, 250, 252, 0.9);
  color: #111827;
  border-color: rgba(15, 23, 42, 0.16);
}

html[data-theme="light"] .terminal-search-btn:hover {
  background: rgba(226, 232, 240, 0.9);
}

html[data-theme="light"] .terminal-input {
  background: #ffffff;
  color: #111827;
  border-color: #d1d5db;
}

html[data-theme="light"] .terminal-tool-btn {
  background: rgba(248, 250, 252, 0.9);
  color: #111827;
  border-color: rgba(15, 23, 42, 0.16);
}

html[data-theme="light"] .terminal-tool-btn:hover {
  background: rgba(226, 232, 240, 0.9);
}

/* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞: —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã inbounds */
html[data-theme="light"] .mode-item {
  background: #f9fafb;
  border-color: #e5e7eb;
}

html[data-theme="light"] .mode-item strong {
  color: #111827;
}

html[data-theme="light"] .mode-item small {
  color: #4b5563;
}

html[data-theme="light"] .toggle {
  color: #4b5563;
}

/* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞: VLESS URL (04_outbounds.json) */
html[data-theme="light"] #outbounds-url {
  background: #ffffff;
  color: #111827;
  border-color: #d1d5db;
}


/* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞: –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —è–¥—Ä–∞ –∏ –±–µ–π–¥–∂ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏ */
html[data-theme="light"] .service-core-text {
  background: rgba(255, 255, 255, 0.9);
  border-color: #d1d5db;
  color: #111827;
  box-shadow: 0 4px 10px rgba(15, 23, 42, 0.12);
}

html[data-theme="light"] .service-core-text.has-core {
  border-color: #0a84ff;
  box-shadow: 0 0 0 1px rgba(10, 132, 255, 0.4);
  background: rgba(255, 255, 255, 0.95);
}

html[data-theme="light"] .last-load-badge {
  background: rgba(243, 244, 246, 0.9);
  border-color: #e5e7eb;
  color: #4b5563;
}

/* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞: —Ö–æ–≤–µ—Ä —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü (–≤ —Ç.—á. –ø—Ä–æ—Ñ–∏–ª–∏/–±—ç–∫–∞–ø—ã Mihomo) */
html[data-theme="light"] tbody tr:hover {
  background: #f3f4f6;
}



/* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞—Ö CodeMirror (–∫–∞–∫ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö IDE) */
.cm-s-material-darker .CodeMirror-activeline-background,
.xkeen-cm .CodeMirror-activeline-background {
  background: #111827;
}


/* Light theme: active line highlight must be light (avoid dark bars) */
html[data-theme="light"] .xkeen-cm .CodeMirror-activeline-background,
html[data-theme="light"] .cm-s-material-darker .CodeMirror-activeline-background,
html[data-theme="light"] .cm-s-default .CodeMirror-activeline-background {
  background: rgba(15, 23, 42, 0.06);
}



/* Indent guides rendered via overlay (spaces & tabs at line start). */
.xkeen-cm .cm-indent-guide {
  position: relative;
}

.xkeen-cm .cm-indent-guide::before {
  content: "";
  position: absolute;
  left: 0;
  top: -2px;
  bottom: -2px;
  border-left: 1px solid rgba(55, 65, 81, 0.8);
  opacity: 0.9;
}
/* –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏–µ –æ—Ç—Å—Ç—É–ø–æ–≤ (indent guides) –¥–ª—è JSON/YAML —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–≤ */
.xkeen-cm .CodeMirror-code .cm-tab {
  position: relative;
}

.xkeen-cm .CodeMirror-code .cm-tab::before {
  content: "";
  position: absolute;
  left: 0;
  top: -2px;
  bottom: -2px;
  border-left: 1px solid rgba(55, 65, 81, 0.85);
  opacity: 0.7;
}


/* Light theme: indent guides should be subtle */
html[data-theme="light"] .xkeen-cm .cm-indent-guide::before,
html[data-theme="light"] .xkeen-cm .CodeMirror-code .cm-tab::before {
  border-left-color: rgba(17, 24, 39, 0.12);
  opacity: 0.7;
}





html[data-theme="light"] .terminal-uptime {
  color: #475569;
}



/* Terminal: Xray logs mini-menu (runs tail -f inside PTY) */
.terminal-xraylogs-menu{
  position:absolute;
  top:34px;
  right:48px;
  z-index:85;
  background:#020617;
  border:1px solid #334155;
  border-radius:12px;
  padding:10px;
  box-shadow:0 18px 50px rgba(15,23,42,.8);
  display:flex;
  flex-direction:column;
  gap:8px;
  min-width:220px;
}
.terminal-xraylogs-menu.hidden{ display:none; }

/* Terminal: grouped menus (overflow / view / buffer) */
.terminal-overflow-menu{
  position:absolute;
  top:34px;
  right:8px;
  z-index:90;
  background:#020617;
  border:1px solid #334155;
  border-radius:12px;
  padding:10px;
  box-shadow:0 18px 50px rgba(15,23,42,.8);
  display:flex;
  flex-direction:column;
  gap:10px;
  min-width:240px;
  max-width:340px;
  /* allow scrolling when the menu is taller than the terminal modal */
  max-height: calc(100vh - 120px);
  overflow-y: auto;
  overscroll-behavior: contain;
}
.terminal-overflow-menu.hidden{ display:none; }

.terminal-menu-section{ display:flex; flex-direction:column; gap:6px; }
.terminal-menu-title{
  font-size:11px;
  color:#9ca3af;
  font-weight:700;
  letter-spacing:.02em;
  user-select:none;
  margin-bottom:2px;
}
.terminal-menu-title-inline{ margin-top:2px; }
.terminal-menu-sep{ height:1px; background:rgba(148,163,184,0.18); margin:2px 0; }

/* Menus anchored to footer groups */
.terminal-footer-group-view,
.terminal-footer-group-buffer{ position: relative; }

.terminal-view-menu,
.terminal-buffer-menu{
  position:absolute;
  bottom:34px;
  left:0;
  z-index:90;
  background:#020617;
  border:1px solid #334155;
  border-radius:12px;
  padding:10px;
  box-shadow:0 18px 50px rgba(15,23,42,.8);
  display:flex;
  flex-direction:column;
  gap:6px;
  min-width:220px;
  max-width:320px;
  /* these menus can also grow depending on options */
  max-height: 60vh;
  overflow-y: auto;
  overscroll-behavior: contain;
}
.terminal-view-menu.hidden,
.terminal-buffer-menu.hidden{ display:none; }

/* Menu item look: reuse terminal-tool-btn but make it block-like inside menus */
.terminal-overflow-menu .terminal-tool-btn,
.terminal-view-menu .terminal-tool-btn,
.terminal-buffer-menu .terminal-tool-btn{
  width:100%;
  text-align:left;
  border-radius:10px;
  padding:8px 10px;
  display:flex;
  align-items:center;
  gap:8px;
  line-height:1.2;
}

/* Nested Xray menu is shown inline inside the overflow menu */
.terminal-overflow-menu .terminal-xraylogs-menu{
  position: static;
  top:auto;
  right:auto;
  z-index:auto;
  box-shadow:none;
  min-width: unset;
}


.terminal-xraylogs-row{ display:flex; align-items:center; gap:8px; }

/* Xray logs controls: keep them compact (icon buttons) */
.terminal-xraylogs-actions{ display:flex; gap:8px; justify-content:flex-start; }
.terminal-xraylogs-actions > button{ flex:0 0 auto; }

/*
  IMPORTANT:
  Inside .terminal-overflow-menu we style .terminal-tool-btn as full-width "menu items".
  Xray log buttons are *not* menu items; they must stay compact.
  Add a higher-specificity override so icon buttons don't stretch.
*/
.terminal-overflow-menu .terminal-xraylogs-actions .terminal-tool-btn{
  width:34px;
  height:28px;
  text-align:center;
  border-radius:9999px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:0;
  padding:0; /* icon buttons manage their own sizing */
}

.terminal-xraylogs-iconbtn{
  width:34px;
  height:28px;
  padding:0;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  font-size:13px;
  line-height:1;
}

.terminal-signals-item{
  width:100%;
  text-align:left;
  padding:8px 10px;
  border-radius:8px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  color:inherit;
  cursor:pointer;
}
.terminal-signals-item:hover{
  background:rgba(255,255,255,.08);
}



/* Terminal: Quick commands menu (footer) */
.terminal-footer-group-commands{ position: relative; }

.terminal-commands-menu{
  position:absolute;
  bottom: 34px;
  right: 0;
  z-index: 90;
  background:#020617;
  border:1px solid #334155;
  border-radius:12px;
  padding:10px;
  box-shadow:0 18px 50px rgba(15,23,42,.8);
  min-width: 280px;
  max-width: 360px;
  display:flex;
  flex-direction:column;
  gap:8px;
}
.terminal-commands-menu.hidden{ display:none; }

.terminal-commands-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
}

.terminal-commands-title{
  font-size: 12px;
  color: #cbd5e1;
  font-weight: 700;
  user-select: none;
}

.terminal-commands-mode{ display:flex; gap:6px; flex-wrap:wrap; justify-content:flex-end; }

.terminal-commands-mode-btn{
  padding:6px 10px;
  border-radius:9999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  color:inherit;
  cursor:pointer;
  font-size:12px;
}
.terminal-commands-mode-btn:hover{ background:rgba(255,255,255,.08); }
.terminal-commands-mode-btn.is-active{
  background:rgba(37,99,235,.35);
  border-color: rgba(37,99,235,.60);
}

.terminal-commands-list{
  display:flex;
  flex-direction:column;
  gap:6px;
  max-height: 260px;
  overflow:auto;
  padding-right: 2px;
}

.terminal-commands-item{
  width:100%;
  text-align:left;
  padding:8px 10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  color:inherit;
  cursor:pointer;
}
.terminal-commands-item:hover{ background:rgba(255,255,255,.08); }

.terminal-commands-item-label{
  display:block;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 12px;
  color: inherit;
}

.terminal-commands-item-desc{
  display:block;
  margin-top: 2px;
  font-size: 11px;
  color:#94a3b8;
}

.terminal-commands-hint{
  font-size: 10px;
  color:#94a3b8;
  opacity: .95;
}

html[data-theme="light"] .terminal-commands-menu{
  background:#ffffff;
  border-color: rgba(15,23,42,.15);
  box-shadow:0 18px 50px rgba(15,23,42,.18);
}
html[data-theme="light"] .terminal-commands-title{ color:#0f172a; }
html[data-theme="light"] .terminal-commands-mode-btn,
html[data-theme="light"] .terminal-commands-item{
  background: rgba(15,23,42,.04);
  border-color: rgba(15,23,42,.12);
  color:#0f172a;
}
html[data-theme="light"] .terminal-commands-item:hover,
html[data-theme="light"] .terminal-commands-mode-btn:hover{
  background: rgba(15,23,42,.08);
}
html[data-theme="light"] .terminal-commands-item-desc,
html[data-theme="light"] .terminal-commands-hint{ color:#475569; }
html[data-theme="light"] .terminal-commands-mode-btn.is-active{
  background: rgba(37,99,235,.14);
  border-color: rgba(37,99,235,.35);
}
/* Optional semantic button helpers (used in SSH modal) */
.btn-secondary{
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(51,65,85,0.9);
}
.btn-primary{
  background: rgba(37,99,235,0.18);
  border: 1px solid rgba(37,99,235,0.55);
}

/* Small square/circle icon button (used in FM connect modal) */
.btn-icon{
  padding: 6px 10px;
  width: 34px;
  height: 34px;
  min-width: 34px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  line-height: 1;
}

/* Generic tooltip for any element with data-tooltip */
.xk-tooltip{ position: relative; }
.xk-tooltip::after{
  content: attr(data-tooltip);
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: calc(100% + 8px);
  padding: 6px 8px;
  border-radius: 10px;
  background: rgba(15, 23, 42, 0.98);
  color: #e5e7eb;
  font-size: 11px;
  line-height: 1.3;
  white-space: normal;
  max-width: 280px;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.45);
  opacity: 0;
  pointer-events: none;
  z-index: 60;
}
.xk-tooltip::before{
  content: "";
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: 100%;
  border-width: 6px;
  border-style: solid;
  border-color: transparent transparent rgba(15, 23, 42, 0.98) transparent;
  opacity: 0;
  pointer-events: none;
  z-index: 59;
}
.xk-tooltip:hover::after,
.xk-tooltip:hover::before{
  opacity: 1;
}

/* Destructive action button (used in confirm modals) */
.btn-danger{
  border-color: rgba(248, 113, 113, 0.55);
  background: rgba(127, 29, 29, 0.40);
  color: #fecaca;
}
.btn-danger:hover{
  background: rgba(153, 27, 27, 0.55);
}
/* Keep danger buttons "danger" even in active state (override global button:active gradient). */
.btn-danger:active{
  background: rgba(153, 27, 27, 0.70);
  border-color: rgba(248, 113, 113, 0.75);
  box-shadow: 0 6px 16px rgba(239, 68, 68, 0.25);
  transform: translateY(1px) scale(0.99);
}

html[data-theme="light"] .btn-danger{
  border-color: rgba(239, 68, 68, 0.45);
  background: rgba(239, 68, 68, 0.10);
  color: #991b1b;
  box-shadow: 0 4px 10px rgba(15, 23, 42, 0.12);
}
html[data-theme="light"] .btn-danger:hover{
  background: rgba(239, 68, 68, 0.16);
}
html[data-theme="light"] .btn-danger:active{
  background: rgba(239, 68, 68, 0.22);
  border-color: rgba(239, 68, 68, 0.55);
  box-shadow: 0 6px 16px rgba(239, 68, 68, 0.18);
}

/* Highlighted button for PTY terminal */
.btn-interactive-shell{
  background: rgba(249,115,22,0.24);
  border: 1px solid rgba(249,115,22,0.75);
  box-shadow: 0 0 0 2px rgba(249,115,22,0.12);
  color: #ffffff;
  font-weight: 600;
}
.btn-interactive-shell:hover{
  background: rgba(249,115,22,0.34);
}
html[data-theme="light"] .btn-interactive-shell{
  background: rgba(249,115,22,0.20);
  border-color: rgba(249,115,22,0.70);
  color: #0f172a;
  box-shadow: 0 0 0 2px rgba(249,115,22,0.10);
}
html[data-theme="light"] .btn-interactive-shell:hover{
  background: rgba(249,115,22,0.28);
}

/* SSH editor layout */
.ssh-form-grid{
  display: grid;
  grid-template-columns: 140px 1fr;
  gap: 10px 12px;
  align-items: center;
}
.ssh-form-grid label{
  opacity: 0.9;
  font-size: 0.95rem;
}
.ssh-form-grid input{
  width: 100%;
  box-sizing: border-box;
}

/* SSH profile row selection */
.github-config-row.is-selected{
  border: 1px solid rgba(56,189,248,0.85);
  box-shadow: 0 0 0 2px rgba(56,189,248,0.12);
}

/* Disabled button hint */
button:disabled{
  opacity: 0.5;
  cursor: not-allowed;
}

@media (max-width: 520px){
  .ssh-form-grid{
    grid-template-columns: 1fr;
  }
}


/* ----------------------------- File manager (two-panel) ----------------------------- */
.fm-card{
  padding: 14px;
  /* Keep a safe bottom area so footer buttons don't block the resize corners */
  padding-bottom: 34px;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  /* Like the terminal window: allow user resize */
  resize: both;
  overflow: hidden;
  position: relative;
  /*
    Browser resize handle is only bottom-right.
    We add our own bottom-left handle (JS) that resizes from the left
    by widening the card and shifting it with a CSS variable.
  */
  --fm-shift-x: 0px;
  transform: translateX(var(--fm-shift-x));
  min-height: 420px;
  height: clamp(420px, 70vh, 760px);
  max-height: 90vh;
  max-width: 100%;
}

/*
  File manager has two panels with fixed/min column widths.
  In the default 960px container this can cause a horizontal scrollbar.

  On wide screens we expand the file manager card ~2cm on each side
  (‚âà +4cm total) relative to the main container, without affecting the header.
*/
@media (min-width: 1120px){
  .fm-card{
    width: calc(100% + 4cm);
    margin-left: -2cm;
    margin-right: -2cm;
    max-width: none;
  }
}

.fm-card::after{
  /* bottom-right resize hint */
  content: "";
  position: absolute;
  right: 10px;
  bottom: 10px;
  width: 14px;
  height: 14px;
  border-right: 2px solid rgba(148, 163, 184, 0.30);
  border-bottom: 2px solid rgba(148, 163, 184, 0.30);
  pointer-events: none;
  border-radius: 2px;
}

.fm-card::before{
  /* bottom-left resize hint (visual; browser handle is still bottom-right) */
  content: "";
  position: absolute;
  left: 10px;
  bottom: 10px;
  width: 14px;
  height: 14px;
  border-left: 2px solid rgba(148, 163, 184, 0.18);
  border-bottom: 2px solid rgba(148, 163, 184, 0.18);
  pointer-events: none;
  border-radius: 2px;
}

.fm-resize-handle-left{
  /* Actual draggable area for bottom-left resize (implemented in JS) */
  position: absolute;
  left: 6px;
  bottom: 6px;
  width: 22px;
  height: 22px;
  cursor: nesw-resize;
  z-index: 3;
  background: transparent;
  touch-action: none;
}

.fm-card.is-fullscreen{
  position: fixed !important;
  left: 8px !important;
  top: 8px !important;
  width: calc(100vw - 16px) !important;
  height: calc(100vh - 16px) !important;
  /* Reset the "wider-than-container" offsets used in normal mode */
  margin: 0 !important;
  max-width: none !important;
  max-height: none !important;
  resize: none !important;
  transform: none !important;
  --fm-shift-x: 0px !important;
  z-index: 45;
}

.fm-card.is-fullscreen .fm-resize-handle-left{
  display: none;
}

.fm-card.is-fullscreen::after,
.fm-card.is-fullscreen::before{
  display: none;
}
.fm-header{ display:flex; align-items:center; justify-content:space-between; gap: 12px; margin-bottom: 10px; }
.fm-header h2{ margin: 0; }
.fm-header-actions{ display:flex; gap: 8px; align-items:center; }

/* Small toggle (used for dotfiles) */
.fm-toggle{
  display: inline-flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  user-select: none;
  font-size: 12px;
  line-height: 1;
  padding: 6px 8px;
  border-radius: 10px;
  border: 1px solid rgba(51,65,85,0.55);
  background: rgba(255,255,255,0.02);
}
.fm-toggle:hover{ background: rgba(255,255,255,0.04); }
.fm-toggle input{
  position: absolute;
  opacity: 0;
  width: 1px;
  height: 1px;
}
.fm-toggle-slider{
  width: 34px;
  height: 18px;
  border-radius: 999px;
  background: rgba(51,65,85,0.75);
  border: 1px solid rgba(51,65,85,0.85);
  position: relative;
  flex: 0 0 auto;
}
.fm-toggle-slider::after{
  content: "";
  position: absolute;
  top: 1px;
  left: 1px;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: rgba(226,232,240,0.92);
  transition: transform 0.15s ease;
}
.fm-toggle input:checked + .fm-toggle-slider{
  background: rgba(37,99,235,0.45);
  border-color: rgba(37,99,235,0.65);
}
.fm-toggle input:checked + .fm-toggle-slider::after{ transform: translateX(16px); }
.fm-toggle-label{ opacity: 0.85; }

.fm-two{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  flex: 1;
  min-height: 0;
}

.fm-panel{
  border: 1px solid rgba(51,65,85,0.85);
  border-radius: 14px;
  overflow: hidden;
  background: rgba(15,23,42,0.10);
  display: flex;
  flex-direction: column;
  min-height: 0;
}
.fm-panel-active{
  box-shadow: 0 0 0 2px rgba(37,99,235,0.22);
}

.fm-panel-bar{
  display:flex;
  gap: 8px;
  align-items:center;
  padding: 8px;
  border-bottom: 1px solid rgba(51,65,85,0.6);
  background: rgba(2,6,23,0.28);
}
/*
  File manager: make the target selector (L/R) and quick paths (üìå) as compact as
  the refresh icon button next to them.

  These are native <select> elements, but we style them to look like small
  pill-shaped icon buttons.
*/
.fm-bookmarks-select,
.fm-target-select{
  /* Match <button> + .btn-secondary visual language */
  border-radius: 9999px;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(51,65,85,0.9);
  box-shadow: 0 4px 10px rgba(15, 23, 42, 0.7);
  color: inherit;

  /* Compact sizing (icon-like) */
  height: 32px;
  padding: 6px 12px;
  line-height: 18px;

  /* Behave like a button */
  cursor: pointer;
  transition:
    background 0.15s ease,
    transform 0.05s ease,
    box-shadow 0.15s ease,
    border-color 0.15s ease;

  /* Hide native select arrow so it reads like an icon button */
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  background-image: none;
  text-align: center;
  text-align-last: center;
}

/* Keep them really small: they only show a single glyph (L/R, üìå) */
.fm-target-select{
  width: 44px;
  min-width: 44px;
  max-width: 44px;
}
.fm-bookmarks-select{
  width: 52px;
  min-width: 52px;
  max-width: 52px;
}

.fm-bookmarks-select:hover,
.fm-target-select:hover{
  background: rgba(255,255,255,0.06);
  border-color: rgba(148,163,184,0.55);
  box-shadow: 0 8px 20px rgba(15, 23, 42, 0.9);
  transform: translateY(-1px);
}

.fm-bookmarks-select:active,
.fm-target-select:active{
  background: linear-gradient(135deg, rgba(29, 78, 216, 0.40), rgba(37, 99, 235, 0.45));
  border-color: rgba(37,99,235,0.65);
  transform: translateY(1px) scale(0.99);
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.25);
}

.fm-bookmarks-select:focus,
.fm-target-select:focus{
  outline: none;
  box-shadow:
    0 0 0 2px rgba(37,99,235,0.22),
    0 4px 10px rgba(15, 23, 42, 0.7);
}

/* Light theme: align with light buttons */
html[data-theme="light"] .fm-bookmarks-select,
html[data-theme="light"] .fm-target-select{
  background: #ffffff;
  border-color: #d1d5db;
  color: #111827;
  box-shadow: 0 4px 10px rgba(15, 23, 42, 0.12);
}
html[data-theme="light"] .fm-bookmarks-select:hover,
html[data-theme="light"] .fm-target-select:hover{
  border-color: #9ca3af;
  box-shadow: 0 8px 20px rgba(15, 23, 42, 0.18);
}
html[data-theme="light"] .fm-bookmarks-select:active,
html[data-theme="light"] .fm-target-select:active{
  background: rgba(37,99,235,0.12);
  border-color: rgba(37,99,235,0.45);
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.18);
}

/* Make native <select> dropdowns readable in dark theme (options are otherwise too pale on white popups) */
html:not([data-theme="light"]) .fm-bookmarks-select,
html:not([data-theme="light"]) .fm-target-select{
  color-scheme: dark;
}
html:not([data-theme="light"]) .fm-bookmarks-select option,
html:not([data-theme="light"]) .fm-target-select option,
html:not([data-theme="light"]) .fm-bookmarks-select optgroup,
html:not([data-theme="light"]) .fm-target-select optgroup{
  background-color: rgba(2,6,23,0.98);
  color: rgba(226,232,240,0.98);
}

.fm-path-input{
  flex: 1;
  min-width: 80px;
  padding: 8px 10px;
  border-radius: 10px;
  border: 1px solid rgba(51,65,85,0.9);
  background: rgba(255,255,255,0.02);
  color: inherit;
}


.fm-filter-wrap{
  display: flex;
  align-items: center;
  gap: 6px;
  /* Allow the filter block to shrink instead of being clipped */
  flex: 0 1 240px;
  min-width: 120px;
}

.fm-filter-input{
  flex: 1 1 auto;
  width: auto;
  min-width: 0;
  padding: 8px 10px;
  border-radius: 10px;
  border: 1px solid rgba(51,65,85,0.9);
  background: rgba(255,255,255,0.02);
  color: inherit;
}

.fm-filter-clear-btn{
  padding: 8px 10px;
  border-radius: 10px;
  min-width: 36px;
}

@media (max-width: 900px){
  .fm-filter-wrap{ flex-basis: 200px; min-width: 110px; }
}

.fm-list{
  flex: 1;
  min-height: 0;
  overflow: auto;
  outline: none;
  overscroll-behavior: contain;
}
.fm-list.is-loading{ opacity: 0.65; pointer-events: none; }

.fm-list.is-drop-target{
  outline: 2px dashed rgba(56,189,248,0.55);
  outline-offset: -2px;
}

.fm-row.is-drop-target{
  background: rgba(56,189,248,0.10);
  outline: 1px dashed rgba(56,189,248,0.65);
}

.fm-row[draggable="true"]{ cursor: grab; }
.fm-row[draggable="true"]:active{ cursor: grabbing; }

.fm-row{
  display:grid;
  grid-template-columns: 28px minmax(160px, 1fr) minmax(64px, 92px) minmax(72px, 100px) minmax(120px, 150px);
  gap: 10px;
  align-items:center;
  padding: 6px 10px;
  user-select:none;
}

/* Trash view: add an extra column "–û—Ç–∫—É–¥–∞ —É–¥–∞–ª–µ–Ω–æ" */
.fm-panel.is-trash .fm-row{
  grid-template-columns: 28px minmax(160px, 1fr) minmax(220px, 1.2fr) minmax(64px, 92px) minmax(72px, 100px) minmax(120px, 150px);
}
.fm-cell.fm-from{
  opacity: 0.85;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}
.fm-row-header{
  position: sticky;
  top: 0;
  z-index: 1;
  font-size: 12px;
  letter-spacing: 0.02em;
  text-transform: none;
  opacity: 0.85;
  background: rgba(2,6,23,0.55);
  border-bottom: 1px solid rgba(51,65,85,0.6);
}
.fm-row-header .fm-sort-cell{
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
}
.fm-row-header .fm-sort-cell:hover{ text-decoration: underline; }
.fm-sort-ind{ font-size: 11px; opacity: 0.75; }
.fm-row-header .fm-sort-cell.is-sort-active .fm-sort-ind{ opacity: 0.95; }
.fm-row:not(.fm-row-header){
  cursor: default;
}
.fm-row:not(.fm-row-header):hover{
  background: rgba(255,255,255,0.04);
}
.fm-row.is-selected{
  background: rgba(37,99,235,0.18);
}
.fm-row.is-focused{
  outline: 1px solid rgba(56,189,248,0.55);
}

.fm-cell{ overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.fm-cell.fm-check{ display:flex; align-items:center; justify-content:center; }
.fm-check-input{ width:16px; height:16px; margin:0; cursor:pointer; }
.fm-cell.fm-name{ display:flex; gap:8px; align-items:center; }
.fm-ico{ width: 18px; text-align:center; opacity: 0.95; }
.fm-name-text{ overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

.fm-hints{
  display:flex;
  gap: 14px;
  align-items: flex-start;
  flex-wrap: wrap;
  margin-top: 10px;
  font-size: 12px;
}

/* Properties panel */
.fm-props{
  margin-top: 10px;
  padding: 10px 12px;
  border: 1px solid rgba(51,65,85,0.85);
  border-radius: 14px;
  background: rgba(2,6,23,0.18);
}
.fm-props-head{ display:flex; align-items: baseline; justify-content: space-between; gap: 12px; }
.fm-props-title{ font-weight: 600; font-size: 13px; }
.fm-props-meta{ font-size: 12px; opacity: 0.75; }
.fm-props-body{ margin-top: 8px; min-height: 34px; }
.fm-props-grid{
  display: grid;
  grid-template-columns: 160px 1fr;
  gap: 6px 12px;
  align-items: start;
  font-size: 12px;
}
.fm-props-k{ opacity: 0.75; }
.fm-props-v{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  white-space: pre-wrap;
  overflow-wrap: anywhere;
}
.fm-props-empty{ font-size: 12px; opacity: 0.8; padding: 6px 0; }

@media (max-width: 760px){
  .fm-props-grid{ grid-template-columns: 1fr; }
  .fm-props-v{ font-family: inherit; }
}

.fm-hints-text{
  display:flex;
  gap: 14px;
  flex-wrap: wrap;
  opacity: 0.85;
}


/* Bottom bar: help (left) + actions (right) */
.fm-footer{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  margin-top: 10px;
}
.fm-footer-actions{
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 8px;
  flex-wrap: wrap;
}

.fm-help-btn{
  padding: 6px 10px;
  font-size: 12px;
  line-height: 1.1;
}

.fm-help-body{
  font-size: 0.95rem;
  line-height: 1.35;
}
.fm-help-body h3{
  margin: 14px 0 6px 0;
  font-size: 1rem;
}
.fm-help-body ul{
  margin: 6px 0 0 18px;
}
.fm-help-body li{
  margin: 4px 0;
}

.fm-dropop-list{
  max-height: 260px;
  overflow: auto;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid rgba(51,65,85,0.85);
  background: rgba(255,255,255,0.03);
  box-sizing: border-box;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 0.9rem;
  white-space: pre-wrap;
}

/* Context menu (–ü–ö–ú) */
.fm-context-menu{
  position: fixed;
  z-index: 60;
  min-width: 220px;
  padding: 6px;
  border-radius: 12px;
  border: 1px solid rgba(51,65,85,0.85);
  background: rgba(2,6,23,0.92);
  box-shadow: 0 10px 30px rgba(0,0,0,0.35);
  backdrop-filter: blur(6px);
}
.fm-context-menu.hidden{ display:none; }

.fm-context-item{
  width: 100%;
  display: flex;
  justify-content: space-between;
  gap: 12px;
  align-items: center;
  padding: 8px 10px;
  border-radius: 10px;
  border: 1px solid transparent;
  background: transparent;
  color: inherit;
  cursor: pointer;
  text-align: left;
}
.fm-context-item:hover{
  background: rgba(255,255,255,0.06);
  border-color: rgba(51,65,85,0.55);
}
.fm-context-item:active{
  background: rgba(255,255,255,0.10);
}
.fm-context-kbd{
  font-size: 12px;
  opacity: 0.75;
}
.fm-context-sep{
  height: 1px;
  margin: 6px 6px;
  background: rgba(51,65,85,0.60);
}

html[data-theme="light"] .fm-context-menu{
  background: rgba(255,255,255,0.96);
  border-color: rgba(15,23,42,0.18);
  box-shadow: 0 10px 30px rgba(2,6,23,0.12);
}
html[data-theme="light"] .fm-context-item:hover{
  background: rgba(15,23,42,0.06);
  border-color: rgba(15,23,42,0.12);
}
html[data-theme="light"] .fm-context-sep{
  background: rgba(15,23,42,0.12);
}

/* Connect form */
.fm-form-grid{
  display:grid;
  grid-template-columns: 160px 1fr;
  gap: 10px 12px;
  align-items:center;
}

/*
  FM connect modal: prevent profile select / flex rows from forcing horizontal overflow.
  Modal-body hides overflow-x, and without min-width:0 the grid could overflow and
  visually "cut" the left part of labels (only the tail of the label remained visible).
*/
#fm-connect-modal .fm-form-grid{
  /* Slightly wider labels column for "SFTP host key" and friends */
  grid-template-columns: 180px 1fr;
}
#fm-connect-modal .fm-form-grid > *{
  min-width: 0;
}
#fm-connect-modal .fm-form-grid > label{
  opacity: 0.9;
  font-size: 0.95rem;
  line-height: 1.25;
  white-space: normal;
  overflow: visible;
  word-break: break-word;
}
/* Flex wrappers inside the grid (profile row, hostkey policy row, fingerprint row) */
#fm-connect-modal .fm-form-grid > div{
  min-width: 0;
}
#fm-connect-modal .fm-form-grid .terminal-input{
  min-width: 0;
}

/* Keep the 1-column layout on small screens (override the more specific connect-modal rule above) */
@media (max-width: 920px){
  #fm-connect-modal .fm-form-grid{ grid-template-columns: 1fr; }
}


/* chmod/chown helpers */
.fm-mono{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}
.fm-perms-grid{
  display: grid;
  grid-template-columns: 80px repeat(3, 1fr);
  gap: 8px 12px;
  align-items: center;
}
.fm-perms-head{
  font-weight: 600;
  opacity: 0.9;
}
.fm-perms-rowlabel{
  opacity: 0.9;
}
.fm-perms-cell{
  display: flex;
  gap: 8px;
  align-items: center;
  user-select: none;
}
.fm-perms-cell input{
  width: 16px;
  height: 16px;
  margin: 0;
}

/* Conflicts */
.fm-conflicts-table{
  display:grid;
  gap: 6px;
}
.fm-conflicts-row{
  display:grid;
  grid-template-columns: 1fr 1fr 140px;
  gap: 10px;
  padding: 8px 10px;
  border: 1px solid rgba(51,65,85,0.65);
  border-radius: 12px;
  background: rgba(255,255,255,0.02);
}
.fm-conflicts-head{
  font-size: 12px;
  opacity: 0.85;
  background: rgba(2,6,23,0.35);
}
.fm-conflicts-footer{ margin-top: 10px; }

/* Progress */
.fm-progress-line{ font-weight: 600; margin-bottom: 10px; }
.fm-progress-bar{ height: 10px; border-radius: 999px; background: rgba(51,65,85,0.55); overflow:hidden; }
.fm-progress-bar-inner{ height: 100%; width: 0%; background: rgba(37,99,235,0.55); }
.fm-progress-meta{ margin-top: 8px; font-size: 12px; opacity: 0.85; }
.fm-mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
.fm-progress-extra{ margin-top: 8px; display:flex; justify-content:space-between; gap: 10px; align-items:center; flex-wrap:wrap; font-size: 12px; }
.fm-progress-extra-right{ opacity: 0.85; }
.fm-progress-details{ margin-top: 10px; max-height: 260px; overflow:auto; background: rgba(2,6,23,0.35); border: 1px solid rgba(51,65,85,0.55); border-radius: 12px; padding: 10px; }

/* Ops list */
.fm-ops-table{ display:grid; gap: 6px; }
.fm-ops-row{ display:grid; grid-template-columns: 110px 80px 90px 120px 1fr 170px; gap: 10px; padding: 8px 10px; border: 1px solid rgba(51,65,85,0.65); border-radius: 12px; background: rgba(255,255,255,0.02); align-items:center; }
.fm-ops-head{ font-size: 12px; opacity: 0.85; background: rgba(2,6,23,0.35); }

@media (max-width: 920px){
  .fm-card{ resize: none; }
  .fm-resize-handle-left{ display:none; }
  .fm-two{ grid-template-columns: 1fr; }
  .fm-row{ grid-template-columns: 28px minmax(140px, 1fr) minmax(56px, 84px) minmax(64px, 92px) minmax(108px, 140px); }
  .fm-panel.is-trash .fm-row{ grid-template-columns: 28px minmax(140px, 1fr) minmax(180px, 1.2fr) minmax(56px, 84px) minmax(64px, 92px) minmax(108px, 140px); }
  .fm-form-grid{ grid-template-columns: 1fr; }
  .fm-conflicts-row{ grid-template-columns: 1fr; }
  .fm-ops-row{ grid-template-columns: 1fr; }
}

html[data-theme="light"] .fm-panel{
  background: rgba(15,23,42,0.04);
  border-color: rgba(15,23,42,0.18);
}
html[data-theme="light"] .fm-panel-bar,
html[data-theme="light"] .fm-row-header{
  background: rgba(15,23,42,0.06);
  border-color: rgba(15,23,42,0.12);
}
html[data-theme="light"] .fm-row:not(.fm-row-header):hover{
  background: rgba(15,23,42,0.05);
}
html[data-theme="light"] .fm-row.is-selected{
  background: rgba(37,99,235,0.12);
}
html[data-theme="light"] .fm-progress-details{
  background: rgba(15,23,42,0.04);
  border-color: rgba(15,23,42,0.12);
}
