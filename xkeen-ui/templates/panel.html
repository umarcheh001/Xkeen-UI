<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Xkeen UI ‚Äî Routing / Inbounds / Outbounds</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="csrf-token" content="{{ csrf_token }}">

  
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon-32x32.png') }}">
  <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='favicon-16x16.png') }}">
  <link rel="apple-touch-icon" href="{{ url_for('static', filename='apple-touch-icon.png') }}">
  <link rel="manifest" href="{{ url_for('static', filename='site.webmanifest') }}">
  <meta name="theme-color" content="#0f172a">
  <!-- Apply typography prefs ASAP (stored in localStorage) -->
  <script src="{{ url_for('static', filename='js/ui/typography.js', v='20251230c') }}"></script>
  <!-- Apply layout prefs ASAP (stored in localStorage) -->
  <script src="{{ url_for('static', filename='js/ui/layout.js', v='20260101c') }}"></script>
  <script src="{{ url_for('static', filename='js/ui/xk_brand.js', v='20260104a') }}"></script>
  <!-- Env-driven visibility filters (section whitelist) -->
  <script>
    window.XKeen = window.XKeen || {};
    window.XKeen.env = window.XKeen.env || {};
    window.XKeen.env.panelSectionsWhitelist = {{ panel_sections_whitelist|tojson }};
    window.XKeen.env.devtoolsSectionsWhitelist = {{ devtools_sections_whitelist|tojson }};
  </script>
  <script src="{{ url_for('static', filename='js/ui/sections.js', v='20260101c') }}"></script>
<!-- CodeMirror & JSON lint -->

  <link rel="stylesheet" href="{{ url_for('static', filename='codemirror/codemirror.min.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='codemirror/theme/material-darker.min.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='codemirror/addon/lint/lint.min.css') }}">

  <script src="{{ url_for('static', filename='codemirror/codemirror.min.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/display/indent-guides.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/selection/active-line.min.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/edit/matchbrackets.min.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/mode/javascript/javascript.min.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/mode/shell/shell.min.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/mode/yaml/yaml.min.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/lint/lint.min.js') }}"></script>

  <!-- NOTE: extra modes / JSON linter are lazy-loaded (see js/ui/codemirror_loader.js) -->
  <!-- CodeMirror addons: folding, search, dialog, autoclose -->
  <link rel="stylesheet" href="{{ url_for('static', filename='codemirror/addon/fold/foldgutter.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='codemirror/addon/dialog/dialog.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='codemirror/addon/display/fullscreen.css') }}">

  <script src="{{ url_for('static', filename='codemirror/addon/fold/foldcode.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/fold/brace-fold.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/fold/indent-fold.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/fold/foldgutter.js') }}"></script>

  <script src="{{ url_for('static', filename='codemirror/addon/search/searchcursor.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/search/search.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/search/match-highlighter.js') }}"></script>

  <script src="{{ url_for('static', filename='codemirror/addon/dialog/dialog.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/edit/closebrackets.js') }}"></script>

  <!-- Quality-of-life addons: fullscreen, comments, trailing spaces, rulers -->
  <script src="{{ url_for('static', filename='codemirror/addon/display/fullscreen.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/comment/comment.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/comment/continuecomment.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/fold/comment-fold.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/mode/overlay.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/edit/trailingspace.js') }}"></script>
  <script src="{{ url_for('static', filename='codemirror/addon/display/rulers.js') }}"></script>

<link rel="stylesheet" href="{{ url_for('static', filename='styles.css', v='20260214a') }}">
  <link rel="stylesheet" id="xk-custom-theme-link" href="{{ url_for('custom_theme_css', v=custom_theme_v) }}">
  <link rel="stylesheet" id="xk-terminal-theme-link" href="{{ url_for('terminal_theme_css', v=terminal_theme_v) }}">
  <link rel="stylesheet" id="xk-codemirror-theme-link" href="{{ url_for('codemirror_theme_css', v=codemirror_theme_v) }}">
  {# Global Custom CSS (DevTools) ‚Äî last in order so it can override everything. #}
  {% if custom_css_enabled and not safe_mode %}
  <link rel="stylesheet" id="xk-custom-css-link" href="{{ url_for('custom_css', v=custom_css_v) }}">
  {% endif %}
<!-- XTerm.js –¥–ª—è –≤–µ–±-—Ç–µ—Ä–º–∏–Ω–∞–ª–∞ XKeen (–ª–æ–∫–∞–ª—å–Ω–æ –∏–∑ static/xterm) -->
  <link rel="stylesheet" href="{{ url_for('static', filename='xterm/xterm.css') }}">
  <script src="{{ url_for('static', filename='xterm/xterm.js') }}"></script>
  <script src="{{ url_for('static', filename='xterm/xterm-addon-fit.js') }}"></script>
  <!-- XTerm.js official addons (–ª–æ–∫–∞–ª—å–Ω–æ) -->
  <script src="{{ url_for('static', filename='xterm/xterm-addon-search.js') }}"></script>
  <script src="{{ url_for('static', filename='xterm/xterm-addon-web-links.js') }}"></script>
  <!-- Extra XTerm.js addons (–ª–æ–∫–∞–ª—å–Ω–æ) -->
  <script src="{{ url_for('static', filename='xterm/xterm-addon-webgl.js') }}"></script>
  <script src="{{ url_for('static', filename='xterm/xterm-addon-unicode11.js') }}"></script>
  <script src="{{ url_for('static', filename='xterm/xterm-addon-serialize.js') }}"></script>
  <script src="{{ url_for('static', filename='xterm/xterm-addon-clipboard.js') }}"></script>
  <!-- Ligatures for XTerm.js (font ligatures + safe fallback ligatures) -->
  <script src="{{ url_for('static', filename='xterm/xterm-addon-ligatures.js') }}"></script>
</head>
<body>
  <div id="global-xkeen-spinner">
    <div class="global-spinner-box">
      <div class="global-spinner-icon"></div>
      <div class="global-spinner-text" id="global-xkeen-spinner-text">
        –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º xkeen‚Ä¶
      </div>
    </div>
  </div>

  <!-- Wider container (match DevTools page width) -->
  <div class="container container-wide">
    <header>
      <div class="header-main">
        <div class="header-title-group">
          <img id="xk-brand-logo" class="xk-brand-logo hidden" alt="Logo" />
          <h1 id="xk-brand-title" data-xk-brand-title>Xkeen UI</h1>
          <span
            id="xkeen-service-lamp"
            class="service-status-lamp"
            data-state="pending"
            title="–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞..."
          ></span>
          <span id="xkeen-service-text" class="service-status-text">
            –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞...
          </span>
        </div>

        <div class="header-center">
          <button
            id="xkeen-core-text"
            type="button"
            class="service-core-text"
          ></button>

          <!-- Notice: global Xray logging is enabled (loglevel!=none) -->
          <span id="xray-logs-badge" class="xray-logs-badge" data-state="off" title="–õ–æ–≥–∏ Xray –≤—ã–∫–ª—é—á–µ–Ω—ã">
            –õ–æ–≥–∏ Xray
          </span>
        </div>

        <div class="header-right">
          <div class="header-actions">
            <button
              type="button"
              id="theme-toggle-btn"
              class="theme-toggle-btn theme-toggle-header"
              aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É"
            ></button>

            <a
              href="{{ url_for('devtools_page') }}"
              class="service-core-text"
              title="DevTools"
            >DevTools</a>

            <a
              href="{{ url_for('logout') }}"
              class="service-core-text"
              title="–í—ã–π—Ç–∏ –∏–∑ –ø–∞–Ω–µ–ª–∏"
            >–í—ã–π—Ç–∏</a>
          </div>
        </div>
      </div>

      <p>–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, —Ä–µ–∂–∏–º inbounds –∏ VLESS outbounds –≤ –æ–¥–Ω–æ–π –ø–∞–Ω–µ–ª–∏.</p>

<div class="top-tabs header-tabs">
        <button class="top-tab-btn active" data-view="routing" data-xk-section="routing">
          –†–æ—É—Ç–∏–Ω–≥ Xray
        </button>
        <button class="top-tab-btn" data-view="mihomo" data-xk-section="mihomo">
          –†–æ—É—Ç–∏–Ω–≥ Mihomo
        </button>
        <button class="top-tab-btn" data-view="xkeen" data-xk-section="xkeen">
          –ü–æ—Ä—Ç—ã –∏ –ò—Å–∫–ª—é—á–µ–Ω–∏—è
        </button>
        <button class="top-tab-btn" data-view="xray-logs" data-xk-section="xray-logs">
          Live –ª–æ–≥–∏ Xray
        </button>
        <button class="top-tab-btn" data-view="commands" data-xk-section="commands">
          –ö–æ–º–∞–Ω–¥—ã
        </button>
        <button class="top-tab-btn" data-view="files" data-xk-section="files" id="top-tab-files" {% if is_mips %}style="display:none;"{% endif %}>
          –§–∞–π–ª—ã
        </button>
        <button class="top-tab-btn" type="button" data-xk-section="mihomo-generator" id="top-tab-mihomo-generator" onclick="window.location.href='/mihomo_generator'">
          Mihomo –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä
        </button>

        <button class="top-tab-btn" type="button" data-xk-section="donate" id="top-tab-donate">
          üí∞ –î–æ–Ω–∞—Ç
        </button>
      </div>
    
<div class="xkeen-ctrl-row">
  <div class="xkeen-ctrl-group">
    <button id="xkeen-start-btn" class="xkeen-ctrl-btn" data-tooltip="–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å xkeen.">Start xkeen</button>
    <button id="xkeen-stop-btn" class="xkeen-ctrl-btn" data-tooltip="–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å xkeen.">Stop xkeen</button>
    <button id="xkeen-restart-btn" class="xkeen-ctrl-btn" data-tooltip="–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å xkeen.">Restart xkeen</button>
  </div>
  <div class="global-toggle-right">
    <label class="global-autorestart-toggle">
      <input type="checkbox" id="global-autorestart-xkeen" checked>
      <span>–ê–≤—Ç–æ‚Äë–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ xkeen</span>
    </label>
    <div id="last-load" class="last-load-badge"></div>
  </div>
</div>

</header>

    <div id="view-routing" class="view-section" data-xk-section="routing">
<!-- Routing editor + Mihomo config -->
    <div class="layout-2col routing-layout">

            <div class="layout-side routing-side">
        <div class="routing-side-grid">
    <section class="card routing-dat-card">
              <div class="commands-header" id="routing-dat-header">
                <h2>DAT-—Ñ–∞–π–ª—ã GeoIP / GeoSite</h2>
                <span id="routing-dat-arrow">‚ñ∫</span>
              </div>

              <div id="routing-dat-body" style="display:none;">
                <p class="xk-card-desc">–•—Ä–∞–Ω–∏–ª–∏—â–∞ GeoIP/GeoSite –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª–∞–º–∏ <code>geoip:</code> –∏ <code>geosite:</code>. –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏ –∑–∞–º–µ–Ω–∏—Ç—å DAT-—Ñ–∞–π–ª—ã.</p>

                <div class="routing-dat-toolbar">
                  <div class="routing-dat-toolbar-left">
                    <button id="routing-dat-refresh-btn" class="btn-secondary btn-icon" type="button" aria-label="–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã" data-tooltip="–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ DAT-—Ñ–∞–π–ª–æ–≤ –∏ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞–∑–º–µ—Ä–µ/–¥–∞—Ç–µ.">‚ü≥</button>
                    <button id="routing-dat-geodat-install-btn" class="btn-secondary btn-compact" type="button" data-tooltip="–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å xk-geodat (–≤–∫–ª—é—á–∏—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ DAT –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–æ–≤ –≤ –ø—Ä–∞–≤–∏–ª–∞).">xk-geodat</button>
                    <button id="routing-dat-geodat-install-file-btn" class="btn-secondary btn-icon" type="button" aria-label="–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å xk-geodat –∏–∑ —Ñ–∞–π–ª–∞" data-tooltip="–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å xk-geodat –∏–∑ —Ñ–∞–π–ª–∞ (–µ—Å–ª–∏ –≤—ã —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç–µ –¥–æ —Ä–µ–ª–∏–∑–∞ –∏–ª–∏ —Å—Ç–∞–≤–∏—Ç–µ —Å–≤–æ–π –±–∏–Ω–∞—Ä–Ω–∏–∫).">‚¨ÜÔ∏é</button>
                    <input id="routing-dat-geodat-install-file" type="file" style="display:none" />
                  </div>
                  <div id="routing-dat-status" class="status"></div>
                </div>

                <div class="routing-dat-grid">
                  <div class="routing-dat-item" data-kind="geosite">
                    <div class="routing-dat-head">
                      <div class="routing-dat-title">
                        <span class="routing-dat-name">GeoSite</span>
                        <span class="routing-dat-file">geosite.dat</span>
                      </div>
                      <div class="routing-dat-meta" id="routing-dat-geosite-meta">‚Äî</div>
                    </div>

                    <label class="routing-dat-field">
                      <span>–ü–∞–ø–∫–∞</span>
                      <input id="routing-dat-geosite-dir" class="routing-dat-input" type="text" placeholder="/opt/etc/xray/dat">
                    </label>

                    <label class="routing-dat-field">
                      <span>–ò–º—è —Ñ–∞–π–ª–∞</span>
                      <div class="routing-dat-combo" data-kind="geosite">
                        <input id="routing-dat-geosite-name" class="routing-dat-input" type="text" list="routing-dat-geosite-name-list" placeholder="geosite.dat">
                        <button id="routing-dat-geosite-browse" class="btn-secondary btn-icon routing-dat-combo-btn" type="button" aria-label="–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ DAT" data-tooltip="–ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ .dat –≤ –ø–∞–ø–∫–µ.">‚ñº</button>
                        <div id="routing-dat-geosite-found" class="routing-dat-found" data-tooltip="–ù–∞–π–¥–µ–Ω–Ω—ã–µ DAT –≤ –ø–∞–ø–∫–µ. –ö–ª–∏–∫ –ø–æ —Å—Ç—Ä–æ–∫–µ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç –∏–º—è —Ñ–∞–π–ª–∞.">‚Äî</div>
                      </div>
                      <datalist id="routing-dat-geosite-name-list"></datalist>
                    </label>

                    <label class="routing-dat-field">
                      <span>URL –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</span>
                      <input id="routing-dat-geosite-url" class="routing-dat-input" type="url" placeholder="https://.../geosite.dat">
                    </label>

                    <input id="routing-dat-geosite-file" type="file" accept=".dat" style="display:none">

                    <div class="routing-dat-actions">
                      <button id="routing-dat-geosite-upload-btn" class="btn-secondary" type="button" data-tooltip="–ó–∞–≥—Ä—É–∑–∏—Ç—å DAT-—Ñ–∞–π–ª —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø—É—Ç–∏.">‚¨ÜÔ∏è –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                      <button id="routing-dat-geosite-update-btn" class="btn-secondary" type="button" data-tooltip="–°–∫–∞—á–∞—Ç—å DAT –ø–æ URL –∏ –∑–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ñ–∞–π–ª (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º).">üîó –û–±–Ω–æ–≤–∏—Ç—å</button>
                      <button id="routing-dat-geosite-download-btn" class="btn-secondary" type="button" data-tooltip="–°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–∏–π –ª–æ–∫–∞–ª—å–Ω—ã–π DAT-—Ñ–∞–π–ª.">‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å</button>
                    </div>

                    <div class="routing-dat-actions routing-dat-actions-muted">
                      <button id="routing-dat-geosite-content-btn" class="btn-secondary" type="button" data-tooltip="–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–≥–æ–≤/—Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ GeoSite (–ø–æ–∏—Å–∫ + –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ geosite:TAG).">‚óè –°–æ–¥–µ—Ä–∂–∏–º–æ–µ</button>
                      <button id="routing-dat-geosite-inrouting-btn" class="btn-secondary" type="button" data-tooltip="–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥ GeoSite –≤ –ø—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ (—Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ).">‚ûï –í –ø—Ä–∞–≤–∏–ª–æ</button>
                    </div>
                  </div>

                  <div class="routing-dat-item" data-kind="geoip">
                    <div class="routing-dat-head">
                      <div class="routing-dat-title">
                        <span class="routing-dat-name">GeoIP</span>
                        <span class="routing-dat-file">geoip.dat</span>
                      </div>
                      <div class="routing-dat-meta" id="routing-dat-geoip-meta">‚Äî</div>
                    </div>

                    <label class="routing-dat-field">
                      <span>–ü–∞–ø–∫–∞</span>
                      <input id="routing-dat-geoip-dir" class="routing-dat-input" type="text" placeholder="/opt/etc/xray/dat">
                    </label>

                    <label class="routing-dat-field">
                      <span>–ò–º—è —Ñ–∞–π–ª–∞</span>
                      <div class="routing-dat-combo" data-kind="geoip">
                        <input id="routing-dat-geoip-name" class="routing-dat-input" type="text" list="routing-dat-geoip-name-list" placeholder="geoip.dat">
                        <button id="routing-dat-geoip-browse" class="btn-secondary btn-icon routing-dat-combo-btn" type="button" aria-label="–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ DAT" data-tooltip="–ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ .dat –≤ –ø–∞–ø–∫–µ.">‚ñº</button>
                        <div id="routing-dat-geoip-found" class="routing-dat-found" data-tooltip="–ù–∞–π–¥–µ–Ω–Ω—ã–µ DAT –≤ –ø–∞–ø–∫–µ. –ö–ª–∏–∫ –ø–æ —Å—Ç—Ä–æ–∫–µ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç –∏–º—è —Ñ–∞–π–ª–∞.">‚Äî</div>
                      </div>
                      <datalist id="routing-dat-geoip-name-list"></datalist>
                    </label>

                    <label class="routing-dat-field">
                      <span>URL –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</span>
                      <input id="routing-dat-geoip-url" class="routing-dat-input" type="url" placeholder="https://.../geoip.dat">
                    </label>

                    <input id="routing-dat-geoip-file" type="file" accept=".dat" style="display:none">

                    <div class="routing-dat-actions">
                      <button id="routing-dat-geoip-upload-btn" class="btn-secondary" type="button" data-tooltip="–ó–∞–≥—Ä—É–∑–∏—Ç—å DAT-—Ñ–∞–π–ª —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø—É—Ç–∏.">‚¨ÜÔ∏è –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                      <button id="routing-dat-geoip-update-btn" class="btn-secondary" type="button" data-tooltip="–°–∫–∞—á–∞—Ç—å DAT –ø–æ URL –∏ –∑–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ñ–∞–π–ª (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º).">üîó –û–±–Ω–æ–≤–∏—Ç—å</button>
                      <button id="routing-dat-geoip-download-btn" class="btn-secondary" type="button" data-tooltip="–°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–∏–π –ª–æ–∫–∞–ª—å–Ω—ã–π DAT-—Ñ–∞–π–ª.">‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å</button>
                    </div>

                    <div class="routing-dat-actions routing-dat-actions-muted">
                      <button id="routing-dat-geoip-content-btn" class="btn-secondary" type="button" data-tooltip="–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–≥–æ–≤/—Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ GeoIP (–ø–æ–∏—Å–∫ + –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ geoip:TAG).">‚óè –°–æ–¥–µ—Ä–∂–∏–º–æ–µ</button>
                      <button id="routing-dat-geoip-inrouting-btn" class="btn-secondary" type="button" data-tooltip="–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥ GeoIP –≤ –ø—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ (—Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ).">‚ûï –í –ø—Ä–∞–≤–∏–ª–æ</button>
                    </div>
                  </div>
                </div>
              </div>
            </section>

    <!-- Inbounds mode -->
    <section class="card">
      <div class="commands-header" id="inbounds-header">
        <h2>–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã inbounds ({{ inbounds_name|e }})</h2>
        <span id="inbounds-arrow">‚ñº</span>
      </div>

      <div id="inbounds-body" style="display:none;">

      <div class="xk-fragment-row">
        <label class="xk-fragment-select">
          <span class="hint-label">–§–∞–π–ª</span>
          <select id="inbounds-fragment-select" class="xray-log-select" data-current="{{ inbounds_name|e }}"></select>
        </label>
        <button id="inbounds-fragment-refresh-btn" type="button" class="btn-icon btn-secondary" data-tooltip="–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ inbounds –∏–∑ /opt/etc/xray/configs/">‚Üª</button>
      </div>
      <p class="xk-card-desc">–ê–∫—Ç–∏–≤–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç: <code id="inbounds-file-code">{{ inbounds_file }}</code></p>

      <div class="inbounds-modes">
        <label class="mode-item">
          <input type="radio" name="inbounds_mode" value="mixed">
          <div>
            <strong>Mixed</strong><br>
            <small class="xk-card-desc">UDP —á–µ—Ä–µ–∑ TProxy, TCP —á–µ—Ä–µ–∑ Redirect. –ë–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–µ–∂–∏–º).</small>
          </div>
        </label>

        <label class="mode-item">
          <input type="radio" name="inbounds_mode" value="tproxy">
          <div>
            <strong>TProxy</strong><br>
            <small class="xk-card-desc">TCP+UDP —á–µ—Ä–µ–∑ TProxy. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å, –Ω–æ —Å–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π –∏ —Ä–µ—Å—É—Ä—Å–æ—ë–º–∫–∏–π.</small>
          </div>
        </label>

        <label class="mode-item">
          <input type="radio" name="inbounds_mode" value="redirect">
          <div>
            <strong>Redirect</strong><br>
            <small class="xk-card-desc">–¢–æ–ª—å–∫–æ TCP —á–µ—Ä–µ–∑ Redirect. –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π, –Ω–æ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∏–≥—Ä –∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞.</small>
          </div>
        </label>
      </div>

      <label class="toggle">
        <input type="checkbox" id="inbounds-autorestart" checked>
        –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å xkeen –ø–æ—Å–ª–µ —Å–º–µ–Ω—ã —Ä–µ–∂–∏–º–∞
      </label>

      <div class="actions xk-actions-grid-2">
        <button id="inbounds-open-editor-btn" data-tooltip="–û—Ç–∫—Ä—ã—Ç—å {{ inbounds_name|e }} –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ JSON.">üìù –†–µ–¥–∞–∫—Ç–æ—Ä</button>
        <button id="inbounds-save-btn" data-tooltip="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å {{ inbounds_name|e }}.">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button id="inbounds-backup-btn" data-tooltip="–°–¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø {{ inbounds_name|e }}.">üì¶ Backup</button>
        <button id="inbounds-restore-auto-btn" data-tooltip="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å inbounds –∏–∑ –∞–≤—Ç–æ–±—ç–∫–∞–ø–∞.">‚è™ Restore</button>
      </div>

      <div id="inbounds-status" class="status"></div>
      </div>
    </section>

    <!-- Outbounds VLESS editor -->
    <section class="card">
      <div class="commands-header" id="outbounds-header">
        <h2>–ü—Ä–æ–∫—Å–∏ ({{ outbounds_name|e }})</h2>
        <span id="outbounds-arrow">‚ñº</span>
      </div>

      <div id="outbounds-body" style="display:none;">

      <div class="xk-fragment-row">
        <label class="xk-fragment-select">
          <span class="hint-label">–§–∞–π–ª</span>
          <select id="outbounds-fragment-select" class="xray-log-select" data-current="{{ outbounds_name|e }}"></select>
        </label>
        <button id="outbounds-fragment-refresh-btn" type="button" class="btn-icon btn-secondary" data-tooltip="–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ outbounds –∏–∑ /opt/etc/xray/configs/">‚Üª</button>
      </div>
      <p class="xk-card-desc">–ê–∫—Ç–∏–≤–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç: <code id="outbounds-file-code">{{ outbounds_file }}</code></p>
      <p class="xk-card-desc">–£–∫–∞–∂–∏ —Å—Å—ã–ª–∫—É –ø—Ä–æ–∫—Å–∏ (vless / trojan / vmess / ss / hy2), –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç —Å–æ–±—Ä–∞–Ω –∫–æ–Ω—Ñ–∏–≥ <code>{{ outbounds_name|e }}</code>.</p>

      <div class="outbounds-hints">
        <label>
          <span class="hint-label">–ü—Ä–æ—Ç–æ–∫–æ–ª</span>
          <select id="outbounds-proto" class="xray-log-select">
            <option value="auto" selected>–ê–≤—Ç–æ</option>
            <option value="vless">VLESS</option>
            <option value="trojan">Trojan</option>
            <option value="vmess">VMess</option>
            <option value="ss">Shadowsocks</option>
            <option value="hy2">Hysteria2 (HY2)</option>
          </select>
        </label>

        <label>
          <span class="hint-label">–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</span>
          <select id="outbounds-type" class="xray-log-select">
            <option value="auto" selected>–ê–≤—Ç–æ</option>
            <option value="tcp">TCP</option>
            <option value="ws">WebSocket</option>
            <option value="grpc">gRPC</option>
            <option value="httpupgrade">HTTP Upgrade</option>
            <option value="kcp">mKCP</option>
            <option value="raw">RAW</option>
            <option value="xhttp">XHTTP</option>
          </select>
        </label>

        <label>
          <span class="hint-label">Security</span>
          <select id="outbounds-security" class="xray-log-select">
            <option value="auto" selected>–ê–≤—Ç–æ</option>
            <option value="none">None</option>
            <option value="tls">TLS</option>
            <option value="reality">Reality</option>
          </select>
        </label>
      </div>

      <input id="outbounds-url" type="text" placeholder="vless://... / trojan://... / vmess://... / ss://... / hy2://...">

      <!-- Parsed preview + validation (client-side) -->
      <div id="outbounds-parse-box" class="outbounds-parse-box" style="display:none;">
        <div class="outbounds-parse-badges">
          <span id="outbounds-badge-proto" class="outbounds-badge">‚Äî</span>
          <span id="outbounds-badge-type" class="outbounds-badge">‚Äî</span>
          <span id="outbounds-badge-sec" class="outbounds-badge">‚Äî</span>
          <span id="outbounds-badge-state" class="outbounds-badge outbounds-badge-ok" style="display:none;">OK</span>
          <span id="outbounds-badge-state-bad" class="outbounds-badge outbounds-badge-bad" style="display:none;">–û—à–∏–±–∫–∞</span>
        </div>

        <div id="outbounds-parse-error" class="outbounds-parse-msg outbounds-parse-error" style="display:none;"></div>
        <div id="outbounds-parse-warn" class="outbounds-parse-msg outbounds-parse-warn" style="display:none;"></div>

        <div id="outbounds-parse-kv" class="outbounds-parse-kv"></div>
      </div>

      <div class="actions xk-actions-grid-2">
        <button id="outbounds-open-editor-btn" data-tooltip="–û—Ç–∫—Ä—ã—Ç—å {{ outbounds_name|e }} –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ JSON.">üìù –†–µ–¥–∞–∫—Ç–æ—Ä</button>
        <button id="outbounds-normalize-btn" data-tooltip="–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É: –¥–µ—Ñ–æ–ª—Ç—ã, –∞–ª–∏–∞—Å—ã, –ø–æ—Ä—è–¥–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.">‚ú® –ù–æ—Ä–º</button>
        <button id="outbounds-build-btn" data-tooltip="–û—Ç–∫—Ä—ã—Ç—å –º–∏–Ω–∏-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏ —Å–æ–±—Ä–∞—Ç—å —Å—Å—ã–ª–∫—É –∏–∑ –ø–æ–¥—Å–∫–∞–∑–æ–∫ (protocol/type/security).">üß© –°–æ–±—Ä–∞—Ç—å</button>
        <button id="outbounds-save-btn" data-tooltip="–†–∞—Å–ø–∞—Ä—Å–∏—Ç—å —Å—Å—ã–ª–∫—É –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ outbounds –¥–ª—è Xray.">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button id="outbounds-backup-btn" data-tooltip="–°–¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø {{ outbounds_name|e }}.">üì¶ Backup</button>
        <button id="outbounds-restore-auto-btn" data-tooltip="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å outbounds –∏–∑ –∞–≤—Ç–æ–±—ç–∫–∞–ø–∞.">‚è™ Restore</button>
      </div>

      <div id="outbounds-status" class="status"></div>
      </div>
    </section>

    <!-- Backups list -->
    <section class="card">
      <div class="commands-header" id="routing-backups-header">
        <h2>–ë—ç–∫–∞–ø—ã Xray –∫–æ–Ω—Ñ–∏–≥–æ–≤ (routing / inbounds / outbounds / dns / ‚Ä¶)</h2>
        <span id="routing-backups-arrow">‚ñ∫</span>
      </div>

      <div id="routing-backups-body" style="display:none;">
        <p>–ö–∞—Ç–∞–ª–æ–≥ –±—ç–∫–∞–ø–æ–≤: <code>{{ backup_dir }}</code></p>

        <p class="xk-card-desc" style="margin-top: 8px;">
          –ó–¥–µ—Å—å –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è <b>—Å–Ω–∏–º–∫–∏ (snapshots)</b> ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ rollback‚Äë–∫–æ–ø–∏–∏ –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞.
          –°–Ω–∏–º–æ–∫ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç <b>–ø—Ä–µ–¥—ã–¥—É—â–µ–µ</b> —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–∞–π–ª–∞.
        </p>


        <table id="backups-table" data-mode="snapshots">
          <thead>
            <tr>
              <th>–ò–º—è —Ñ–∞–π–ª–∞</th>
              <th>–†–∞–∑–º–µ—Ä</th>
              <th>–°–æ–∑–¥–∞–Ω</th>
              <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>

        <div id="backups-status" class="status"></div>

        <div class="hint xk-card-desc">
          <a href="/backups">–û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏—Å—Ç–æ—Ä–∏–∏ –±—ç–∫–∞–ø–æ–≤ ‚Üí</a>
        </div>
      </div>
    </section>

    <!-- Help block -->
    <section class="card">
      <div class="commands-header" id="routing-help-header">
        <h2>–°–ø—Ä–∞–≤–∫–∞ –∏ —Å—Å—ã–ª–∫–∏</h2>
        <span id="routing-help-arrow">‚ñ∫</span>
      </div>
      <div id="routing-help-body" style="display:none;">
        <ul class="links">
          <li><a href="https://github.com/Corvus-Malus/XKeen" target="_blank" rel="noopener">GitHub Corvus-Malus/XKeen</a></li>
          <li><a href="https://jameszero.net/faq-xkeen.htm" target="_blank" rel="noopener">FAQ –ø–æ XKeen (jameszero.net)</a></li>
          <li><a href="https://t.me/c/2138190368/23" target="_blank" rel="noopener">Telegram —á–∞—Ç XKeen</a></li>
          <li><a href="https://github.com/jameszeroX/XKeen" target="_blank" rel="noopener">GitHub jameszeroX/XKeen</a></li>
          <li><a href="https://github.com/jameszeroX/XKeen/tree/main/test" target="_blank" rel="noopener">XKeen beta</a></li>
        </ul>
      </div>
    </section>

        </div>
      </div>

<div class="routing-col routing-col-center">
        <section class="card routing-rules-card">
          <div class="commands-header" id="routing-rules-header">
            <h2>–ü—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏</h2>
            <span id="routing-rules-arrow">‚ñ∫</span>
          </div>

          <div id="routing-rules-body" style="display:none;">
            <div class="routing-rules-toolbar">
              <div class="routing-rules-summary">
                <span id="routing-rules-count">‚Äî</span>
                <span class="routing-rules-dot">‚Ä¢</span>
                <span id="routing-rules-geo">‚Äî</span>
              </div>
              <div class="routing-rules-controls">
                <input type="search" id="routing-rules-filter" class="routing-rules-filter" placeholder="–§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–≥–∞–º / —Ç–∏–ø–∞–º / –∑–Ω–∞—á–µ–Ω–∏—è–º">
                <button id="routing-rules-refresh-btn" class="btn-secondary" type="button">‚ü≥ –û–±–Ω–æ–≤–∏—Ç—å</button>
              </div>
            </div>

            <div class="routing-rules-config">
              <div class="routing-rules-settings">
                <label class="routing-rule-field">
                  <span class="routing-rule-key"><span>domainStrategy</span></span>
                  <select id="routing-domain-strategy" class="routing-rule-input routing-domain-strategy-select">
                    <option value="">(–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)</option>
                    <option value="AsIs">AsIs</option>
                    <option value="IPIfNonMatch">IPIfNonMatch</option>
                    <option value="IPOnDemand">IPOnDemand</option>
                  </select>
                </label>
              </div>
              <div class="routing-rules-actions">
                <button id="routing-balancer-add-btn" class="btn-secondary btn-icon" type="button" data-tooltip="–î–æ–±–∞–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫" aria-label="–î–æ–±–∞–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫">‚öñÔ∏è</button>
                <button id="routing-rules-add-btn" class="btn-secondary btn-icon" type="button" data-tooltip="–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ" aria-label="–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ">üìú</button>
                <button id="routing-rules-apply-btn" class="btn-secondary btn-icon" type="button" data-tooltip="–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ JSON-—Ä–µ–¥–∞–∫—Ç–æ—Ä" aria-label="–ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤ JSON">üíæ</button>
                <button id="routing-rules-reload-btn" class="btn-secondary btn-icon" type="button" data-tooltip="–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ JSON-—Ä–µ–¥–∞–∫—Ç–æ—Ä–∞" aria-label="–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ JSON">‚Ü∫</button>
              </div>
            </div>

            <div class="routing-balancers">
              <div class="routing-balancers-title">–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∏</div>
              <div id="routing-balancers-list" class="routing-balancers-grid"></div>
            </div>

            <div id="routing-rules-list" class="routing-rule-grid"></div>
            <div id="routing-rules-empty" class="xk-card-desc">–ó–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ routing.rules.</div>
          </div>
        </section>

        <!-- –°–≤–æ—Ä–∞—á–∏–≤–∞–µ–º—ã–π –±–ª–æ–∫ routing -->

        <section class="card">
          <div class="commands-header" id="routing-header">
            <h2>
              –†–æ—É—Ç–∏–Ω–≥ Xray
              <span class="xray-profile-badge" data-profile="{{ xray_profile|e }}">
                {% if xray_profile == 'hys2' %}Hysteria2{% else %}–û–±—ã—á–Ω—ã–π{% endif %}
              </span>
            </h2>
            <span class="xk-routing-active-inline">–ê–∫—Ç–∏–≤–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç: <code id="routing-file-code">{{ routing_file }}</code></span>
            <span id="routing-arrow">‚ñº</span>
          </div>

          <div id="routing-body">
            <!-- Compact header row (file selector + editor toolbar) -->
            <div class="xk-routing-topbar">
              <div class="xk-routing-fileblock">
                <div class="xk-routing-fileline">
                  <select id="routing-fragment-select" class="xray-log-select" data-current="{{ routing_name|e }}"></select>
                  <button id="routing-fragment-refresh-btn" type="button" class="btn-icon btn-secondary" data-tooltip="–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ —Ä–æ—É—Ç–∏–Ω–≥–∞ –∏–∑ /opt/etc/xray/configs/">‚Üª</button>
                </div>
              </div>
              <div class="xk-routing-toolbarhost" id="routing-toolbar-host"></div>
            </div>

            <textarea id="routing-editor" spellcheck="false"></textarea>

            <div id="routing-error" class="error"></div>

            <div class="actions">
  <button id="routing-save-btn" data-tooltip="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–æ—É—Ç–∏–Ω–≥ (routing.json).">üíæ Save routing</button>
  <button id="routing-format-btn" data-tooltip="–û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å JSON (–∫—Ä–∞—Å–∏–≤—ã–µ –æ—Ç—Å—Ç—É–ø—ã).">‚ú® Format JSON</button>
  <button id="routing-backup-btn" data-tooltip="–°–¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø —Ç–µ–∫—É—â–µ–≥–æ routing.json.">üì¶ Backup</button>
  <button id="routing-restore-auto-btn" data-tooltip="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å routing –∏–∑ –∞–≤—Ç–æ–±—ç–∫–∞–ø–∞.">‚è™ Restore autobackup</button>
  <button id="routing-export-local-btn" data-tooltip="–°–∫–∞—á–∞—Ç—å routing.json –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä.">‚¨áÔ∏è –≠–∫—Å–ø–æ—Ä—Ç</button>
  <button id="routing-import-local-btn" data-tooltip="–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å routing.json —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞.">‚¨ÜÔ∏è –ò–º–ø–æ—Ä—Ç</button>
  <button id="routing-import-template-btn" data-tooltip="–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω —Ä–æ—É—Ç–∏–Ω–≥–∞ (–∑–∞–º–µ–Ω–∏—Ç —Ç–µ–∫—Å—Ç –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ, –±–µ–∑ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è).">üß© –®–∞–±–ª–æ–Ω—ã</button>
</div>

<input type="file"
       id="local-config-file-input"
       accept="application/json"
       style="display:none">

            <div class="actions">
              <button id="github-export-btn" data-tooltip="–í—ã–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—É—â–∏–π routing.json –≤ GitHub‚Äë–∫–∞—Ç–∞–ª–æ–≥ –∫–æ–Ω—Ñ–∏–≥–æ–≤.">‚¨ÜÔ∏è –í—ã–≥—Ä—É–∑–∏—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–∞—Ä–∏–π</button>
              <button id="github-open-catalog-btn" data-tooltip="–û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π (GitHub).">üìÇ –ö–∞—Ç–∞–ª–æ–≥ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π</button>
            </div>

            <div id="routing-status" class="status"></div>
          </div>
</section>

      </div>
    </div>
</div>

<div id="view-mihomo" class="view-section" style="display:none;" data-xk-section="mihomo">
  <section class="card">
    <div class="commands-header" onclick="toggleMihomoCard()">
      <h2>–†–æ—É—Ç–∏–Ω–≥ Mihomo</h2>
      <span id="mihomo-arrow">‚ñº</span>
    </div>

    <div id="mihomo-body">
      <p class="small xk-card-desc">
        –ê–∫—Ç–∏–≤–Ω—ã–π —Ñ–∞–π–ª: <code>{{ mihomo_config_file|e }}</code>
      </p>

      <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–¥–∞–∫—Ç–æ—Ä config.yaml -->
      <textarea id="mihomo-editor" spellcheck="false"></textarea>
      <div id="mihomo-status" class="status"></div>

      <!-- –®–∞–±–ª–æ–Ω—ã config.yaml -->
      <div class="actions mihomo-templates-row">
        <select id="mihomo-template-select" class="mihomo-template-select">
          <option value="">‚Äî –≤—ã–±–µ—Ä–∏ —à–∞–±–ª–æ–Ω ‚Äî</option>
        </select>

        <button id="mihomo-template-load-btn"
                type="button"
                title="–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω">
          üìÇ –®–∞–±–ª–æ–Ω
        </button>

        <button id="mihomo-load-btn"
                title="–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—É—â–∏–π config.yaml">
          üì• –ö–æ–Ω—Ñ–∏–≥
        </button>

        <button id="mihomo-import-node-btn"
                type="button"
                title="–ò–º–ø–æ—Ä—Ç —É–∑–ª–∞/–ø–æ–¥–ø–∏—Å–∫–∏: –≤—Å—Ç–∞–≤—å —Å—Å—ã–ª–∫—É (vless/trojan/vmess/ss/hysteria2/hy2) –∏–ª–∏ https-–ø–æ–¥–ø–∏—Å–∫—É ‚Äî –ø–∞–Ω–µ–ª—å –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤ YAML –∏ –¥–æ–±–∞–≤–∏—Ç –≤ config.yaml">
          ‚ûï –£–∑–µ–ª
        </button>
        <button id="mihomo-save-btn"
                title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å (–∞–≤—Ç–æ‚Äë–±—ç–∫–∞–ø, –∞–≤—Ç–æ‚Äë–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ –≥–∞–ª–∫–µ)">
          üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
        </button>
        <button id="mihomo-validate-btn"
                type="button"
                title="–ü—Ä–æ–≤–µ—Ä–∏—Ç—å config.yaml —á–µ—Ä–µ–∑ mihomo (–±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —Ä–µ—Å—Ç–∞—Ä—Ç–∞)">
          ü©∫ –ü—Ä–æ–≤–µ—Ä–∫–∞
        </button>
        <button id="mihomo-save-restart-btn"
                title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å mihomo">
          üíæüí• –†–µ—Å—Ç–∞—Ä—Ç
        </button>
      </div>

      <hr>

      
      
<!-- –ü—Ä–æ—Ñ–∏–ª–∏ –∏ –±—ç–∫–∞–ø—ã Mihomo -->
      <div class="commands-header" id="mihomo-profiles-link" style="cursor:pointer;">
        <h3>üóÇÔ∏è –ü—Ä–æ—Ñ–∏–ª–∏ –∏ –±—ç–∫–∞–ø—ã Mihomo</h3>
        <span id="mihomo-profiles-arrow">‚ñº</span>
      </div>

      <div id="mihomo-profiles-panel" style="display:none; margin-top:8px;">
        <div class="mihomo-grid">
          <div class="mihomo-column">
            <h4>–ü—Ä–æ—Ñ–∏–ª–∏</h4>
            <div class="actions">
              <button id="mihomo-refresh-profiles-btn" class="icon-btn">
                üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ñ–∏–ª–µ–π
              </button>
            </div>
            <table class="xkeen-table">
              <thead>
                <tr>
                  <th>–ü—Ä–æ—Ñ–∏–ª—å</th>
                  <th>–ê–∫—Ç–∏–≤–µ–Ω</th>
                  <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
              </thead>
              <tbody id="mihomo-profiles-list"></tbody>
            </table>

            <h5 style="margin-top:12px;">–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –∏–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞</h5>
            <input id="mihomo-new-profile-name"
                   class="xkeen-input"
                   type="text"
                   placeholder="–ò–º—è –ø—Ä–æ—Ñ–∏–ª—è (–±–µ–∑ .yaml)">
            <button id="mihomo-save-profile-btn"
                    title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π config.yaml –∫–∞–∫ –ø—Ä–æ—Ñ–∏–ª—å">
              üíæ –ü—Ä–æ—Ñ–∏–ª—å
            </button>
          </div>

          <div class="mihomo-column">
            <h4>–ë—ç–∫–∞–ø—ã</h4>
            <div class="actions">
              <button id="mihomo-refresh-backups-btn" class="icon-btn">
                üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤
              </button>
            </div>
            <div class="small" style="margin-top:6px;">
              <label>
                <input type="checkbox" id="mihomo-backups-active-only" checked>
                –¢–æ–ª—å–∫–æ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
              </label>
              <span id="mihomo-backups-active-profile-label" style="margin-left:8px;"></span>
            </div>
            <div class="small" style="margin-top: 6px;">
              <label>
                –û—Å—Ç–∞–≤–∏—Ç—å –Ω–µ –±–æ–ª–µ–µ
                <input
                  id="mihomo-backups-clean-limit"
                  class="xkeen-input"
                  type="number"
                  min="0"
                  value="5"
                  style="width: 64px; margin: 0 4px;"
                >
                –±—ç–∫–∞–ø–æ–≤
              </label>
              <button id="mihomo-backups-clean-btn" class="icon-btn" title="–û—á–∏—Å—Ç–∏—Ç—å –±—ç–∫–∞–ø—ã">üßπ</button>
              <span class="hint xk-card-desc">
                0 ‚Äî —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –±—ç–∫–∞–ø—ã (—Å —É—á—ë—Ç–æ–º —Ñ–∏–ª—å—Ç—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è).
              </span>
            </div>
            <table class="xkeen-table">
              <thead>
                <tr>
                  <th>–§–∞–π–ª</th>
                  <th>–ü—Ä–æ—Ñ–∏–ª—å</th>
                  <th>–°–æ–∑–¥–∞–Ω</th>
                  <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
              </thead>
              <tbody id="mihomo-backups-list"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
<div id="view-xkeen" class="view-section" style="display:none;" data-xk-section="xkeen">
  <!-- XKeen: –ø–æ—Ä—Ç—ã –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è -->
      <section class="card commands-card">
        <div class="commands-header" onclick="toggleXkeenSettings()">
          <h2>–ü–æ—Ä—Ç—ã –∏ –ò—Å–∫–ª—é—á–µ–Ω–∏—è</h2>
          <span id="xkeen-arrow">‚ñº</span>
        </div>
        <div id="xkeen-body">
          <p>–§–∞–π–ª—ã –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ <code>/opt/etc/xkeen</code>:</p>

          <h3>port_proxying.lst</h3>
          <p class="small xk-card-desc">
            –ü–æ—Ä—Ç—ã –∏ –¥–∏–∞–ø–∞–∑–æ–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏.
          </p>
          <textarea id="port-proxying-editor"
                    class="xkeen-textarea"
                    spellcheck="false"
                    rows="8"
                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä:\n80\n443\n596:599\n–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –ø–æ—Ä—Ç –∏–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω –ø–æ—Ä—Ç–æ–≤."></textarea>
          <div class="actions">
            <button id="port-proxying-save-btn" data-tooltip="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ port_proxying.lst.">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å port_proxying.lst</button>
          </div>
          <div id="port-proxying-status" class="status"></div>

          <hr>

          <h3>port_exclude.lst</h3>
          <p class="small xk-card-desc">
            –ü–æ—Ä—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å –∏–∑ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è.<br>
            <strong>–í–∞–∂–Ω–æ:</strong> –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–∫—Å–∏—Ä—É–µ–º—ã—Ö –ø–æ—Ä—Ç–æ–≤ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –Ω–µ–ª—å–∑—è,
            –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É –ø–æ—Ä—Ç–æ–≤ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è.
          </p>
          <textarea id="port-exclude-editor"
                    class="xkeen-textarea"
                    spellcheck="false"
                    rows="8"
                    placeholder="–ü–æ—Ä—Ç—ã –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è.\n–ù–∞–ø—Ä–∏–º–µ—Ä:\n22\n25\n80:89"></textarea>
          <div class="actions">
            <button id="port-exclude-save-btn" data-tooltip="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ port_exclude.lst.">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å port_exclude.lst</button>
          </div>
          <div id="port-exclude-status" class="status"></div>

          <hr>

          <h3>ip_exclude.lst</h3>
          <p class="small xk-card-desc">
            IP –∏ –ø–æ–¥—Å–µ—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å –∏–∑ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è (–ø–æ –æ–¥–Ω–æ–π –≤ —Å—Ç—Ä–æ–∫–µ).
          </p>
          <textarea id="ip-exclude-editor"
                    class="xkeen-textarea"
                    spellcheck="false"
                    rows="8"
                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä:\n192.168.0.0/16\n2001:db8::/32"></textarea>
          <div class="actions">
            <button id="ip-exclude-save-btn" data-tooltip="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ ip_exclude.lst.">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ip_exclude.lst</button>
          </div>
          <div id="ip-exclude-status" class="status"></div>
        </div>
      </section>
</div>

<div id="view-commands" class="view-section" style="display:none;" data-xk-section="commands">
  <!-- XKeen commands -->
<section class="card commands-card">
  <div class="commands-header">
    <h2>–ö–æ–º–∞–Ω–¥—ã</h2>
    <button type="button" class="btn-secondary" id="terminal-open-shell-btn" data-tooltip="–û—Ç–∫—Ä—ã—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª (–æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º).">–û—Ç–∫—Ä—ã—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª</button>
    <button type="button" class="btn-secondary btn-interactive-shell" id="terminal-open-pty-btn" title="–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –æ–±–æ–ª–æ—á–∫–∞ (PTY)" data-tooltip="–û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –æ–±–æ–ª–æ—á–∫—É (PTY).">Interactive Shell</button>
  </div>

  <div id="commands-body">
  {% for group in command_groups %}
    <div class="command-group">
      <div class="command-group-title">{{ group.title }}</div>
      <ul class="command-list">
        {% for cmd in group['items'] %}
          <li class="command-item-wrap">
            <button type="button"
                    class="command-item xkeen-ctrl-btn"
                    data-flag="{{ cmd.flag }}"
                    data-label="xkeen {{ cmd.flag }}"
                    data-tooltip="{{ cmd.desc }}">
              <code>xkeen {{ cmd.flag }}</code>
            </button>
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endfor %}

    <div class="command-group">
      <div class="command-group-title">–£—Ç–∏–ª–∏—Ç—ã –ø–∞–Ω–µ–ª–∏</div>
      <ul class="command-list">
        <li class="command-item-wrap">
          <button type="button"
                  class="command-item xkeen-ctrl-btn"
                  data-flag="__sysmon_full"
                  data-label="sysmon --full"
                  data-tooltip="–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ): —Å–µ—Ç—å/DNS/HTTPS/conntrack/–æ—à–∏–±–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤/–ª–æ–≥–∏">
            <code>sysmon --full</code>
          </button>
        </li>
      </ul>
    </div>

  </div>
</section>
  <!-- Restart log -->
    <section class="card log-card">
      <div class="log-header-row">
        <h2>–ñ—É—Ä–Ω–∞–ª</h2>
        <div class="log-header-actions">
          <button type="button" class="btn-secondary log-btn" id="restart-log-clear-btn">–û—á–∏—Å—Ç–∏—Ç—å</button>
          <button type="button" class="btn-secondary log-btn" id="restart-log-copy-btn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
        </div>
      </div>
      <pre id="restart-log" class="log-block"></pre>
    </section>
</div>

<div id="view-files" class="view-section" style="display:none;" data-xk-section="files">
  <section class="card fm-card">
    <div class="fm-header">
      <h2>–§–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä</h2>
      <div class="fm-header-actions">
        <button type="button" class="btn-secondary" id="fm-ops-btn" title="–û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏ (–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å, –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å, —É–¥–∞–ª–∏—Ç—å, –∞—Ä—Ö–∏–≤—ã –∏ —Ç.–¥.)">üßæ –û–ø–µ—Ä–∞—Ü–∏–∏</button>
      </div>
    </div>

    <div id="fm-disabled-note" class="status" style="display:none;"></div>

    <!-- Busy overlay: shown when opening remote files (SFTP) so the user sees progress and
         doesn't click "open" multiple times while content is loading into the editor. -->
    <div id="fm-open-overlay" class="fm-busy-overlay hidden" role="status" aria-live="polite" aria-hidden="true">
      <div class="fm-busy-box">
        <div class="fm-busy-spinner" aria-hidden="true"></div>
        <div class="fm-busy-text" id="fm-open-overlay-text">–û—Ç–∫—Ä—ã–≤–∞—é —Ñ–∞–π–ª‚Ä¶</div>
      </div>
    </div>

    <div class="fm-two" id="fm-root">
      <div class="fm-panel" data-side="left">
        <div class="fm-panel-bar">
          <select class="fm-target-select" aria-label="Target" title="local / remote">
            <option value="local">L</option>
            <option value="remote">R</option>
          </select>
          <button type="button" class="btn-secondary fm-connect-btn" title="–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —É–¥–∞–ª—ë–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É (SFTP)">Connect‚Ä¶</button>
          <button type="button" class="btn-secondary fm-disconnect-btn" title="–û—Ç–∫–ª—é—á–∏—Ç—å—Å—è –æ—Ç —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞" style="display:none;">Disconnect</button>
          <input class="fm-path-input" spellcheck="false" placeholder="/opt/var" title="–ü—É—Ç—å —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–∏ (Enter ‚Äî –ø–µ—Ä–µ–π—Ç–∏)" />
          <button type="button" class="btn-secondary fm-up-btn" title="–í–≤–µ—Ä—Ö" aria-label="–í–≤–µ—Ä—Ö">‚Üë</button>
          <button type="button" class="btn-secondary fm-refresh-btn" title="–û–±–Ω–æ–≤–∏—Ç—å">‚ü≥</button>
          <div class="fm-filter-wrap">
            <input class="terminal-input fm-filter-input" type="text" placeholder="–§–∏–ª—å—Ç—Ä‚Ä¶" title="–§–∏–ª—å—Ç—Ä –ø–æ –∏–º–µ–Ω–∏ –≤ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ" autocomplete="off" spellcheck="false" />
            <button type="button" class="btn-secondary fm-filter-clear-btn hidden" title="–û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä">‚úñ</button>
          </div>
        </div>
        <div class="fm-list" tabindex="0" role="listbox" aria-label="Left panel"></div>
      </div>

      <div class="fm-panel" data-side="right">
        <div class="fm-panel-bar">
          <select class="fm-target-select" aria-label="Target" title="local / remote">
            <option value="local">L</option>
            <option value="remote">R</option>
          </select>
          <button type="button" class="btn-secondary fm-connect-btn" title="–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —É–¥–∞–ª—ë–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É (SFTP)">Connect‚Ä¶</button>
          <button type="button" class="btn-secondary fm-disconnect-btn" title="–û—Ç–∫–ª—é—á–∏—Ç—å—Å—è –æ—Ç —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞" style="display:none;">Disconnect</button>
          <input class="fm-path-input" spellcheck="false" placeholder="/opt/var" title="–ü—É—Ç—å —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–∏ (Enter ‚Äî –ø–µ—Ä–µ–π—Ç–∏)" />
          <button type="button" class="btn-secondary fm-up-btn" title="–í–≤–µ—Ä—Ö" aria-label="–í–≤–µ—Ä—Ö">‚Üë</button>
          <button type="button" class="btn-secondary fm-refresh-btn" title="–û–±–Ω–æ–≤–∏—Ç—å">‚ü≥</button>
          <div class="fm-filter-wrap">
            <input class="terminal-input fm-filter-input" type="text" placeholder="–§–∏–ª—å—Ç—Ä‚Ä¶" title="–§–∏–ª—å—Ç—Ä –ø–æ –∏–º–µ–Ω–∏ –≤ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ" autocomplete="off" spellcheck="false" />
            <button type="button" class="btn-secondary fm-filter-clear-btn hidden" title="–û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä">‚úñ</button>
          </div>
        </div>
        <div class="fm-list" tabindex="0" role="listbox" aria-label="Right panel"></div>
      </div>
    </div>
    <div class="fm-hints">
      <div class="fm-hints-text">
        <span><b>Tab</b> ‚Äî —Å–º–µ–Ω–∞ –ø–∞–Ω–µ–ª–∏</span>
        <span><b>Enter</b> ‚Äî –æ—Ç–∫—Ä—ã—Ç—å</span>
        <span><b>Backspace</b> ‚Äî –≤–≤–µ—Ä—Ö</span>
        <span><b>Ctrl+A</b> ‚Äî –≤—ã–¥–µ–ª–∏—Ç—å –≤—Å—ë</span>
        <span><b>Ctrl+I</b> ‚Äî –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</span>
        <span><b>Ctrl+M</b> ‚Äî –≤—ã–¥–µ–ª–∏—Ç—å –ø–æ –º–∞—Å–∫–µ</span>
        <span><b>Ctrl+Shift+C</b> ‚Äî –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å</span>
        <span><b>F7</b> ‚Äî –Ω–æ–≤–∞—è –ø–∞–ø–∫–∞</span>
        <span><b>Shift+F7</b> ‚Äî –Ω–æ–≤—ã–π —Ñ–∞–π–ª</span>
        <span><b>F2</b> ‚Äî Rename</span>
        <span><b>–ü–ö–ú</b> ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é</span>
        <span><b>F5</b> ‚Äî Copy</span>
        <span><b>F6</b> ‚Äî Move</span>
        <span><b>Drag&Drop</b> ‚Äî –≤—ã–±—Ä–∞—Ç—å Move / Copy</span>
        <span><b>F8</b> ‚Äî –≤ –∫–æ—Ä–∑–∏–Ω—É (–≤ –∫–æ—Ä–∑–∏–Ω–µ ‚Äî —É–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞)</span>
      </div>
    </div>

    <div class="fm-footer">
      <button type="button" class="btn-secondary fm-help-btn" id="fm-help-btn" title="–°–ø—Ä–∞–≤–∫–∞ (F1)" aria-label="–°–ø—Ä–∞–≤–∫–∞">‚ùì –°–ø—Ä–∞–≤–∫–∞</button>
      <div class="fm-footer-actions" aria-label="File manager actions"></div>
    </div>
  </section>
</div>

    <div id="view-xray-logs" class="view-section" style="display:none;" data-xk-section="xray-logs">
      <section class="card log-card">
        <div class="log-header-row">
          <h2>Live –ª–æ–≥–∏ Xray <span id="xray-log-lamp" class="xray-log-lamp" data-state="unknown" title="–°—Ç–∞—Ç—É—Å –ª–æ–≥–æ–≤ Xray –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω"></span></h2>
          <div class="log-header-actions">
            <select id="xray-log-file" class="xray-log-select" onchange="xrayLogChangeFile()">
              <option value="access" selected>access.log</option>
              <option value="error">error.log</option>
            </select>
            <select
              id="xray-log-level"
              class="xray-log-select"
              title="–£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è Xray (loglevel) –¥–ª—è error.log. –≠—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å: debug –≤–∫–ª—é—á–∞–µ—Ç info/warning/error, info –≤–∫–ª—é—á–∞–µ—Ç warning/error –∏ —Ç.–¥. –ü—Ä–∏ —Å–º–µ–Ω–µ —É—Ä–æ–≤–Ω—è, –µ—Å–ª–∏ –ª–æ–≥–∏ —É–∂–µ –≤–∫–ª—é—á–µ–Ω—ã, —É—Ä–æ–≤–µ–Ω—å –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å—Ä–∞–∑—É. –¢–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ —Ñ–∏–ª—å—Ç—Ä –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –æ–∫–Ω–µ."
            >
              <option value="warning" selected>warning</option>
              <option value="info">info</option>
              <option value="debug">debug</option>
              <option value="error">error</option>
            </select>
            <button type="button" class="btn-secondary log-btn icon-only" onclick="xrayLogsView()" title="–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏" aria-label="–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏">üîç</button>
            <button type="button" class="btn-secondary log-btn icon-only" onclick="xrayLogsEnable()" title="–í–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏" aria-label="–í–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏">‚ñ∂</button>
            <button type="button" class="btn-secondary log-btn icon-only" onclick="xrayLogsDisable()" title="–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏" aria-label="–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏">‚èπ</button>
            <button type="button" class="btn-secondary log-btn icon-only" onclick="xrayLogsClearScreen()" title="–û—á–∏—Å—Ç–∏—Ç—å –∂—É—Ä–Ω–∞–ª" aria-label="–û—á–∏—Å—Ç–∏—Ç—å –∂—É—Ä–Ω–∞–ª">üßπ</button>
            <button type="button" class="btn-secondary log-btn icon-only" onclick="xrayLogsClear()" title="–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥—Ñ–∞–π–ª—ã" aria-label="–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥—Ñ–∞–π–ª—ã">üóë</button>
            <button type="button" class="btn-secondary log-btn icon-only" onclick="xrayLogsCopy()" title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å">üìã</button>
            <button type="button" class="btn-secondary log-btn icon-only" id="xray-log-fullscreen" title="–ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω" aria-label="–ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω">‚õ∂</button>
          </div>
        </div>
        <div class="log-filter-row">
          <input
            id="xray-log-filter"
            type="text"
            class="xray-log-filter"
            placeholder="–§–∏–ª—å—Ç—Ä –ø–æ –ª–æ–≥–∞–º (–ø—Ä–∏–º–µ—Ä: error xray)"
          />
          <button
            id="xray-log-filter-clear"
            type="button"
            class="btn-secondary log-btn"
            title="–û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä"
            aria-label="–û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä"
          >
            ‚úñ
          </button>
        </div>
        <div class="dt-log-controls xray-log-controls" aria-label="Xray log controls">
          <label class="dt-switch" title="Live —Ä–µ–∂–∏–º: –∞–≤—Ç–æ‚Äë–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫.">
            <input id="xray-log-live" type="checkbox" />
            <span class="dt-switch-slider" aria-hidden="true"></span>
            <span class="dt-switch-label">Live</span>
          </label>

          <div class="dt-log-interval" title="–ò–Ω—Ç–µ—Ä–≤–∞–ª –∞–≤—Ç–æ‚Äë–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ HTTP‚Äë–ø–æ–ª–ª–∏–Ω–≥–µ).">
            <span class="dt-log-interval-label">every</span>
            <select id="xray-log-interval" class="xray-log-select" aria-label="–ò–Ω—Ç–µ—Ä–≤–∞–ª">
              <option value="1000">1s</option>
              <option value="2000" selected>2s</option>
              <option value="5000">5s</option>
              <option value="10000">10s</option>
              <option value="30000">30s</option>
            </select>
          </div>

          <label class="dt-switch" title="–ê–≤—Ç–æ‚Äë–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤ –∫–æ–Ω–µ—Ü –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏.">
            <input id="xray-log-follow" type="checkbox" checked />
            <span class="dt-switch-slider" aria-hidden="true"></span>
            <span class="dt-switch-label">Follow</span>
          </label>

          <button type="button" id="xray-log-pause" class="btn-secondary dt-log-btn" title="–ü–∞—É–∑–∞: –∑–∞–º–æ—Ä–æ–∑–∏—Ç—å –≤—ã–≤–æ–¥ (—Å—Ç—Ä–æ–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Å–æ–±–∏—Ä–∞—Ç—å—Å—è)." aria-label="–ü–∞—É–∑–∞">‚è∏ Pause</button>

          <details class="dt-log-menu" id="xray-log-more">
            <summary class="btn-secondary dt-log-btn" title="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ" aria-label="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ">‚ãØ</summary>
            <div class="dt-log-menu-panel" role="menu" aria-label="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è">
  <div class="dt-log-menu-row" aria-label="–û–∫–Ω–æ –ª–æ–≥–æ–≤">
    <span class="small" style="opacity:0.85;">Lines</span>
    <input id="xray-log-lines" class="dt-log-lines-input" type="number" min="50" max="5000" step="50" value="800" aria-label="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫" />
  </div>
  <button type="button" id="xray-log-copy-selection" class="btn-secondary dt-log-btn" title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞.">Copy selection</button>
  <button type="button" id="xray-log-download" class="btn-secondary dt-log-btn" title="–°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–∏–π –ª–æ–≥—Ñ–∞–π–ª.">Download</button>
  <button type="button" id="xray-log-load-more" class="btn-secondary dt-log-btn" title="–ü–æ–¥–≥—Ä—É–∑–∏—Ç—å –±–æ–ª–µ–µ —Å—Ç–∞—Ä—ã–µ —Å—Ç—Ä–æ–∫–∏ (—É–≤–µ–ª–∏—á–∏—Ç—å –æ–∫–Ω–æ –Ω–∞–∑–∞–¥).">Load more</button>
</div>
          </details>

          <span class="small dt-log-stats" id="xray-log-stats" aria-live="polite"></span>
        </div>

        <pre id="xray-log-output" class="log-block xray-log-block"></pre>
        <div id="xray-log-status" class="status"></div>
      </section>
    </div>

    <!-- Xray log: context modal -->
    <div id="xray-context-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="–ö–æ–Ω—Ç–µ–∫—Å—Ç —Å—Ç—Ä–æ–∫–∏ –ª–æ–≥–∞ Xray">
      <div class="modal-content" style="max-width: 980px;">
        <div class="modal-header">
          <span class="modal-title" id="xray-context-title">Xray log context</span>
          <button type="button" class="modal-close" id="xray-context-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
        <div class="modal-body">
          <pre id="xray-context-output" class="log-block" style="max-height:60vh; overflow:auto;"></pre>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn-secondary" id="xray-context-copy-btn" title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç">üìã Copy</button>
          <button type="button" class="btn-secondary" id="xray-context-close-btn2" title="–ó–∞–∫—Ä—ã—Ç—å">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
      </div>
    </div>

    <!-- –ú–∏–Ω–∏-—Ç–µ—Ä–º–∏–Ω–∞–ª XKeen -->
    <div id="terminal-overlay" class="terminal-overlay" style="display:none;">
      <div class="terminal-window">
        <div class="terminal-header">
	          <div class="terminal-header-left">
	            <span>–¢–µ—Ä–º–∏–Ω–∞–ª XKeen</span>
	            <span id="terminal-conn-lamp" class="service-status-lamp terminal-conn-lamp" data-state="stopped" title="–¢–µ—Ä–º–∏–Ω–∞–ª: –æ—Ç–∫–ª—é—á–µ–Ω–æ" aria-label="–°—Ç–∞—Ç—É—Å —Ç–µ—Ä–º–∏–Ω–∞–ª–∞"></span>
	            <span id="terminal-uptime" class="terminal-uptime" title="–ê–ø—Ç–∞–π–º">00:00</span>
</div>
	          <div class="terminal-toolbar" aria-label="Terminal toolbar">
              <button type="button" class="terminal-tool-btn" id="terminal-btn-fullscreen" title="–ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω / –æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º" aria-label="–ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω / –æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º">‚õ∂</button>
              <button type="button" class="terminal-tool-btn" id="terminal-btn-overflow" title="–ú–µ–Ω—é —Ç–µ—Ä–º–∏–Ω–∞–ª–∞" aria-label="–ú–µ–Ω—é —Ç–µ—Ä–º–∏–Ω–∞–ª–∞">‚ãØ</button>

              <div id="terminal-overflow-menu" class="terminal-overflow-menu hidden" role="menu" aria-label="–ú–µ–Ω—é —Ç–µ—Ä–º–∏–Ω–∞–ª–∞">
                <div class="terminal-menu-section" aria-label="–°–µ—Å—Å–∏—è" data-collapsible="1" data-section="session">
                  <div class="terminal-menu-title">–°–µ—Å—Å–∏—è</div>
                  <button type="button" class="terminal-tool-btn" id="terminal-btn-reconnect" title="–ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è" aria-label="–ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è">üîå –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è</button>
                  <button type="button" class="terminal-tool-btn" id="terminal-btn-retry-now" title="–ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Å–µ–π—á–∞—Å" aria-label="–ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Å–µ–π—á–∞—Å">‚Üª –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Å–µ–π—á–∞—Å</button>
                  <button type="button" class="terminal-tool-btn terminal-tool-btn-danger" id="terminal-btn-stop-retry" title="–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ" aria-label="–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ">‚èπ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</button>
                  <button type="button" class="terminal-tool-btn" id="terminal-btn-new-session" title="–ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è" aria-label="–ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è">‚ûï –ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è</button>
                  <button type="button" class="terminal-tool-btn" id="terminal-btn-detach" title="–û—Ç—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è (–æ—Å—Ç–∞–≤–∏—Ç—å PTY –∂–∏–≤—ã–º)" aria-label="–û—Ç—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è">‚è∏ –û—Ç—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
                  <button type="button" class="terminal-tool-btn terminal-tool-btn-danger" id="terminal-btn-kill" title="–ó–∞–≤–µ—Ä—à–∏—Ç—å PTY-—Å–µ—Å—Å–∏—é" aria-label="–ó–∞–≤–µ—Ä—à–∏—Ç—å PTY">‚èª –ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ—Å—Å–∏—é</button>
                </div>

                <div class="terminal-menu-sep" role="separator" aria-hidden="true"></div>

                <div class="terminal-menu-section" aria-label="–°–∏–≥–Ω–∞–ª—ã" data-collapsible="1" data-section="signals">
                  <div class="terminal-menu-title">–°–∏–≥–Ω–∞–ª—ã</div>
                  <button type="button" class="terminal-tool-btn terminal-tool-btn-kbd" id="terminal-btn-ctrlc" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å Ctrl+C" aria-label="–û—Ç–ø—Ä–∞–≤–∏—Ç—å Ctrl+C">Ctrl+C</button>
                  <button type="button" class="terminal-tool-btn terminal-tool-btn-kbd" id="terminal-btn-ctrld" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å Ctrl+D" aria-label="–û—Ç–ø—Ä–∞–≤–∏—Ç—å Ctrl+D">Ctrl+D</button>
                  <button type="button" class="terminal-signals-item terminal-pty-only" data-terminal-signal="INT" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å SIGINT">SIGINT</button>
                  <button type="button" class="terminal-signals-item terminal-pty-only" data-terminal-signal="TERM" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å SIGTERM">SIGTERM</button>
                  <button type="button" class="terminal-signals-item terminal-pty-only" data-terminal-signal="HUP" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å SIGHUP">SIGHUP</button>
                  <button type="button" class="terminal-signals-item terminal-tool-btn-danger terminal-pty-only" data-terminal-signal="KILL" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å SIGKILL">SIGKILL</button>
                  <button type="button" class="terminal-signals-item terminal-pty-only" data-terminal-signal="QUIT" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å SIGQUIT">SIGQUIT</button>
                </div>

                <div class="terminal-menu-sep" role="separator" aria-hidden="true"></div>

                <div class="terminal-menu-section" aria-label="–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã" data-collapsible="1" data-section="tools">
                  <div class="terminal-menu-title">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</div>
                  <button type="button" class="terminal-tool-btn" id="terminal-btn-xraylogs" data-menu-keepopen="1" title="–õ–æ–≥–∏ Xray (tail -f –≤ PTY)" aria-label="–õ–æ–≥–∏ Xray">üìú –õ–æ–≥–∏ Xray</button>
                  <div id="terminal-xraylogs-menu" class="terminal-xraylogs-menu hidden" role="menu" aria-label="–õ–æ–≥–∏ Xray">
                    <div class="terminal-xraylogs-row">
                      <select id="terminal-xraylogs-file" class="xray-log-select" title="–§–∞–π–ª –ª–æ–≥–∞" aria-label="–§–∞–π–ª –ª–æ–≥–∞">
                        <option value="error">error.log</option>
                        <option value="access">access.log</option>
                      </select>
                      <select id="terminal-xraylogs-level" class="xray-log-select" title="–£—Ä–æ–≤–µ–Ω—å" aria-label="–£—Ä–æ–≤–µ–Ω—å">
                        <option value="warning">warning</option>
                        <option value="info">info</option>
                        <option value="debug">debug</option>
                      </select>
                    </div>
                    <div class="terminal-xraylogs-actions">
                      <button type="button" class="terminal-tool-btn terminal-xraylogs-iconbtn" id="terminal-xraylogs-start" title="–°—Ç–∞—Ä—Ç" aria-label="–ó–∞–ø—É—Å—Ç–∏—Ç—å tail">‚ñ∂</button>
                      <button type="button" class="terminal-tool-btn terminal-tool-btn-danger terminal-xraylogs-iconbtn" id="terminal-xraylogs-stop" title="–°—Ç–æ–ø (–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å tail)" aria-label="–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å tail">‚ñ†</button>
                      <button type="button" class="terminal-tool-btn terminal-tool-btn-danger terminal-xraylogs-iconbtn" id="terminal-xraylogs-disable" title="–û—Ç–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏" aria-label="–û—Ç–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏">‚õî</button>
                    </div>
                  </div>

                  <button type="button" class="terminal-tool-btn" id="terminal-btn-ssh" title="–ü—Ä–æ—Ñ–∏–ª–∏ SSH" aria-label="–ü—Ä–æ—Ñ–∏–ª–∏ SSH">SSH –ü—Ä–æ—Ñ–∏–ª–∏</button>
                  <button type="button" class="terminal-tool-btn" id="terminal-history-btn" title="–ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥" aria-label="–ò—Å—Ç–æ—Ä–∏—è">‚åö –ò—Å—Ç–æ—Ä–∏—è</button>
                </div>

                <div class="terminal-menu-sep" role="separator" aria-hidden="true"></div>

                <div class="terminal-menu-section" aria-label="–û–∫–Ω–æ">
                  <div class="terminal-menu-title">–û–∫–Ω–æ</div>
                  <button type="button" class="terminal-tool-btn" id="terminal-btn-minimize" title="–°–≤–µ—Ä–Ω—É—Ç—å (—Å–∫—Ä—ã—Ç—å –æ–∫–Ω–æ, –Ω–µ —Ä–∞–∑—Ä—ã–≤–∞—è WS)" aria-label="–°–≤–µ—Ä–Ω—É—Ç—å">üóï –°–≤–µ—Ä–Ω—É—Ç—å</button>
                </div>
              </div>

              <button type="button" class="terminal-close" id="terminal-btn-close" title="–ó–∞–∫—Ä—ã—Ç—å" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
            </div>
        </div>
        <input id="terminal-command"
               class="terminal-command"
               type="text"
               placeholder="–ö–æ–º–∞–Ω–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: ls -la /)">
	        <div class="terminal-search-row" id="terminal-search-row" aria-label="Terminal search">
	          <input id="terminal-search-input"
	                 class="terminal-search-input"
	                 type="text"
	                 placeholder="–ü–æ–∏—Å–∫ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (Ctrl+F / F3)"
	                 autocomplete="off"
	                 spellcheck="false">
	          <button type="button" class="terminal-search-btn" id="terminal-search-prev" title="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ (Shift+F3)" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ">‚Üë</button>
	          <button type="button" class="terminal-search-btn" id="terminal-search-next" title="–°–ª–µ–¥—É—é—â–µ–µ (F3 / Enter)" aria-label="–°–ª–µ–¥—É—é—â–µ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ">‚Üì</button>
	          <span id="terminal-search-counter" class="terminal-search-counter" title="–°–æ–≤–ø–∞–¥–µ–Ω–∏—è" aria-label="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π">0/0</span>
	          <button type="button" class="terminal-search-btn" id="terminal-search-clear" title="–û—á–∏—Å—Ç–∏—Ç—å" aria-label="–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫">√ó</button>
	        </div>
        <div id="terminal-xterm" class="terminal-output hidden"></div>
        <pre id="terminal-output" class="terminal-output"></pre>
        <div class="terminal-footer" aria-label="Terminal footer toolbar">
          <div class="terminal-footer-group terminal-footer-group-view" aria-label="–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
            <button type="button" class="terminal-tool-btn" id="terminal-btn-view-menu" title="–í–∏–¥" aria-label="–í–∏–¥">üëÅ –í–∏–¥</button>
            <div id="terminal-view-menu" class="terminal-view-menu hidden" role="menu" aria-label="–í–∏–¥">
              <button type="button" class="terminal-tool-btn" id="terminal-btn-font-dec" title="–®—Ä–∏—Ñ—Ç ‚àí" aria-label="–®—Ä–∏—Ñ—Ç –º–µ–Ω—å—à–µ">A‚àí –®—Ä–∏—Ñ—Ç –º–µ–Ω—å—à–µ</button>
              <button type="button" class="terminal-tool-btn" id="terminal-btn-font-inc" title="–®—Ä–∏—Ñ—Ç +" aria-label="–®—Ä–∏—Ñ—Ç –±–æ–ª—å—à–µ">A+ –®—Ä–∏—Ñ—Ç –±–æ–ª—å—à–µ</button>
              <button type="button" class="terminal-tool-btn" id="terminal-btn-cursorblink" title="–ú–∏–≥–∞–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞" aria-label="–ú–∏–≥–∞–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞">‚ñÆ –ú–∏–≥–∞–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞</button>
              <button type="button" class="terminal-tool-btn" id="terminal-btn-ansi" title="ANSI-—Ñ–∏–ª—å—Ç—Ä (—Å–∫—Ä—ã—Ç—å/–ø–æ–∫–∞–∑–∞—Ç—å ANSI-–∫–æ–¥—ã)" aria-label="ANSI-—Ñ–∏–ª—å—Ç—Ä">ANSI ANSI-—Ñ–∏–ª—å—Ç—Ä</button>
              <button type="button" class="terminal-tool-btn" id="terminal-btn-loghl" title="–ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ª–æ–≥–æ–≤" aria-label="–ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ª–æ–≥–æ–≤">üìù –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ª–æ–≥–æ–≤</button>
              <button type="button" class="terminal-tool-btn" id="terminal-btn-follow" title="–ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞" aria-label="–ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞">‚á£ –°–ª–µ–¥–∏—Ç—å</button>
              <button type="button" class="terminal-tool-btn" id="terminal-btn-bottom" title="–í –∫–æ–Ω–µ—Ü" aria-label="–í –∫–æ–Ω–µ—Ü">‚Üì –í –∫–æ–Ω–µ—Ü</button>
            </div>
          </div>

          <div class="terminal-footer-group terminal-footer-group-buffer" id="terminal-buffer-group" aria-label="–ë—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞">
            <button type="button" class="terminal-tool-btn" id="terminal-btn-buffer-menu" title="–ë—É—Ñ–µ—Ä" aria-label="–ë—É—Ñ–µ—Ä">üìã –ë—É—Ñ–µ—Ä</button>
            <div id="terminal-buffer-menu" class="terminal-buffer-menu hidden" role="menu" aria-label="–ë—É—Ñ–µ—Ä">
              <button type="button" class="terminal-tool-btn" id="terminal-btn-copy" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" aria-label="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
              <button type="button" class="terminal-tool-btn" id="terminal-btn-copyall" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –±—É—Ñ–µ—Ä" aria-label="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –±—É—Ñ–µ—Ä">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë</button>
              <button type="button" class="terminal-tool-btn" id="terminal-btn-paste" title="–í—Å—Ç–∞–≤–∏—Ç—å" aria-label="–í—Å—Ç–∞–≤–∏—Ç—å">üì• –í—Å—Ç–∞–≤–∏—Ç—å</button>
              <button type="button" class="terminal-tool-btn" id="terminal-btn-clear" title="–û—á–∏—Å—Ç–∏—Ç—å" aria-label="–û—á–∏—Å—Ç–∏—Ç—å">üßπ –û—á–∏—Å—Ç–∏—Ç—å</button>

              <div class="terminal-menu-sep" role="separator" aria-hidden="true"></div>

              <div class="terminal-menu-title terminal-menu-title-inline">‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å</div>
              <button type="button" class="terminal-tool-btn" id="terminal-btn-download" title="–°–∫–∞—á–∞—Ç—å –≤—ã–≤–æ–¥ (.txt)" aria-label="–°–∫–∞—á–∞—Ç—å –≤—ã–≤–æ–¥">.txt</button>
              <button type="button" class="terminal-tool-btn" id="terminal-btn-download-html" title="–°–∫–∞—á–∞—Ç—å –≤—ã–≤–æ–¥ (.html, —Å —Ü–≤–µ—Ç–∞–º–∏)" aria-label="–°–∫–∞—á–∞—Ç—å –≤—ã–≤–æ–¥ HTML">.html</button>
              <button type="button" class="terminal-tool-btn" id="terminal-btn-snapshot-vt" title="–°–Ω–∞–ø—à–æ—Ç VT (—Å ESC-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏)" aria-label="–°–Ω–∞–ø—à–æ—Ç VT">VT (snapshot)</button>
            </div>
          </div>

          <div class="terminal-footer-group terminal-footer-group-commands" id="terminal-commands-group" aria-label="–ö–æ–º–∞–Ω–¥—ã">
            <span class="terminal-footer-label">–ö–æ–º–∞–Ω–¥—ã</span>
            <button type="button" class="terminal-tool-btn" id="terminal-btn-commands" title="–ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã" aria-label="–ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã">‚ãØ –ö–æ–º–∞–Ω–¥—ã</button>
            <div id="terminal-commands-menu" class="terminal-commands-menu hidden" role="menu" aria-label="–ú–µ–Ω—é –∫–æ–º–∞–Ω–¥">
              <div class="terminal-commands-head">
                <div class="terminal-commands-title">–ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã</div>
                <div class="terminal-commands-mode" role="group" aria-label="Mode">
                  <button type="button" class="terminal-commands-mode-btn" id="terminal-qc-mode-insert" title="–í—Å—Ç–∞–≤–∏—Ç—å (lite) –∏–ª–∏ –Ω–∞–±—Ä–∞—Ç—å –≤ PTY">Insert</button>
                  <button type="button" class="terminal-commands-mode-btn" id="terminal-qc-mode-run" title="–í—ã–ø–æ–ª–Ω–∏—Ç—å (PTY –∏–ª–∏ lite)">Run</button>
                </div>
              </div>
              <div class="terminal-commands-list" id="terminal-commands-list"></div>
              <div class="terminal-commands-hint">–ö–ª–∏–∫ ‚Äî –ø–æ —Ä–µ–∂–∏–º—É. Ctrl/‚åò+–∫–ª–∏–∫ ‚Äî Run, Shift+–∫–ª–∏–∫ ‚Äî Insert.</div>
            </div>
          </div>
        </div>
        <div class="terminal-input-row">
          <input id="terminal-input"
                 class="terminal-input"
                 type="text"
                 placeholder="–¢–µ–∫—Å—Ç –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: yes). –ü—É—Å—Ç–æ ‚Äî –ø—Ä–æ—Å—Ç–æ Enter.">
          <button type="button" class="terminal-send" id="terminal-send-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
      </div>
    </div>

    <!-- History drawer for terminal commands -->
    <div id="terminal-history-modal" class="modal modal-drawer hidden" aria-label="–ò—Å—Ç–æ—Ä–∏—è —Ç–µ—Ä–º–∏–Ω–∞–ª–∞">
      <div class="modal-content terminal-history-content">
        <div class="modal-header">
          <span class="modal-title">–ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥</span>
          <button type="button" class="modal-close" id="terminal-history-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
        <div class="modal-body">
          <input id="terminal-history-filter" class="terminal-history-filter" type="text" placeholder="–§–∏–ª—å—Ç—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä: iptables, log, ping)" autocomplete="off" spellcheck="false">
          <div id="terminal-history-list" class="terminal-history-list" role="list"></div>
          <div class="terminal-history-hint">–ö–ª–∏–∫ ‚Äî –≤—Å—Ç–∞–≤–∏—Ç—å –≤ –ø–æ–ª–µ –∫–æ–º–∞–Ω–¥—ã. –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç—å.</div>
        </div>
	        <div class="modal-actions">
	          <!-- In the history drawer, action buttons should share the same sizing/style.
	               `terminal-tool-btn` is a compact toolbar style, so we keep only the danger palette here. -->
	          <button type="button" id="terminal-history-clear-btn" class="terminal-tool-btn-danger" title="–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∫–æ–º–∞–Ω–¥">üóë –û—á–∏—Å—Ç–∏—Ç—å</button>
          <button type="button" id="terminal-history-insert-btn" title="–í—Å—Ç–∞–≤–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–æ–º–∞–Ω–¥—É –≤ –ø–æ–ª–µ –∫–æ–º–∞–Ω–¥—ã">–í—Å—Ç–∞–≤–∏—Ç—å</button>
          <button type="button" id="terminal-history-run-btn" title="–í—ã–ø–æ–ª–Ω–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–æ–º–∞–Ω–¥—É">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
        </div>
      </div>
    </div>

    
    <div id="core-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <span class="modal-title">–í—ã–±–æ—Ä —è–¥—Ä–∞ XKeen</span>
          <button type="button" class="modal-close" id="core-modal-close-btn">√ó</button>
        </div>
        <div class="modal-body">
          <p class="modal-description">
            –í—ã–±–µ—Ä–∏—Ç–µ —è–¥—Ä–æ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–µ—Ä–≤–∏—Å–æ–º xkeen.
            –ü—Ä–∏ —Å–º–µ–Ω–µ —è–¥—Ä–∞ —Å–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω.
          </p>
          <div class="core-select-row">
            <button type="button" class="core-option" data-core="xray">xray</button>
            <button type="button" class="core-option" data-core="mihomo">mihomo</button>
          </div>
          <p id="core-modal-status" class="modal-hint" style="margin-top: 8px; font-size: 0.85rem; color: var(--modal-muted, var(--muted, #9ca3af));"></p>
        </div>
        <div class="modal-actions">
          <button id="core-modal-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
          <button id="core-modal-confirm-btn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        </div>
      </div>
    </div>

    <!-- Shared confirm modal (replaces browser confirm alerts) -->
    <div id="confirm-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ">
      <div class="modal-content">
        <div class="modal-header">
          <span class="modal-title" id="confirm-modal-title">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</span>
          <button type="button" class="modal-close" id="confirm-modal-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
        <div class="modal-body">
          <p id="confirm-modal-message" class="modal-description"></p>
        </div>
        <div class="modal-actions">
          <button type="button" id="confirm-modal-cancel-btn">–û—Ç–º–µ–Ω–∏—Ç—å</button>
          <button type="button" id="confirm-modal-ok-btn" class="btn-danger">OK</button>
        </div>
      </div>
    </div>



    <!-- Xray snapshots preview modal (read-only) -->
    <div id="xray-snapshot-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–Ω–∏–º–∫–∞ Xray –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏">
      <div class="modal-content" style="max-width: 980px;" data-modal-key="xray-snapshot-preview">
        <div class="modal-header">
          <span class="modal-title">–°–Ω–∏–º–æ–∫: <span id="xray-snapshot-title">‚Äî</span></span>
          <button type="button" class="modal-close" id="xray-snapshot-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
        <div class="modal-body">
          <p id="xray-snapshot-meta" class="modal-description" style="margin-bottom: 10px;">‚Äî</p>
          <textarea class="routing-template-preview-code" id="xray-snapshot-preview" readonly>// –∑–∞–≥—Ä—É–∑–∫–∞‚Ä¶</textarea>
          <div id="xray-snapshot-status" class="modal-hint" style="margin-top: 10px;"></div>
        </div>
        <div class="modal-actions" style="justify-content: space-between;">
          <button type="button" class="btn-secondary" id="xray-snapshot-copy-btn" data-tooltip="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç —Å–Ω–∏–º–∫–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞">‚ßâ –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
          <div style="display:flex; gap:10px;">
            <button type="button" id="xray-snapshot-cancel-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Routing templates: import preset into 05_routing.json (no auto-save) -->
    <div id="routing-template-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="–ò–º–ø–æ—Ä—Ç —à–∞–±–ª–æ–Ω–∞ —Ä–æ—É—Ç–∏–Ω–≥–∞">
      <div class="modal-content" style="max-width: 860px;" data-modal-key="routing-templates">
        <div class="modal-header">
          <span class="modal-title">–ò–º–ø–æ—Ä—Ç —à–∞–±–ª–æ–Ω–∞ —Ä–æ—É—Ç–∏–Ω–≥–∞ <span id="routing-template-count" class="xk-count-badge">0</span></span>
          <button type="button" class="modal-close" id="routing-template-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
        <div class="modal-body">
          <p class="modal-description" style="margin-bottom: 12px;">
            –í—ã–±–µ—Ä–∏ –≥–æ—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω. –û–Ω –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏ –∑–∞–º–µ–Ω–∏—Ç —Ç–µ–∫—É—â–∏–π —Ç–µ–∫—Å—Ç <b>–±–µ–∑ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è</b>.
          </p>

          <div class="routing-template-grid">
            <div class="routing-template-list" id="routing-template-list"></div>

            <div class="routing-template-preview">
              <div class="routing-template-preview-header">
                <div class="routing-template-preview-title" id="routing-template-title">‚Äî</div>
                <div class="routing-template-preview-desc" id="routing-template-desc">–í—ã–±–µ—Ä–∏ —à–∞–±–ª–æ–Ω —Å–ª–µ–≤–∞, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –ø—Ä–µ–≤—å—é.</div>
              </div>
              <textarea class="routing-template-preview-code" id="routing-template-preview" readonly>// –ø—Ä–µ–≤—å—é –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</textarea>
            </div>
          </div>

          <div id="routing-template-status" class="modal-hint" style="margin-top: 10px;"></div>
        </div>
        <div class="modal-actions" style="justify-content: space-between;">
          <div style="display:flex; gap:10px; flex-wrap: wrap;">
            <button type="button" class="btn-secondary" id="routing-template-refresh-btn" data-tooltip="–ü–µ—Ä–µ—á–∏—Ç–∞—Ç—å —Å–ø–∏—Å–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤ –∏–∑ /opt/etc/xray/templates/routing">‚ü≥ –û–±–Ω–æ–≤–∏—Ç—å</button>
            <button type="button" class="btn-secondary" id="routing-template-save-btn" data-tooltip="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ç–µ–∫—Å—Ç –∏–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∫–∞–∫ –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —à–∞–±–ª–æ–Ω">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ —à–∞–±–ª–æ–Ω</button>
            <button type="button" class="btn-secondary" id="routing-template-edit-btn" disabled data-tooltip="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω (—Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ)">‚úé –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            <button type="button" class="btn-danger" id="routing-template-delete-btn" disabled data-tooltip="–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω (—Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ)">üóë –£–¥–∞–ª–∏—Ç—å</button>
          </div>
          <div style="display:flex; gap:10px;">
            <button type="button" id="routing-template-import-btn" class="btn-primary" disabled data-tooltip="–ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —à–∞–±–ª–æ–Ω–æ–º">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            <button type="button" class="btn-secondary" id="routing-template-cancel-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Routing templates: save current editor content as a user template -->
    <div id="routing-template-save-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —à–∞–±–ª–æ–Ω —Ä–æ—É—Ç–∏–Ω–≥–∞">
      <div class="modal-content" style="max-width: 560px;" data-modal-key="routing-template-save">
        <div class="modal-header">
          <span class="modal-title">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ —à–∞–±–ª–æ–Ω</span>
          <button type="button" class="modal-close" id="routing-template-save-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
        <div class="modal-body">
          <p class="modal-description" style="margin-bottom: 10px;">
            –°–æ—Ö—Ä–∞–Ω–∏—Ç —Ç–µ–∫—É—â–∏–π —Ç–µ–∫—Å—Ç –∏–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∫–∞–∫ –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —à–∞–±–ª–æ–Ω –≤ <code>/opt/etc/xray/templates/routing</code>.
          </p>

          <div class="routing-template-save-form">
            <label>
              <span class="hint-label">–ò–º—è —Ñ–∞–π–ª–∞</span>
              <input id="routing-template-save-filename" class="xray-log-filter" type="text" placeholder="my_template.jsonc">
            </label>
            <label>
              <span class="hint-label">–ù–∞–∑–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</span>
              <input id="routing-template-save-title" class="xray-log-filter" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–æ–π —Ä–æ—É—Ç–∏–Ω–≥">
            </label>
            <label>
              <span class="hint-label">–û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</span>
              <textarea id="routing-template-save-desc" class="xray-log-filter routing-template-save-textarea" rows="3" placeholder="–ö–æ—Ä–æ—Ç–∫–æ –æ–ø–∏—à–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç —à–∞–±–ª–æ–Ω..."></textarea>
            </label>
          </div>

          <div id="routing-template-save-status" class="modal-hint" style="margin-top: 10px;"></div>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn-secondary" id="routing-template-save-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
          <button type="button" class="btn-primary" id="routing-template-save-confirm-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
      </div>
    </div>

<!-- Routing templates: edit existing user template -->
<div id="routing-template-edit-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω —Ä–æ—É—Ç–∏–Ω–≥–∞">
  <div class="modal-content" style="max-width: 860px;" data-modal-key="routing-template-edit">
    <div class="modal-header">
      <span class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω</span>
      <button type="button" class="modal-close" id="routing-template-edit-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
    </div>
    <div class="modal-body">
      <p class="modal-description" style="margin-bottom: 10px;">
        –ò–∑–º–µ–Ω–∏ <b>–∏–º—è / –Ω–∞–∑–≤–∞–Ω–∏–µ / –æ–ø–∏—Å–∞–Ω–∏–µ</b> –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —à–∞–±–ª–æ–Ω–∞. –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è <b>–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö</b> —à–∞–±–ª–æ–Ω–æ–≤.
      </p>

      <div class="routing-template-edit-form">
        <div class="routing-template-edit-row">
          <label>
            <span class="hint-label">–ò–º—è —Ñ–∞–π–ª–∞</span>
            <input id="routing-template-edit-filename" class="xray-log-filter" type="text" placeholder="my_template.jsonc">
          </label>
          <label>
            <span class="hint-label">–ù–∞–∑–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</span>
            <input id="routing-template-edit-title" class="xray-log-filter" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–æ–π —Ä–æ—É—Ç–∏–Ω–≥">
          </label>
        </div>

        <label>
          <span class="hint-label">–û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</span>
          <textarea id="routing-template-edit-desc" class="xray-log-filter routing-template-save-textarea" rows="2" placeholder="–ö–æ—Ä–æ—Ç–∫–æ –æ–ø–∏—à–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç —à–∞–±–ª–æ–Ω..."></textarea>
        </label>

        <label>
          <span class="hint-label">–®–∞–±–ª–æ–Ω (JSON / JSONC)</span>
          <textarea id="routing-template-edit-content" class="routing-template-edit-textarea" rows="14" spellcheck="false"></textarea>
        </label>
      </div>

      <div id="routing-template-edit-status" class="modal-hint" style="margin-top: 10px;"></div>
    </div>
    <div class="modal-actions">
      <button type="button" class="btn-secondary" id="routing-template-edit-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <button type="button" class="btn-primary" id="routing-template-edit-confirm-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </div>
</div>
    <!-- Outbounds: mini generator modal (build proxy link from hints) -->
    <div id="outbounds-generator-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="–°–±–æ—Ä–∫–∞ —Å—Å—ã–ª–∫–∏ –ø—Ä–æ–∫—Å–∏">
      <div class="modal-content" style="max-width: 780px;" data-modal-key="outbounds-generator">
        <div class="modal-header">
          <span class="modal-title">–°–æ–±—Ä–∞—Ç—å —Å—Å—ã–ª–∫—É –∏–∑ –ø–æ–¥—Å–∫–∞–∑–æ–∫</span>
          <button type="button" class="modal-close" id="outbounds-generator-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
        <div class="modal-body">
          <p class="modal-description" style="margin-bottom: 10px;">
            –ú–∏–Ω–∏-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä: –≤—ã–±–µ—Ä–∏ <b>–ø—Ä–æ—Ç–æ–∫–æ–ª / —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç / security</b> –∏ –∑–∞–ø–æ–ª–Ω–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–æ–ª—è.
            –ì–æ—Ç–æ–≤–∞—è —Å—Å—ã–ª–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è –Ω–∏–∂–µ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ –ø–æ–ª–µ <code>04_outbounds.json</code>.
          </p>

          <div class="outbounds-gen-hints">
            <label>
              <span class="hint-label">–ü—Ä–æ—Ç–æ–∫–æ–ª</span>
              <select id="outbounds-gen-proto" class="xray-log-select">
                <option value="auto" selected>–ê–≤—Ç–æ</option>
                <option value="vless">VLESS</option>
                <option value="trojan">Trojan</option>
                <option value="vmess">VMess</option>
                <option value="ss">Shadowsocks</option>
                <option value="hy2">Hysteria2 (HY2)</option>
              </select>
            </label>

            <label>
              <span class="hint-label">–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</span>
              <select id="outbounds-gen-type" class="xray-log-select">
                <option value="auto" selected>–ê–≤—Ç–æ</option>
                <option value="tcp">TCP</option>
                <option value="ws">WebSocket</option>
                <option value="grpc">gRPC</option>
                <option value="httpupgrade">HTTP Upgrade</option>
                <option value="kcp">mKCP</option>
                <option value="raw">RAW</option>
                <option value="xhttp">XHTTP</option>
              </select>
            </label>

            <label>
              <span class="hint-label">Security</span>
              <select id="outbounds-gen-security" class="xray-log-select">
                <option value="auto" selected>–ê–≤—Ç–æ</option>
                <option value="none">None</option>
                <option value="tls">TLS</option>
                <option value="reality">Reality</option>
              </select>
            </label>
          </div>

          <div class="outbounds-gen-grid">
            <label>
              <span class="hint-label">Server (host)</span>
              <input id="outbounds-gen-host" class="xray-log-filter" type="text" placeholder="example.com">
            </label>

            <label>
              <span class="hint-label">Port</span>
              <input id="outbounds-gen-port" class="xray-log-filter" type="number" placeholder="443" min="1" max="65535">
            </label>

            <label>
              <span class="hint-label">Tag (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span>
              <input id="outbounds-gen-tag" class="xray-log-filter" type="text" placeholder="proxy">
            </label>

            <label id="outbounds-gen-cred-vless">
              <span class="hint-label">UUID (VLESS)</span>
              <input id="outbounds-gen-uuid" class="xray-log-filter" type="text" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
            </label>

            <label id="outbounds-gen-cred-trojan" style="display:none;">
              <span class="hint-label">Password (Trojan)</span>
              <input id="outbounds-gen-pass" class="xray-log-filter" type="text" placeholder="password">
            </label>

            <label id="outbounds-gen-cred-vmess" style="display:none;">
              <span class="hint-label">UUID (VMess)</span>
              <input id="outbounds-gen-vmess-uuid" class="xray-log-filter" type="text" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
            </label>

            <label id="outbounds-gen-cred-ss" style="display:none;">
              <span class="hint-label">Method (SS)</span>
              <select id="outbounds-gen-ss-method" class="xray-log-select">
                <option value="aes-128-gcm">aes-128-gcm</option>
                <option value="aes-256-gcm">aes-256-gcm</option>
                <option value="chacha20-ietf-poly1305" selected>chacha20-ietf-poly1305</option>
                <option value="2022-blake3-aes-128-gcm">2022-blake3-aes-128-gcm</option>
                <option value="2022-blake3-aes-256-gcm">2022-blake3-aes-256-gcm</option>
              </select>
            </label>

            <label id="outbounds-gen-cred-ss-pass" style="display:none;">
              <span class="hint-label">Password (SS)</span>
              <input id="outbounds-gen-ss-pass" class="xray-log-filter" type="text" placeholder="password">
            </label>

            <label id="outbounds-gen-cred-hy2" style="display:none;">
              <span class="hint-label">Auth (HY2)</span>
              <input id="outbounds-gen-hy2-auth" class="xray-log-filter" type="text" placeholder="password –∏–ª–∏ user:pass">
            </label>
          </div>

          <details id="outbounds-gen-advanced" class="outbounds-gen-advanced">
            <summary>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</summary>
            <div class="outbounds-gen-grid outbounds-gen-adv">
              <label id="outbounds-gen-field-sni">
                <span class="hint-label">SNI</span>
                <input id="outbounds-gen-sni" class="xray-log-filter" type="text" placeholder="example.com">
              </label>

              <label id="outbounds-gen-field-fp">
                <span class="hint-label">Fingerprint (fp)</span>
                <input id="outbounds-gen-fp" class="xray-log-filter" type="text" placeholder="chrome">
              </label>

              <label id="outbounds-gen-field-alpn">
                <span class="hint-label">ALPN</span>
                <input id="outbounds-gen-alpn" class="xray-log-filter" type="text" placeholder="h2,http/1.1">
              </label>

              <label id="outbounds-gen-field-flow">
                <span class="hint-label">Flow (VLESS)</span>
                <select id="outbounds-gen-flow" class="xray-log-select">
                  <option value="">(–Ω–µ—Ç)</option>
                  <option value="xtls-rprx-vision">xtls-rprx-vision</option>
                </select>
              </label>

              <label id="outbounds-gen-field-path">
                <span class="hint-label">Path (WS/HTTP Upgrade)</span>
                <input id="outbounds-gen-path" class="xray-log-filter" type="text" placeholder="/">
              </label>

              <label id="outbounds-gen-field-hosthdr">
                <span class="hint-label">Host header (WS/HTTP Upgrade)</span>
                <input id="outbounds-gen-hosthdr" class="xray-log-filter" type="text" placeholder="cdn.example.com">
              </label>

              <label id="outbounds-gen-field-grpc-service">
                <span class="hint-label">gRPC serviceName</span>
                <input id="outbounds-gen-service" class="xray-log-filter" type="text" placeholder="grpc">
              </label>

              <label id="outbounds-gen-field-grpc-authority">
                <span class="hint-label">gRPC authority</span>
                <input id="outbounds-gen-authority" class="xray-log-filter" type="text" placeholder="example.com">
              </label>

              <label id="outbounds-gen-field-grpc-mode">
                <span class="hint-label">gRPC mode</span>
                <select id="outbounds-gen-grpc-mode" class="xray-log-select">
                  <option value="">auto</option>
                  <option value="multi">multi</option>
                </select>
              </label>

              <label id="outbounds-gen-field-reality-pbk">
                <span class="hint-label">Reality PBK (pbk)</span>
                <input id="outbounds-gen-pbk" class="xray-log-filter" type="text" placeholder="publicKey">
              </label>

              <label id="outbounds-gen-field-reality-sid">
                <span class="hint-label">Reality SID (sid)</span>
                <input id="outbounds-gen-sid" class="xray-log-filter" type="text" placeholder="shortId">
              </label>

              <label id="outbounds-gen-field-reality-spx">
                <span class="hint-label">Reality SPX (spx)</span>
                <input id="outbounds-gen-spx" class="xray-log-filter" type="text" placeholder="/" value="/">
              </label>

              <label id="outbounds-gen-field-ss-plugin" style="display:none;">
                <span class="hint-label">SS plugin (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span>
                <input id="outbounds-gen-ss-plugin" class="xray-log-filter" type="text" placeholder="v2ray-plugin;mode=websocket;tls">
              </label>

              <label id="outbounds-gen-field-hy2-insecure" style="display:none;">
                <span class="hint-label">HY2 insecure</span>
                <select id="outbounds-gen-hy2-insecure" class="xray-log-select">
                  <option value="0" selected>0 (–ø—Ä–æ–≤–µ—Ä—è—Ç—å TLS)</option>
                  <option value="1">1 (allow insecure)</option>
                </select>
              </label>

              <label id="outbounds-gen-field-hy2-obfs" style="display:none;">
                <span class="hint-label">HY2 obfs</span>
                <select id="outbounds-gen-hy2-obfs" class="xray-log-select">
                  <option value="" selected>(–Ω–µ—Ç)</option>
                  <option value="salamander">salamander</option>
                </select>
              </label>

              <label id="outbounds-gen-field-hy2-obfspwd" style="display:none;">
                <span class="hint-label">HY2 obfs-password</span>
                <input id="outbounds-gen-hy2-obfspwd" class="xray-log-filter" type="text" placeholder="obfs password">
              </label>

              <label id="outbounds-gen-field-hy2-pinsha256" style="display:none;">
                <span class="hint-label">PinSHA256 (HY2)</span>
                <input id="outbounds-gen-hy2-pinsha256" class="xray-log-filter" type="text" placeholder="33:83:...:95">
              </label>

              <label id="outbounds-gen-field-allowinsecure">
                <span class="hint-label">TLS allowInsecure</span>
                <select id="outbounds-gen-allowinsecure" class="xray-log-select">
                  <option value="0" selected>–ù–µ—Ç</option>
                  <option value="1">–î–∞</option>
                </select>
              </label>
            </div>
          </details>

          <div id="outbounds-gen-status" class="status" style="margin-top: 10px;"></div>

          <label style="display:block; margin-top: 10px;">
            <span class="hint-label">–°—Å—ã–ª–∫–∞ (preview)</span>
            <textarea id="outbounds-gen-preview" class="xkeen-textarea outbounds-gen-preview" spellcheck="false" readonly></textarea>
          </label>
        </div>
        <div class="modal-actions" style="justify-content: space-between; gap: 8px; flex-wrap: wrap;">
          <div style="display:flex; gap:8px; flex-wrap:wrap;">
            <button type="button" id="outbounds-gen-prefill-btn" class="btn-secondary" data-tooltip="–ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –∏–∑ —Å—Å—ã–ª–∫–∏, –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –≤ –ø–æ–ª–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (—É–¥–æ–±–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø—Ä–æ–∫—Å–∏).">‚Ü©Ô∏è –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∏–∑ –ø–æ–ª—è</button>
            <button type="button" id="outbounds-gen-generate-btn" data-tooltip="–°–æ–±—Ä–∞—Ç—å —Å—Å—ã–ª–∫—É –∏–∑ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π.">üß© –°–æ–±—Ä–∞—Ç—å</button>
            <button type="button" id="outbounds-gen-insert-btn" class="btn-primary" data-tooltip="–í—Å—Ç–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –≤ –ø–æ–ª–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏ –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ." disabled>‚úÖ –í—Å—Ç–∞–≤–∏—Ç—å –≤ –ø–æ–ª–µ</button>
          </div>
          <button type="button" id="outbounds-gen-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
        </div>
      </div>
    </div>
</div>

    <!-- Mihomo: import proxy / subscription modal (parser) -->
    <div id="mihomo-import-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="–ò–º–ø–æ—Ä—Ç —É–∑–ª–∞ Mihomo">
      <div class="modal-content" style="max-width: 780px;" data-modal-key="mihomo-import">
        <div class="modal-header">
          <span class="modal-title">–ò–º–ø–æ—Ä—Ç —É–∑–ª–∞ (Mihomo)</span>
          <button type="button" class="modal-close" id="mihomo-import-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
        <div class="modal-body">
          <p class="modal-description" style="margin-bottom: 10px;">
            –í—Å—Ç–∞–≤—å —Å—Å—ã–ª–∫—É —É–∑–ª–∞ <b>vless / trojan / vmess / ss / hysteria2 / hy2</b> –∏–ª–∏ <b>https‚Äë–ø–æ–¥–ø–∏—Å–∫—É</b>.
            –ü–∞–Ω–µ–ª—å –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –µ—ë –≤ YAML –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –¥–æ–±–∞–≤–∏—Ç –≤ <code>config.yaml</code>.
          </p>

          <label style="display:block; margin-top: 10px;">
            <span class="hint-label">–°—Å—ã–ª–∫–∞ / –ø–æ–¥–ø–∏—Å–∫–∞</span>
            <textarea id="mihomo-import-input" class="xkeen-textarea outbounds-gen-preview" spellcheck="false" placeholder="vless://...\n–∏–ª–∏\nhttps://..."></textarea>
          </label>

          <div id="mihomo-import-status" class="status" style="margin-top: 10px;"></div>
          <p id="mihomo-import-target-hint" class="modal-hint" style="margin:8px 0 0; opacity:0.75; font-size: 0.85rem;"></p>

          <label style="display:block; margin-top: 10px;">
            <span class="hint-label">YAML (preview)</span>
            <textarea id="mihomo-import-preview" class="xkeen-textarea outbounds-gen-preview" spellcheck="false" readonly></textarea>
          </label>
        </div>
        <div class="modal-actions" style="justify-content: space-between; gap: 8px; flex-wrap: wrap;">
          <div style="display:flex; gap:8px; flex-wrap:wrap;">
            <button type="button" id="mihomo-import-parse-btn" data-tooltip="–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –≤ YAML –∏ –ø–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.">‚ú® –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å</button>
            <button type="button" id="mihomo-import-insert-btn" class="btn-primary" data-tooltip="–í—Å—Ç–∞–≤–∏—Ç—å YAML –≤ config.yaml (proxies / proxy-providers) –∏ –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ." disabled>‚úÖ –í—Å—Ç–∞–≤–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥</button>
          </div>
          <button type="button" id="mihomo-import-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
        </div>
      </div>
    </div>
    
    <!-- File manager: upload conflict (same-name file already exists) -->
    <div id="fm-upload-conflict-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="–ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ">
      <div class="modal-content" style="max-width: 720px;">
        <div class="modal-header">
          <span class="modal-title" id="fm-upload-conflict-title">–§–∞–π–ª —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</span>
          <button type="button" class="modal-close" id="fm-upload-conflict-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
        <div class="modal-body">
          <p id="fm-upload-conflict-message" class="modal-description"></p>
          <p class="modal-hint" style="margin:8px 0 0; opacity:0.75; font-size: 0.85rem;">
            ¬´–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å¬ª —Å–æ—Ö—Ä–∞–Ω–∏—Ç –æ–±–∞ —Ñ–∞–π–ª–∞, –¥–æ–±–∞–≤–∏–≤ –∫ –∏–º–µ–Ω–∏ –Ω–æ–º–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, <code>file (1).txt</code>).
          </p>
        </div>
        <div class="modal-actions">
          <button type="button" id="fm-upload-conflict-skip-btn" class="btn-secondary">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
          <button type="button" id="fm-upload-conflict-rename-btn">–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å</button>
          <button type="button" id="fm-upload-conflict-overwrite-btn" class="btn-danger">–ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å</button>
        </div>
      </div>
    </div>

    <!-- File manager: text file viewer/editor -->
    <div id="fm-editor-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="–†–µ–¥–∞–∫—Ç–æ—Ä —Ñ–∞–π–ª–∞">
      <div class="modal-content" style="max-width: 980px;">
        <div class="modal-header">
          <div style="display:flex; flex-direction:column; gap:2px;">
            <span class="modal-title" id="fm-editor-title">–§–∞–π–ª</span>
            <span id="fm-editor-subtitle" class="modal-hint" style="margin:0; font-size: 0.82rem; opacity:0.75;"></span>
          </div>
          <button type="button" class="modal-close" id="fm-editor-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
        <div class="modal-body">
          <div id="fm-editor-warning" class="status" style="display:none;"></div>
          <div id="fm-editor-error" class="error" style="display:none;"></div>
          <textarea id="fm-editor-textarea" spellcheck="false"></textarea>
        </div>
        <div class="modal-actions">
          <div style="display:flex; gap:8px; align-items:center;">
            <button type="button" class="btn-secondary" id="fm-editor-download-btn">–°–∫–∞—á–∞—Ç—å</button>
          </div>
          <div style="display:flex; gap:8px; align-items:center;">
            <button type="button" id="fm-editor-cancel-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
            <button type="button" id="fm-editor-save-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          </div>
        </div>
      </div>
    </div>

<div id="github-export-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <span class="modal-title">–í—ã–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</span>
          <button type="button" class="modal-close" id="github-export-cancel-btn-header">√ó</button>
        </div>
        <div class="modal-body">
          <div class="github-export-form">
            <input id="github-export-tag-input" type="text" placeholder="–¢—ç–≥ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)">
            <textarea id="github-export-desc-input" rows="3" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)"></textarea>
          </div>
        </div>
        <div class="modal-actions">
          <button id="github-export-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
          <button id="github-export-confirm-btn">–í—ã–≥—Ä—É–∑–∏—Ç—å</button>
        </div>
      </div>
    </div>

    <div id="github-catalog-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <span class="modal-title">–ö–∞—Ç–∞–ª–æ–≥ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π</span>
          <button type="button" class="modal-close" id="github-catalog-close-btn-header">√ó</button>
        </div>
        <div class="modal-body">
          <div class="github-catalog-messages">
            <div id="github-catalog-status" class="status" style="margin-top:0;"></div>
            <div id="github-catalog-error" class="error" style="display:none; margin-top:0;"></div>
          </div>
          <div id="github-catalog-list">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
        <div class="modal-actions">
          <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
            <button type="button" class="btn-secondary btn-compact" id="github-catalog-retry-btn" title="–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∫–∞—Ç–∞–ª–æ–≥–∞">‚Üª –ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>
            <span id="github-catalog-stale-pill" class="github-stale-pill hidden" title="–ü–æ–∫–∞–∑–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞">–∫—ç—à</span>
            <a id="github-repo-link" href="{{ github_repo_url }}" target="_blank">–û—Ç–∫—Ä—ã—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub</a>
          </div>
          <div style="display:flex; gap:8px; align-items:center;">
            <button id="github-catalog-close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Donate modal (üí∞ –î–æ–Ω–∞—Ç) -->
    <div id="donate-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç">
      <div class="modal-content donate-modal-content">
        <div class="modal-header">
          <span class="modal-title">üí∞ –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</span>
          <button type="button" class="modal-close" id="donate-modal-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>

        <div class="modal-body">
          <p class="donate-lead">
            –ï—Å–ª–∏ –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª–∞—Å—å –ø–∞–Ω–µ–ª—å, –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –∏ –∫—É–ø–∏—Ç—å –∞–≤—Ç–æ—Ä—É –∫–æ—Ñ–µ ‚òï
          </p>

          <div class="donate-coins" role="list">
            <div class="donate-coin" role="listitem">
              <div class="donate-coin-title">USDT <span class="donate-coin-sub">(—Å–µ—Ç—å TON)</span></div>
              <button type="button" class="donate-address xk-tooltip" data-tooltip="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" data-copy="UQBm03wCEyD99CkEjjrfbtk08WrlgKqfyQGoueAwvhMEYV7L" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å USDT (TON)">
                <span class="donate-address-text">UQBm03wCEyD99CkEjjrfbtk08WrlgKqfyQGoueAwvhMEYV7L</span>
                <span class="donate-address-icon" aria-hidden="true">‚ßâ</span>
              </button>
            </div>

            <div class="donate-coin" role="listitem">
              <div class="donate-coin-title">TONCOIN</div>
              <button type="button" class="donate-address xk-tooltip" data-tooltip="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" data-copy="UQBm03wCEyD99CkEjjrfbtk08WrlgKqfyQGoueAwvhMEYV7L" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å TONCOIN">
                <span class="donate-address-text">UQBm03wCEyD99CkEjjrfbtk08WrlgKqfyQGoueAwvhMEYV7L</span>
                <span class="donate-address-icon" aria-hidden="true">‚ßâ</span>
              </button>
            </div>

            <div class="donate-coin" role="listitem">
              <div class="donate-coin-title">BITCOIN</div>
              <button type="button" class="donate-address xk-tooltip" data-tooltip="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" data-copy="bc1quhqk7l53vgmm9djyfktl6sflcvk83wgw0zqka6" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å BITCOIN">
                <span class="donate-address-text">bc1quhqk7l53vgmm9djyfktl6sflcvk83wgw0zqka6</span>
                <span class="donate-address-icon" aria-hidden="true">‚ßâ</span>
              </button>
            </div>

            <div class="donate-coin" role="listitem">
              <div class="donate-coin-title">Ethereum <span class="donate-coin-sub">(—Å–µ—Ç—å Ethereum)</span></div>
              <button type="button" class="donate-address xk-tooltip" data-tooltip="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" data-copy="0x8BA4b535ef7C990B96bc982083f9bFB392134F5e" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å Ethereum">
                <span class="donate-address-text">0x8BA4b535ef7C990B96bc982083f9bFB392134F5e</span>
                <span class="donate-address-icon" aria-hidden="true">‚ßâ</span>
              </button>
            </div>
          </div>

          <div class="donate-hint">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∞–¥—Ä–µ—Å, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞.</div>
        </div>

        <div class="modal-actions">
          <button type="button" id="donate-modal-ok-btn" class="btn-secondary">–ü–æ–Ω—è—Ç–Ω–æ</button>
        </div>
      </div>
    </div>

    <div id="toast-container"></div>

    <footer>
      <small>Xkeen UI ‚Äî {{ inbounds_file|e }}, {{ outbounds_file|e }}, {{ routing_file|e }}</small>
    </footer>
  </div>

  <script>
	    window.XKEEN_GITHUB_REPO_URL = "{{ github_repo_url|e }}";
	    // Files shown in UI (used by last-load badge and other helpers)
	    window.XKEEN_FILES = {
	      routing: "{{ routing_file|e }}",
	      inbounds: "{{ inbounds_file|e }}",
	      outbounds: "{{ outbounds_file|e }}",
	      mihomo: "{{ mihomo_config_file|e }}",
	    };
  </script>
  <!-- Modularization scaffold (no behavior changes yet) -->
  <script src="{{ url_for('static', filename='js/00_state.js') }}"></script>
  <script src="{{ url_for('static', filename='js/01_bootstrap.js') }}"></script>
  <script src="{{ url_for('static', filename='js/ui/toast.js') }}"></script>
  <script src="{{ url_for('static', filename='js/ui/modal.js') }}"></script>
  <script src="{{ url_for('static', filename='js/ui/confirm_modal.js') }}"></script>
  <script src="{{ url_for('static', filename='js/ui/theme.js') }}"></script>
  <script src="{{ url_for('static', filename='js/ui/tooltips_auto.js', v='20260119d') }}"></script>
	  <script src="{{ url_for('static', filename='js/ui/last_activity.js') }}"></script>
  <script src="{{ url_for('static', filename='js/util/helpers.js') }}"></script>
  <script src="{{ url_for('static', filename='js/ui/codemirror_loader.js') }}"></script>
  <script src="{{ url_for('static', filename='js/ui/codemirror_toolbar.js') }}"></script>
  <script src="{{ url_for('static', filename='js/ui/codemirror_links.js', v='20260105c') }}"></script>
  <script src="{{ url_for('static', filename='js/util/tab_id.js') }}"></script>
  <script src="{{ url_for('static', filename='js/util/ansi.js') }}"></script>
    <script src="{{ url_for('static', filename='js/util/command_job.js') }}"></script>
<script src="{{ url_for('static', filename='js/ui/spinner_fetch.js') }}"></script>
  <script src="{{ url_for('static', filename='js/ui/json_editor_modal.js') }}"></script>
  <script src="{{ url_for('static', filename='js/ui/dat_contents_modal.js', v='20260213b') }}"></script>
  <script src="{{ url_for('static', filename='js/features/backups.js', v='20260213c') }}"></script>
  <script src="{{ url_for('static', filename='js/features/routing.js') }}"></script>
  <script src="{{ url_for('static', filename='js/features/routing_cards.js', v='20260213b') }}"></script>
  <script src="{{ url_for('static', filename='js/features/routing_templates.js', v='20260120c') }}"></script>
  <script src="{{ url_for('static', filename='js/features/local_io.js') }}"></script>
  <script src="{{ url_for('static', filename='js/features/github.js') }}"></script>
  <script src="{{ url_for('static', filename='js/features/service_status.js') }}"></script>
  <script src="{{ url_for('static', filename='js/features/xray_logs.js') }}"></script>
  <script src="{{ url_for('static', filename='js/features/restart_log.js') }}"></script>
  <script src="{{ url_for('static', filename='js/features/mihomo_panel.js') }}"></script>
  <script src="{{ url_for('static', filename='js/features/mihomo_import.js', v='20260119d') }}"></script>
  <script src="{{ url_for('static', filename='js/features/commands_list.js') }}"></script>
  <script src="{{ url_for('static', filename='js/features/inbounds.js') }}"></script>
  <script src="{{ url_for('static', filename='js/features/outbounds.js') }}"></script>
    <script src="{{ url_for('static', filename='js/features/xkeen_texts.js') }}"></script>
    <!-- File Manager (split into small modules) -->
    <script src="{{ url_for('static', filename='js/features/file_manager/prefs.js') }}"></script>
    <script src="{{ url_for('static', filename='js/features/file_manager/chrome.js') }}"></script>
    <script src="{{ url_for('static', filename='js/features/file_manager/editor.js') }}"></script>
    <script src="{{ url_for('static', filename='js/features/file_manager.js', v='20260119d') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/_core.js') }}"></script>
  <!-- Terminal refactor (Wave 3): Stage A (events/ui/api) + Stage B (transport adapters) -->
  <script src="{{ url_for('static', filename='js/terminal/core/events.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/core/logger.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/core/config.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/core/ui.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/core/api.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/transport/pty_transport.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/transport/lite_transport.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/transport/index.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/core/state.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/core/registry.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/commands/registry.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/commands/router.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/commands/builtins/xkeen_restart.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/commands/builtins/sysmon.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/core/session_controller.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/core/context.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/core/public_api.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/core/output_controller.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/core/input_controller.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/capabilities.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/pty.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/core/xterm_manager.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/lite_runner.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/search.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/history.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/quick_commands.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/chrome.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/modules/overlay_controller.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/modules/status_controller.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/modules/terminal_controller.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/modules/ui_controller.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/modules/buffer_actions.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/modules/ssh_profiles.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/modules/reconnect_controller.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/modules/output_prefs.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/modules/confirm_prompt.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/xray_tail.js') }}"></script>
  <script src="{{ url_for('static', filename='js/terminal/terminal.js') }}"></script>
  <script src="{{ url_for('static', filename='js/features/donate.js') }}"></script>
  <script src="{{ url_for('static', filename='js/pages/panel.init.js') }}"></script>
  <script src="{{ url_for('static', filename='main.js') }}"></script>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–π JSON-—Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è 03_inbounds.json / 04_outbounds.json -->
    <div id="json-editor-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <span class="modal-title" id="json-editor-title">–†–µ–¥–∞–∫—Ç–æ—Ä JSON</span>
          <button type="button" class="modal-close" id="json-editor-close-btn">√ó</button>
        </div>
        <div class="modal-body">
          <p id="json-editor-file-label"></p>
          <textarea id="json-editor-textarea" spellcheck="false"></textarea>
          <div id="json-editor-error" class="error"></div>
        </div>
        <div class="modal-actions">
          <button type="button" id="json-editor-format-btn" class="btn-secondary" data-tooltip="–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å JSON/JSONC (—Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏)">‚ú® Format</button>
          <button id="json-editor-save-btn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          <button id="json-editor-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
        </div>
      </div>
    </div>

    <!-- DAT GeoSite/GeoIP: –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–≥–æ–≤ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ (copy geosite:TAG / geoip:TAG) -->
    <div id="routing-dat-contents-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="DAT content viewer">
      <div class="modal-content dat-contents-modal-content">
        <div class="modal-header">
          <span class="modal-title" id="routing-dat-contents-title">DAT ‚Äî –°–æ–¥–µ—Ä–∂–∏–º–æ–µ</span>
          <button type="button" class="modal-close" id="routing-dat-contents-close-btn" aria-label="Close">√ó</button>
        </div>
        <div class="modal-body dat-contents-modal-body">
          <div class="dat-contents-head">
            <div class="dat-contents-meta">
              <span class="dat-contents-kind" id="routing-dat-contents-kind">geosite:</span>
              <code class="dat-contents-path" id="routing-dat-contents-path">‚Äî</code>
            </div>
            <div class="dat-contents-controls">
              <button type="button" id="routing-dat-contents-install-geodat-btn" class="btn-secondary" data-tooltip="–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å xk-geodat (–Ω—É–∂–µ–Ω –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ DAT).">‚¨áÔ∏é xk-geodat</button>
              <button type="button" id="routing-dat-contents-reload-btn" class="btn-secondary" data-tooltip="–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–µ–≥–æ–≤">‚Üª</button>
            </div>
          </div>

          <div class="dat-contents-layout">
            <div class="dat-contents-tags">
              <div class="dat-contents-tags-top">
                <input id="routing-dat-contents-search" class="routing-dat-input" type="text" placeholder="–ü–æ–∏—Å–∫ —Ç–µ–≥–∞‚Ä¶">
                <div id="routing-dat-contents-tags-status" class="dat-contents-status"></div>
              </div>
              <div id="routing-dat-contents-tags-list" class="dat-contents-tags-list"></div>
            </div>

            <div class="dat-contents-items">
              <div class="dat-contents-items-top">
                <div class="dat-contents-selected">
                  <span class="dat-contents-selected-label">–¢–µ–≥:</span>
                  <code id="routing-dat-contents-selected-tag">‚Äî</code>
                  <span id="routing-dat-contents-used-badge" class="dat-contents-used-badge" data-tooltip="–¢–µ–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ routing.rules">‚úì –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è</span>
                </div>
                <div class="dat-contents-toolbar">
                  <button type="button" id="routing-dat-contents-copy-selected-btn" class="btn-secondary" disabled data-tooltip="–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–≥" aria-label="Copy">‚ßâ</button>
                  <div class="dat-contents-pager dat-contents-pager-inline">
                    <button type="button" id="routing-dat-contents-prev-btn" class="btn-secondary" disabled data-tooltip="–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞" aria-label="Prev">‚Üê</button>
                    <div id="routing-dat-contents-page-info" class="dat-contents-page-info"></div>
                    <button type="button" id="routing-dat-contents-next-btn" class="btn-secondary" disabled data-tooltip="–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞" aria-label="Next">‚Üí</button>
                  </div>
                </div>
              </div>

              <!-- PR3: –±—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ–Ω–æ—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–µ–≥–∞ –≤ routing.rules (—Å–æ–∑–¥–∞—Ç—å/–¥–æ–±–∞–≤–∏—Ç—å) -->
              <div class="dat-contents-routingbar" id="routing-dat-contents-routingbar">
                <span class="dat-contents-routing-label">–í routing:</span>
                <select id="routing-dat-contents-target-rule" class="routing-dat-input dat-contents-select" data-tooltip="–ö—É–¥–∞ –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–µ–≥"></select>
                <select id="routing-dat-contents-target-outbound" class="routing-dat-input dat-contents-select" data-tooltip="outboundTag –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞"></select>
                <button type="button" id="routing-dat-contents-inrouting-btn" class="btn-secondary" disabled data-tooltip="–î–æ–±–∞–≤–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–µ–≥ –≤ –ø—Ä–∞–≤–∏–ª–æ">‚ûï</button>
                <div id="routing-dat-contents-routing-status" class="dat-contents-status"></div>
              </div>

              <div id="routing-dat-contents-items-status" class="dat-contents-status"></div>
              <div id="routing-dat-contents-items-list" class="dat-contents-items-list"></div>
            </div>
          </div>
        </div>
        <div class="modal-actions" style="justify-content:flex-end;">
          <button type="button" id="routing-dat-contents-ok-btn" class="btn-secondary">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
      </div>
    </div>

<div id="mihomo-validation-modal" class="modal hidden" onclick="if (event.target === this) hideMihomoValidationModal();">
  <div class="modal-content">
    <div class="modal-header">
      <span class="modal-title">–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Mihomo</span>
      <button type="button" class="modal-close" onclick="hideMihomoValidationModal()">√ó</button>
    </div>
    <div id="mihomo-validation-modal-body" class="modal-body modal-body-logs"></div>
  </div>
</div>

<div id="ssh-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="SSH profiles">
  <div class="modal-content">
    <div class="modal-header">
      <span class="modal-title">SSH –ø—Ä–æ—Ñ–∏–ª–∏</span>
      <button type="button" class="modal-close" id="ssh-modal-close-btn" aria-label="Close">√ó</button>
    </div>

    <div class="modal-body">
      <div style="display:flex; gap:8px; margin-bottom:10px; flex-wrap:wrap;">
        <button type="button" id="ssh-add-btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
        <button type="button" id="ssh-delete-selected-btn" disabled>üóë –£–¥–∞–ª–∏—Ç—å</button>
        <button type="button" id="ssh-export-btn">üì§ Export</button>
        <button type="button" id="ssh-import-btn">üì• Import</button>
      </div>

      <div id="ssh-profiles-list" style="display:flex; flex-direction:column; gap:8px;"></div>

      <hr style="border:0; border-top:1px solid #334155; margin:12px 0;">

      <div style="display:flex; flex-direction:column; gap:8px;">
        <label style="opacity:.85;">–ö–æ–º–∞–Ω–¥–∞ (–±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ PTY)</label>
        <input id="ssh-command-preview" class="terminal-input" style="width:100%;" placeholder="ssh user@host -p 22" />
        <div style="display:flex; gap:8px; justify-content:flex-end; flex-wrap:wrap;">
          <button type="button" id="ssh-copy-preview-btn">üìã Copy</button>
          <button type="button" id="ssh-run-preview-btn">‚ñ∂ Run</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- SSH profile editor (no browser prompts/alerts) -->
<div id="ssh-edit-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="SSH profile editor">
  <div class="modal-content" style="max-width:640px;">
    <div class="modal-header">
      <span class="modal-title" id="ssh-edit-title">SSH –ø—Ä–æ—Ñ–∏–ª—å</span>
      <button type="button" class="modal-close" id="ssh-edit-close-btn" aria-label="Close">√ó</button>
    </div>

    <div class="modal-body">
      <div class="ssh-form-grid">
        <label for="ssh-edit-name">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
        <input id="ssh-edit-name" class="terminal-input" placeholder="–ù–∞–ø—Ä. –î–æ–º–∞—à–Ω–∏–π —Ä–æ—É—Ç–µ—Ä" />

        <label for="ssh-edit-host">Host *</label>
        <input id="ssh-edit-host" class="terminal-input" placeholder="IP –∏–ª–∏ DNS" />

        <label for="ssh-edit-user">User</label>
        <input id="ssh-edit-user" class="terminal-input" placeholder="root" />

        <label for="ssh-edit-port">Port</label>
        <input id="ssh-edit-port" class="terminal-input" placeholder="22" inputmode="numeric" />

        <label for="ssh-edit-key">Key path</label>
        <input id="ssh-edit-key" class="terminal-input" placeholder="/opt/home/user/.ssh/id_ed25519" />

        <label for="ssh-edit-jump">ProxyJump</label>
        <input id="ssh-edit-jump" class="terminal-input" placeholder="user@jump-host" />
      </div>
      <div id="ssh-edit-error" class="error"></div>
    </div>

    <div class="modal-actions">
      <button type="button" class="btn-secondary" id="ssh-edit-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <div style="display:flex; gap:8px; justify-content:flex-end;">
        <button type="button" id="ssh-edit-delete-btn">üóë –£–¥–∞–ª–∏—Ç—å</button>
        <button type="button" class="btn-primary" id="ssh-edit-save-btn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>
</div>

<!-- Small confirm modal for delete -->
<div id="ssh-confirm-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Confirm">
  <div class="modal-content" style="max-width:420px;">
    <div class="modal-header">
      <span class="modal-title">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</span>
      <button type="button" class="modal-close" id="ssh-confirm-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div id="ssh-confirm-text" style="white-space:pre-wrap;"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="ssh-confirm-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <button type="button" id="ssh-confirm-ok" class="btn-primary">OK</button>
    </div>
  </div>
</div>

<!-- File Manager: Connect modal -->
<div id="fm-connect-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Remote connect">
  <div class="modal-content" style="max-width:560px;">
    <div class="modal-header">
      <span class="modal-title">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É</span>
      <button type="button" class="modal-close" id="fm-connect-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div class="fm-form-grid">
        <label for="fm-conn-profile">–ü—Ä–æ—Ñ–∏–ª—å</label>
        <div style="display:flex; gap:8px; align-items:center;">
          <select id="fm-conn-profile" class="terminal-input" style="flex:1;">
            <option value="">‚Äî</option>
          </select>
          <button type="button" class="btn-secondary" id="fm-conn-profile-del-btn" title="–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å" aria-label="–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å">√ó</button>
        </div>

        <label for="fm-proto">–ü—Ä–æ—Ç–æ–∫–æ–ª</label>
        <select id="fm-proto" class="terminal-input">
          <option value="sftp">SFTP</option>
          <option value="ftp">FTP</option>
          <option value="ftps">FTPS</option>
        </select>

        <label for="fm-host">Host *</label>
        <input id="fm-host" class="terminal-input" placeholder="example.com" />

        <label for="fm-port">Port</label>
        <input id="fm-port" class="terminal-input" placeholder="22" inputmode="numeric" />

        <label for="fm-user">User</label>
        <input id="fm-user" class="terminal-input" placeholder="root" />

        <label for="fm-auth-type" id="fm-auth-type-label">Auth</label>
        <select id="fm-auth-type" class="terminal-input">
          <option value="password">password</option>
          <option value="key">key (SFTP)</option>
        </select>

        <label for="fm-pass" id="fm-pass-label">Password</label>
        <input id="fm-pass" class="terminal-input" type="password" placeholder="" />

        <label for="fm-key-file" id="fm-key-file-label">Private key</label>
        <input id="fm-key-file" class="terminal-input" type="file" />

        <label for="fm-key-path" id="fm-key-path-label">Key path (–Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ)</label>
        <input id="fm-key-path" class="terminal-input" placeholder="/opt/etc/ssh/id_rsa" spellcheck="false" />

        <label for="fm-passphrase" id="fm-passphrase-label">Passphrase</label>
        <input id="fm-passphrase" class="terminal-input" type="password" placeholder="(–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)" />

        <label for="fm-hostkey-policy">SFTP host key</label>
        <div style="display:flex; gap:8px; align-items:center;">
          <select id="fm-hostkey-policy" class="terminal-input" style="flex:1;">
          <option value="accept_new">accept_new (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
          <option value="reject_new">reject_new (—Å—Ç—Ä–æ–≥–æ)</option>
          <option value="accept_any">accept_any (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ)</option>
          </select>
          <button type="button" class="btn-secondary" id="fm-knownhosts-btn" title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ known_hosts">known_hosts‚Ä¶</button>
        </div>

        <label id="fm-hostkey-fp-label">Host key fingerprint</label>
        <div id="fm-hostkey-row" style="display:flex; gap:8px; align-items:center;">
          <div id="fm-hostkey-fp" class="status" style="margin:0; padding:8px 10px; opacity:.85; flex:1;">&nbsp;</div>
          <button
            type="button"
            class="btn-secondary btn-icon xk-tooltip"
            id="fm-hostkey-remove-btn"
            aria-label="–£–¥–∞–ª–∏—Ç—å hostkey"
            data-tooltip="–£–¥–∞–ª–∏—Ç—å hostkey –¥–ª—è —ç—Ç–æ–≥–æ host (–∑–∞–ø–∏—Å—å –∏–∑ known_hosts)"
          >üóë</button>
        </div>

        <label for="fm-tls-verify">FTPS TLS verify</label>
        <select id="fm-tls-verify" class="terminal-input">
          <option value="strict">strict (–ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç + hostname)</option>
          <option value="ca">ca (—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±–µ–∑ hostname)</option>
          <option value="none">none (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ)</option>
        </select>

        <label for="fm-remember-profile">–ó–∞–ø–æ–º–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</label>
        <div style="display:flex; align-items:center; gap:10px;">
          <input id="fm-remember-profile" type="checkbox" />
          <span style="opacity:.85;">host/user/port/proto (–±–µ–∑ –ø–∞—Ä–æ–ª—è, —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ)</span>
        </div>
      </div>
      <div id="fm-connect-error" class="error"></div>
      <div id="fm-connect-warn" class="status" style="display:none;"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-connect-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <button type="button" class="btn-primary" id="fm-connect-ok-btn">Connect</button>
    </div>
  </div>
</div>

<!-- File Manager: known_hosts management -->
<div id="fm-knownhosts-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="known_hosts">
  <div class="modal-content" style="max-width:760px;">
    <div class="modal-header">
      <span class="modal-title">SFTP: known_hosts</span>
      <button type="button" class="modal-close" id="fm-knownhosts-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div id="fm-knownhosts-path" class="status" style="margin:0 0 10px 0; padding:8px 10px; opacity:.85;">&nbsp;</div>

      <div class="form-row" style="display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin:0 0 10px 0;">
        <label for="fm-knownhosts-remove-host" style="min-width:170px;">–£–¥–∞–ª–∏—Ç—å –ø–æ host</label>
        <input id="fm-knownhosts-remove-host" class="terminal-input" placeholder="example.com[:2222] –∏–ª–∏ [2001:db8::1]:2222" style="flex:1; min-width:260px;" />
        <button type="button" class="btn-secondary" id="fm-knownhosts-remove-host-btn">–£–¥–∞–ª–∏—Ç—å</button>
      </div>

      <div style="display:flex; gap:8px; justify-content:flex-end; margin-bottom:10px; flex-wrap:wrap;">
        <button type="button" class="btn-secondary" id="fm-knownhosts-refresh-btn">–û–±–Ω–æ–≤–∏—Ç—å</button>
        <button type="button" class="btn-danger" id="fm-knownhosts-clear-btn">–û—á–∏—Å—Ç–∏—Ç—å known_hosts</button>
      </div>
      <div id="fm-knownhosts-error" class="error"></div>
      <div id="fm-knownhosts-hashed-hint" class="status" style="display:none; margin:0 0 10px 0; opacity:.75;"></div>
      <div id="fm-knownhosts-body" style="max-height:380px; overflow:auto;"></div>
      <div class="status" style="margin-top:10px; opacity:.75;">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≤—ã–ø—É—Å—Ç–∏–ª –∫–ª—é—á ‚Äî —É–¥–∞–ª–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å —Å–Ω–æ–≤–∞.</div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-knownhosts-ok-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>
</div>

<!-- File Manager: create folder / file -->
<div id="fm-create-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Create">
  <div class="modal-content" style="max-width:560px;">
    <div class="modal-header">
      <span class="modal-title" id="fm-create-title">–°–æ–∑–¥–∞—Ç—å</span>
      <button type="button" class="modal-close" id="fm-create-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div class="fm-form-grid">
        <label for="fm-create-name">–ò–º—è *</label>
        <input id="fm-create-name" class="terminal-input" placeholder="example.txt" spellcheck="false" />

        <label></label>
        <div id="fm-create-dest" class="status" style="margin:0; padding:8px 10px;">&nbsp;</div>

        <label></label>
        <label style="display:flex; gap:8px; align-items:center;">
          <input id="fm-create-parents" type="checkbox" checked />
          <span>–°–æ–∑–¥–∞—Ç—å —Ä–æ–¥–∏—Ç–µ–ª–µ–π (mkdir -p)</span>
        </label>

        <label></label>
        <label id="fm-create-createonly-row" style="display:flex; gap:8px; align-items:center;">
          <input id="fm-create-createonly" type="checkbox" checked />
          <span>–ù–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</span>
        </label>
      </div>
      <div id="fm-create-error" class="error"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-create-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <button type="button" class="btn-primary" id="fm-create-ok-btn">–°–æ–∑–¥–∞—Ç—å</button>
    </div>
  </div>

</div>

<!-- File Manager: rename file / folder -->
<div id="fm-rename-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Rename">
  <div class="modal-content" style="max-width:560px;">
    <div class="modal-header">
      <span class="modal-title" id="fm-rename-title">–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å</span>
      <button type="button" class="modal-close" id="fm-rename-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div class="fm-form-grid">
        <label for="fm-rename-name">–ù–æ–≤–æ–µ –∏–º—è *</label>
        <input id="fm-rename-name" class="terminal-input" placeholder="new-name" spellcheck="false" />

        <label></label>
        <div id="fm-rename-src" class="status" style="margin:0; padding:8px 10px;">&nbsp;</div>
      </div>
      <div class="status" style="margin-top:10px; opacity:.8;">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —Ç–µ–∫—É—â–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ (–±–µ–∑ "/" –∏ "\").</div>
      <div id="fm-rename-error" class="error"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-rename-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <button type="button" class="btn-primary" id="fm-rename-ok-btn">–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å</button>
    </div>
  </div>
</div>

<!-- File Manager: archive create -->
<div id="fm-archive-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Archive">
  <div class="modal-content" style="max-width:680px;">
    <div class="modal-header">
      <span class="modal-title" id="fm-archive-title">–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å</span>
      <button type="button" class="modal-close" id="fm-archive-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div class="fm-form-grid" style="grid-template-columns: 160px 1fr;">
        <label></label>
        <div id="fm-archive-src" class="status" style="margin:0; padding:8px 10px;">&nbsp;</div>

        <label>–í—ã–±—Ä–∞–Ω–æ</label>
        <pre id="fm-archive-list" class="fm-dropop-list" style="margin:0; max-height:180px;"></pre>

        <label for="fm-archive-name">–ò–º—è –∞—Ä—Ö–∏–≤–∞ *</label>
        <input id="fm-archive-name" class="terminal-input fm-mono" placeholder="archive.zip" spellcheck="false" />

        <label for="fm-archive-format">–§–æ—Ä–º–∞—Ç</label>
        <select id="fm-archive-format" class="terminal-input" style="max-width:220px;">
          <option value="zip">.zip</option>
          <option value="tar.gz">.tar.gz</option>
        </select>

        <label></label>
        <label style="display:flex; gap:8px; align-items:center;">
          <input id="fm-archive-overwrite" type="checkbox" />
          <span>–ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</span>
        </label>
      </div>
      <div id="fm-archive-error" class="error"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-archive-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <button type="button" class="btn-primary" id="fm-archive-ok-btn">–°–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏–≤</button>
    </div>
  </div>
</div>

<!-- File Manager: archive extract -->
<div id="fm-extract-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Extract">
  <div class="modal-content" style="max-width:680px;">
    <div class="modal-header">
      <span class="modal-title" id="fm-extract-title">–†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å</span>
      <button type="button" class="modal-close" id="fm-extract-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div class="fm-form-grid" style="grid-template-columns: 160px 1fr;">
        <label>–ê—Ä—Ö–∏–≤</label>
        <div id="fm-extract-archive" class="status" style="margin:0; padding:8px 10px;">&nbsp;</div>

        <label for="fm-extract-dest">–ü–∞–ø–∫–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è</label>
        <input id="fm-extract-dest" class="terminal-input fm-mono" placeholder="./out" spellcheck="false" />

        <label></label>
        <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
          <button type="button" class="btn-secondary" id="fm-extract-dest-here-btn" style="padding:6px 10px; font-size:12px;">–¢–µ–∫—É—â–∞—è</button>
          <button type="button" class="btn-secondary" id="fm-extract-dest-other-btn" style="padding:6px 10px; font-size:12px;">–î—Ä—É–≥–∞—è –ø–∞–Ω–µ–ª—å</button>
          <button type="button" class="btn-secondary" id="fm-extract-dest-pick-btn" style="padding:6px 10px; font-size:12px;">–í—ã–±—Ä–∞—Ç—å‚Ä¶</button>
          <span style="opacity:.7; font-size:12px;">(–º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å)</span>
        </div>

        <label></label>
        <label style="display:flex; gap:8px; align-items:center;">
          <input id="fm-extract-create-dest" type="checkbox" checked />
          <span>–†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –ø–∞–ø–∫—É</span>
        </label>

        <label></label>
        <label style="display:flex; gap:8px; align-items:center;">
          <input id="fm-extract-strip-top" type="checkbox" />
          <span>–£–±—Ä–∞—Ç—å –≤–µ—Ä—Ö–Ω—é—é –ø–∞–ø–∫—É –∞—Ä—Ö–∏–≤–∞ (–µ—Å–ª–∏ –æ–Ω–∞ –æ–¥–Ω–∞)</span>
        </label>

        <label></label>
        <label style="display:flex; gap:8px; align-items:center;">
          <input id="fm-extract-flatten" type="checkbox" />
          <span>–ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ (–ø–ª–æ—Å–∫–æ)</span>
        </label>

        <label></label>
        <label style="display:flex; gap:8px; align-items:center;">
          <input id="fm-extract-overwrite" type="checkbox" />
          <span>–ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã</span>
        </label>
      </div>
      <div class="status" style="margin-top:10px; opacity:.75;">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∞—Ä—Ö–∏–≤—ã: <span class="fm-mono">.zip</span>, <span class="fm-mono">.tar</span>, <span class="fm-mono">.tar.gz</span>, <span class="fm-mono">.tgz</span>, <span class="fm-mono">.tar.xz</span>, <span class="fm-mono">.tar.bz2</span>.</div>
      <div id="fm-extract-error" class="error"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-extract-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <button type="button" class="btn-primary" id="fm-extract-ok-btn">–†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å</button>
    </div>
  </div>
</div>

<!-- File Manager: folder picker -->
<div id="fm-folder-picker-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Folder picker">
  <div class="modal-content" style="max-width:780px;">
    <div class="modal-header">
      <span class="modal-title" id="fm-folder-picker-title">–í—ã–±–æ—Ä –ø–∞–ø–∫–∏</span>
      <button type="button" class="modal-close" id="fm-folder-picker-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-bottom:10px;">
        <button type="button" class="btn-secondary" id="fm-folder-picker-up-btn" style="padding:6px 10px; font-size:12px;">‚Üë –í–≤–µ—Ä—Ö</button>
        <button type="button" class="btn-secondary" id="fm-folder-picker-home-btn" style="padding:6px 10px; font-size:12px;">–ö–æ—Ä–µ–Ω—å</button>
        <input id="fm-folder-picker-path" class="terminal-input fm-mono" placeholder="/opt/var" spellcheck="false" style="flex:1; min-width:220px;" />
      </div>
      <div id="fm-folder-picker-status" class="status" style="margin:0 0 10px 0; padding:6px 10px; opacity:.85;">&nbsp;</div>
      <div id="fm-folder-picker-list" class="fm-dropop-list fm-mono" style="margin:0; max-height:420px; overflow:auto; padding:0;"></div>
      <div id="fm-folder-picker-error" class="error"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-folder-picker-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <button type="button" class="btn-primary" id="fm-folder-picker-select-btn">–í—ã–±—Ä–∞—Ç—å</button>
    </div>
  </div>
</div>

<!-- File Manager: archive list -->
<div id="fm-archive-list-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Archive list">
  <div class="modal-content" style="max-width:860px;">
    <div class="modal-header">
      <span class="modal-title" id="fm-archive-list-title">–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞—Ä—Ö–∏–≤–∞</span>
      <button type="button" class="modal-close" id="fm-archive-list-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div class="fm-form-grid" style="grid-template-columns: 120px 1fr;">
        <label>–ê—Ä—Ö–∏–≤</label>
        <div id="fm-archive-list-path" class="status" style="margin:0; padding:8px 10px;">&nbsp;</div>

        <label>–§–∞–π–ª—ã</label>
        <div>
          <div style="display:flex; gap:8px; align-items:center; margin:0 0 6px 0;">
            <input id="fm-archive-list-filter" class="terminal-input fm-mono" placeholder="–§–∏–ª—å—Ç—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä: conf)" spellcheck="false" style="flex:1; min-width:200px;" />
            <button type="button" class="btn-secondary" id="fm-archive-list-select-all-btn">–í—Å–µ</button>
            <button type="button" class="btn-secondary" id="fm-archive-list-select-none-btn">–°–Ω—è—Ç—å</button>
          </div>
          <div id="fm-archive-list-body" class="fm-dropop-list fm-mono" style="margin:0; max-height:420px; overflow:auto; padding:0;"></div>
        </div>

        <label></label>
        <div id="fm-archive-list-meta" class="status" style="margin:0; padding:6px 10px; opacity:.8;">&nbsp;</div>
      </div>
      <div id="fm-archive-list-error" class="error"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end; gap:10px;">
      <button type="button" class="btn-secondary" id="fm-archive-list-refresh-btn">–û–±–Ω–æ–≤–∏—Ç—å</button>
      <button type="button" class="btn-secondary" id="fm-archive-list-extract-btn">–†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å‚Ä¶</button>
      <button type="button" class="btn-secondary" id="fm-archive-list-extract-here-btn">–ò–∑–≤–ª–µ—á—å —Å—é–¥–∞</button>
      <button type="button" class="btn-primary" id="fm-archive-list-cancel-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>
</div>

<!-- File Manager: select by mask -->
<div id="fm-mask-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Select by mask">
  <div class="modal-content" style="max-width:560px;">
    <div class="modal-header">
      <span class="modal-title">–í—ã–¥–µ–ª–∏—Ç—å –ø–æ –º–∞—Å–∫–µ</span>
      <button type="button" class="modal-close" id="fm-mask-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div class="fm-form-grid">
        <label for="fm-mask-pattern">–ú–∞—Å–∫–∞ *</label>
        <input id="fm-mask-pattern" class="terminal-input fm-mono" placeholder="*.log *.json" spellcheck="false" />

        <label></label>
        <div class="status" style="margin:0; padding:8px 10px;">–ü—Ä–∏–º–µ—Ä: <span class="fm-mono">*.log</span>, <span class="fm-mono">*.json</span></div>
      </div>
      <div id="fm-mask-error" class="error"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-mask-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <button type="button" class="btn-primary" id="fm-mask-ok-btn">–í—ã–¥–µ–ª–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- File Manager: properties -->
<div id="fm-props-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Properties">
  <div class="modal-content" style="max-width:720px;">
    <div class="modal-header">
      <div style="display:flex; flex-direction:column; gap:2px;">
        <span class="modal-title">–°–≤–æ–π—Å—Ç–≤–∞</span>
        <span id="fm-props-modal-meta" class="status" style="margin:0; padding:0; background:transparent; border:none; opacity:.75; font-size:0.82rem;"></span>
      </div>
      <button type="button" class="modal-close" id="fm-props-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div id="fm-props-modal-body"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-props-close-btn2">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>
</div>

<!-- File Manager: checksum (md5/sha256) -->
<div id="fm-hash-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Checksum">
  <div class="modal-content" style="max-width:760px;">
    <div class="modal-header">
      <div style="display:flex; flex-direction:column; gap:2px;">
        <span class="modal-title">Checksum</span>
        <span id="fm-hash-meta" class="status" style="margin:0; padding:0; background:transparent; border:none; opacity:.75; font-size:0.82rem;"></span>
      </div>
      <button type="button" class="modal-close" id="fm-hash-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div class="fm-form-grid" style="grid-template-columns: 120px 1fr auto; align-items:center;">
        <label for="fm-hash-md5">MD5</label>
        <input id="fm-hash-md5" class="terminal-input fm-mono" readonly />
        <button type="button" class="btn-secondary" id="fm-hash-copy-md5">Copy</button>

        <label for="fm-hash-sha256">SHA256</label>
        <input id="fm-hash-sha256" class="terminal-input fm-mono" readonly />
        <button type="button" class="btn-secondary" id="fm-hash-copy-sha256">Copy</button>

        <label for="fm-hash-size">–†–∞–∑–º–µ—Ä</label>
        <input id="fm-hash-size" class="terminal-input fm-mono" readonly />
        <button type="button" class="btn-secondary" id="fm-hash-copy-all">Copy all</button>
      </div>
      <div id="fm-hash-error" class="error"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-hash-close-btn2">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>
</div>

<!-- File Manager: chmod modal -->
<div id="fm-chmod-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Chmod">
  <div class="modal-content" style="max-width:620px;">
    <div class="modal-header">
      <span class="modal-title" id="fm-chmod-title">–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (chmod)</span>
      <button type="button" class="modal-close" id="fm-chmod-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div class="fm-form-grid" style="grid-template-columns: 160px 1fr;">
        <label></label>
        <div id="fm-chmod-src" class="status" style="margin:0; padding:8px 10px;">&nbsp;</div>

        <label>–í—ã–±—Ä–∞–Ω–æ</label>
        <pre id="fm-chmod-list" class="fm-dropop-list" style="margin:0; max-height:160px;"></pre>

        <label for="fm-chmod-mode">Mode *</label>
        <input id="fm-chmod-mode" class="terminal-input fm-mono" placeholder="755" spellcheck="false" />

        <label></label>
        <div class="status" style="margin:0; opacity:.8;">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –º–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å <span class="fm-mono">644</span>, <span class="fm-mono">0755</span> –∏–ª–∏ <span class="fm-mono">0o755</span>.</div>

        <label></label>
        <div class="fm-perms-grid" aria-label="–ü—Ä–∞–≤–∞">
          <div></div>
          <div class="fm-perms-head">User</div>
          <div class="fm-perms-head">Group</div>
          <div class="fm-perms-head">Other</div>

          <div class="fm-perms-rowlabel">Read</div>
          <label class="fm-perms-cell"><input type="checkbox" id="fm-perm-ur" /> r</label>
          <label class="fm-perms-cell"><input type="checkbox" id="fm-perm-gr" /> r</label>
          <label class="fm-perms-cell"><input type="checkbox" id="fm-perm-or" /> r</label>

          <div class="fm-perms-rowlabel">Write</div>
          <label class="fm-perms-cell"><input type="checkbox" id="fm-perm-uw" /> w</label>
          <label class="fm-perms-cell"><input type="checkbox" id="fm-perm-gw" /> w</label>
          <label class="fm-perms-cell"><input type="checkbox" id="fm-perm-ow" /> w</label>

          <div class="fm-perms-rowlabel">Exec</div>
          <label class="fm-perms-cell"><input type="checkbox" id="fm-perm-ux" /> x</label>
          <label class="fm-perms-cell"><input type="checkbox" id="fm-perm-gx" /> x</label>
          <label class="fm-perms-cell"><input type="checkbox" id="fm-perm-ox" /> x</label>
        </div>
      </div>
      <div id="fm-chmod-error" class="error"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-chmod-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <button type="button" class="btn-primary" id="fm-chmod-ok-btn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- File Manager: chown modal -->
<div id="fm-chown-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Chown">
  <div class="modal-content" style="max-width:620px;">
    <div class="modal-header">
      <span class="modal-title" id="fm-chown-title">–í–ª–∞–¥–µ–ª–µ—Ü (chown)</span>
      <button type="button" class="modal-close" id="fm-chown-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div class="fm-form-grid" style="grid-template-columns: 160px 1fr;">
        <label></label>
        <div id="fm-chown-src" class="status" style="margin:0; padding:8px 10px;">&nbsp;</div>

        <label>–í—ã–±—Ä–∞–Ω–æ</label>
        <pre id="fm-chown-list" class="fm-dropop-list" style="margin:0; max-height:160px;"></pre>

        <label for="fm-chown-uid">UID *</label>
        <input id="fm-chown-uid" class="terminal-input fm-mono" placeholder="0" inputmode="numeric" />

        <label for="fm-chown-gid">GID</label>
        <input id="fm-chown-gid" class="terminal-input fm-mono" placeholder="0 (–∏–ª–∏ –ø—É—Å—Ç–æ ‚Äî –Ω–µ –º–µ–Ω—è—Ç—å)" inputmode="numeric" />

        <label></label>
        <div class="status" style="margin:0; opacity:.8;">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –¥–ª—è remote –æ–ø–µ—Ä–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è <b>SFTP</b>.</div>
      </div>
      <div id="fm-chown-error" class="error"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-chown-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <button type="button" class="btn-primary" id="fm-chown-ok-btn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- File Manager: drag&drop operation (move/copy) -->

<div id="fm-dropop-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Move or Copy">
  <div class="modal-content" style="max-width:620px;">
    <div class="modal-header">
      <span class="modal-title">–û–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏</span>
      <button type="button" class="modal-close" id="fm-dropop-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div id="fm-dropop-text" class="status" style="margin:0 0 10px 0;"></div>
      <pre id="fm-dropop-list" class="fm-dropop-list" style="margin:0;"></pre>
      <div class="status" style="margin-top:10px; opacity:.8;">–ü–æ–¥—Å–∫–∞–∑–∫–∞: Ctrl –≤–æ –≤—Ä–µ–º—è Drag&Drop –º–µ–Ω—è–µ—Ç –≤—ã–±–æ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.</div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-dropop-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <button type="button" class="btn-secondary" id="fm-dropop-copy-btn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
      <button type="button" class="btn-primary" id="fm-dropop-move-btn">–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- File Manager: conflicts modal (overwrite=ask) -->
<div id="fm-conflicts-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Conflicts">
  <div class="modal-content" style="max-width:760px;">
    <div class="modal-header">
      <span class="modal-title">–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏</span>
      <button type="button" class="modal-close" id="fm-conflicts-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div id="fm-conflicts-list" class="fm-conflicts-list"></div>
      <div class="fm-conflicts-footer">
        <label style="display:flex; gap:8px; align-items:center;">
          <span style="opacity:.85;">–î–µ–π—Å—Ç–≤–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:</span>
          <select id="fm-conflicts-default" class="terminal-input" style="max-width:220px;">
            <option value="replace">–ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ</option>
            <option value="skip">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ</option>
          </select>
        </label>
      </div>
      <div id="fm-conflicts-error" class="error"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-conflicts-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
      <button type="button" class="btn-primary" id="fm-conflicts-ok-btn">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- File Manager: bookmarks (pins) modal -->
<div id="fm-bookmarks-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="–ò–∑–±—Ä–∞–Ω–Ω–æ–µ">
  <div class="modal-content" style="max-width:860px;">
    <div class="modal-header">
      <span class="modal-title" id="fm-bookmarks-title">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ (local)</span>
      <button type="button" class="modal-close" id="fm-bookmarks-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div class="status" style="margin:0 0 8px 0; opacity:.9;">
        –ó–∞–∫–ª–∞–¥–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ (localStorage) –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –æ–±–æ–∏—Ö –ø–∞–Ω–µ–ª—è—Ö. –í –≤—ã–ø–∞–¥–∞—é—â–µ–º –º–µ–Ω—é üìå –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –≤–∞—à–∏ –ø—É—Ç–∏.
      </div>
      <div id="fm-bookmarks-list" class="fm-bm-list"></div>
      <div id="fm-bookmarks-error" class="error" style="display:none;"></div>
    </div>
    <div class="modal-actions" style="justify-content:space-between; gap:10px; flex-wrap:wrap;">
      <div style="display:flex; gap:8px; flex-wrap:wrap;">
        <button type="button" class="btn-secondary" id="fm-bookmarks-reset-btn" title="–í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –Ω–∞–±–æ—Ä">–°–±—Ä–æ—Å–∏—Ç—å</button>
        <button type="button" class="btn-secondary" id="fm-bookmarks-add-row-btn" title="–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É">Ôºã –î–æ–±–∞–≤–∏—Ç—å</button>
        <button type="button" class="btn-secondary" id="fm-bookmarks-add-current-btn" title="–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é –ø–∞–ø–∫—É –∞–∫—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏">‚≠ê –¢–µ–∫—É—â–∞—è</button>
      </div>
      <div style="display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end;">
        <button type="button" class="btn-secondary" id="fm-bookmarks-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
        <button type="button" class="btn-primary" id="fm-bookmarks-save-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>
</div>

<!-- File Manager: progress modal -->
<div id="fm-progress-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Progress">
  <div class="modal-content" style="max-width:620px;">
    <div class="modal-header">
      <span class="modal-title">–û–ø–µ—Ä–∞—Ü–∏—è</span>
      <button type="button" class="modal-close" id="fm-progress-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div class="fm-progress-line" id="fm-progress-title"></div>
      <div class="fm-progress-bar"><div class="fm-progress-bar-inner" id="fm-progress-bar-inner"></div></div>
      <div class="fm-progress-meta" id="fm-progress-meta"></div>
      <pre class="fm-progress-details" id="fm-progress-details"></pre>
      <div id="fm-progress-error" class="error"></div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-progress-cancel-btn">–û—Ç–º–µ–Ω–∏—Ç—å</button>
      <button type="button" class="btn-primary" id="fm-progress-ok-btn">–°–∫—Ä—ã—Ç—å</button>
    </div>
  </div>
</div>

<!-- File Manager: operations list -->
<div id="fm-ops-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Operations">
  <div class="modal-content" style="max-width:760px;">
    <div class="modal-header">
      <span class="modal-title">–û–ø–µ—Ä–∞—Ü–∏–∏</span>
      <button type="button" class="modal-close" id="fm-ops-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div style="display:flex; gap:8px; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-bottom:8px;">
        <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
          <label style="display:flex; align-items:center; gap:6px; opacity:.9;">
            <span style="font-size:12px;">–§–∏–ª—å—Ç—Ä</span>
            <select id="fm-ops-filter" class="terminal-input" style="height:32px;">
              <option value="all">–í—Å–µ</option>
              <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
              <option value="errors">–û—à–∏–±–∫–∏</option>
              <option value="finished">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ</option>
            </select>
          </label>
        </div>
        <div style="display:flex; gap:8px; justify-content:flex-end; flex-wrap:wrap;">
          <button type="button" class="btn-secondary" id="fm-ops-clear-btn">üßπ –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
          <button type="button" class="btn-secondary" id="fm-ops-refresh-btn">‚ü≥ –û–±–Ω–æ–≤–∏—Ç—å</button>
        </div>
      </div>
      <div id="fm-ops-summary" style="font-size:12px; opacity:.85; margin:6px 0 10px 0;"></div>
      <div id="fm-ops-list" class="fm-ops-list"></div>
    </div>
  </div>
</div>

<!-- File Manager: help modal -->
<div id="fm-help-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="–°–ø—Ä–∞–≤–∫–∞ –ø–æ —Ñ–∞–π–ª–æ–≤–æ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É">
  <div class="modal-content" style="max-width:780px;">
    <div class="modal-header">
      <span class="modal-title">–°–ø—Ä–∞–≤–∫–∞: —Ñ–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä</span>
      <button type="button" class="modal-close" id="fm-help-close-btn" aria-label="Close">√ó</button>
    </div>
    <div class="modal-body">
      <div class="fm-help-body" id="fm-help-body">
        <p>–î–≤—É—Ö–ø–∞–Ω–µ–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä (–∫–∞–∫ Total Commander): –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ <b>–∞–∫—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏</b> –∏ —Ç–µ–∫—É—â–µ–º—É –≤—ã–¥–µ–ª–µ–Ω–∏—é.</p>

        <h3>–ü–∞–Ω–µ–ª–∏</h3>
        <ul>
          <li><b>Target</b>: <b>local</b> ‚Äî —Ñ–∞–π–ª—ã –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π), <b>remote</b> ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É (SFTP/FTP/FTPS).</li>
          <li><b>Connect‚Ä¶</b>/<b>Disconnect</b> ‚Äî –æ—Ç–∫—Ä—ã—Ç—å/–∑–∞–∫—Ä—ã—Ç—å remote-—Å–µ—Å—Å–∏—é.</li>
          <li>–ü–æ–ª–µ –ø—É—Ç–∏: –≤–≤–µ–¥–∏—Ç–µ –ø—É—Ç—å –∏ –Ω–∞–∂–º–∏—Ç–µ <b>Enter</b> –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞.</li>
          <li><b>‚Üë</b> ‚Äî –ø–µ—Ä–µ–π—Ç–∏ –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–∞—Ç–∞–ª–æ–≥, <b>‚ü≥</b> ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫.</li>
        </ul>

        <h3>–í—ã–¥–µ–ª–µ–Ω–∏–µ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è</h3>
        <ul>
          <li>–ö–ª–∏–∫ ‚Äî —Ñ–æ–∫—É—Å + –≤—ã–¥–µ–ª–µ–Ω–∏–µ; <b>–¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫</b> –∏–ª–∏ <b>Enter</b> ‚Äî –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª/–ø–∞–ø–∫—É.</li>
          <li><b>‚Üë/‚Üì</b> ‚Äî –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ñ–æ–∫—É—Å–∞ –ø–æ —Å–ø–∏—Å–∫—É.</li>
          <li><b>Ctrl</b> (–∏–ª–∏ –∫–ª–∏–∫ –ø–æ —á–µ–∫–±–æ–∫—Å—É) ‚Äî –¥–æ–±–∞–≤–∏—Ç—å/—É–±—Ä–∞—Ç—å –∏–∑ –≤—ã–¥–µ–ª–µ–Ω–∏—è; <b>Shift</b> ‚Äî –≤—ã–¥–µ–ª–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω.</li>
          <li><b>–ü–ö–ú</b> ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é (–æ—Ç–∫—Ä—ã—Ç—å/—Å–∫–∞—á–∞—Ç—å/–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å/–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å/–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å/—É–¥–∞–ª–∏—Ç—å/—Å–æ–∑–¥–∞—Ç—å‚Ä¶).</li>
        </ul>

        <h3>–û–ø–µ—Ä–∞—Ü–∏–∏</h3>
        <ul>
          <li><b>‚ûï –ü–∞–ø–∫–∞</b> / <b>‚ûï –§–∞–π–ª</b> ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –≤ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏.</li>
          <li><b>‚¨Ü Upload</b> ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ –∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥.</li>
          <li><b>‚¨á Download</b> ‚Äî —Å–∫–∞—á–∞—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–µ (–ø–∞–ø–∫–∞/–Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è –∫–∞–∫ <b>.zip</b>).</li>
          <li><b>F5</b> ‚Äî –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏ –≤ –¥—Ä—É–≥—É—é, <b>F6</b> ‚Äî –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å.</li>
          <li>–ï—Å–ª–∏ –≤ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –µ—Å—Ç—å —Ñ–∞–π–ª—ã —Å —Ç–µ–º–∏ –∂–µ –∏–º–µ–Ω–∞–º–∏ ‚Äî –ø–æ—è–≤–∏—Ç—Å—è –æ–∫–Ω–æ <b>¬´–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã¬ª</b> (–∑–∞–º–µ–Ω–∏—Ç—å/–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å).</li>
          <li><b>F2</b> ‚Äî –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å (—Ç–æ–ª—å–∫–æ –≤ —Ç–µ–∫—É—â–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ), <b>F8</b> ‚Äî –≤ –∫–æ—Ä–∑–∏–Ω—É (–≤ –∫–æ—Ä–∑–∏–Ω–µ ‚Äî —É–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞).</li>
          <li><b>Drag&amp;Drop</b>: –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –º–µ–∂–¥—É –ø–∞–Ω–µ–ª—è–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é move; —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ <b>Ctrl</b> –¥–ª—è copy) –∏–ª–∏ –≤—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è –≤ –¥–∏–∞–ª–æ–≥–µ.</li>
          <li><b>–û–ø–µ—Ä–∞—Ü–∏–∏</b> ‚Äî —Å–ø–∏—Å–æ–∫ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ/–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞) –∏ –∏—Ö –ø—Ä–æ–≥—Ä–µ—Å—Å.</li>
        </ul>

        <h3>–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏</h3>
        <ul>
          <li><b>Tab</b> ‚Äî —Å–º–µ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏</li>
          <li><b>Enter</b> ‚Äî –æ—Ç–∫—Ä—ã—Ç—å</li>
          <li><b>Backspace</b> ‚Äî –≤–≤–µ—Ä—Ö</li>
          <li><b>Ctrl+A</b> ‚Äî –≤—ã–¥–µ–ª–∏—Ç—å –≤—Å—ë</li>
          <li><b>Ctrl+I</b> ‚Äî –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ</li>
          <li><b>Ctrl+M</b> ‚Äî –≤—ã–¥–µ–ª–∏—Ç—å –ø–æ –º–∞—Å–∫–µ</li>
          <li><b>Ctrl+Shift+C</b> ‚Äî –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å</li>
          <li><b>F7</b> ‚Äî –Ω–æ–≤–∞—è –ø–∞–ø–∫–∞</li>
          <li><b>Shift+F7</b> ‚Äî –Ω–æ–≤—ã–π —Ñ–∞–π–ª</li>
          <li><b>F2</b> ‚Äî –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å</li>
          <li><b>F5</b> ‚Äî –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</li>
          <li><b>F6</b> ‚Äî –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å</li>
          <li><b>F8</b> ‚Äî –≤ –∫–æ—Ä–∑–∏–Ω—É (–≤ –∫–æ—Ä–∑–∏–Ω–µ ‚Äî —É–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞)</li>
          <li><b>F1</b> ‚Äî –æ—Ç–∫—Ä—ã—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É</li>
          <li><b>Esc</b> ‚Äî –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ/–≤—ã–π—Ç–∏ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞</li>
        </ul>
      </div>
    </div>
    <div class="modal-actions" style="justify-content:flex-end;">
      <button type="button" class="btn-secondary" id="fm-help-ok-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>
</div>

</body>
</html>
